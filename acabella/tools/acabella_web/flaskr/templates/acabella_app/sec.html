{% include "top_layout.html" %}

{% block content %}
  <div class="container" style="margin-top:30px">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-danger" role="alert">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <div class="container" style="margin-top:30px">
    <p>
      The security analysis provided by ACABELLA performs the following checks:
      <ul class="list-group list-group-flush">
        <li class="list-group-item">
          It analyzes if the scheme is trivial secure</li>
        <li class="list-group-item">It analyzes if the scheme is collusion secure</li>
        <li class="list-group-item">It looks for a selective and a co-selective proof within the AC17 framework</li>
        <li class="list-group-item">It checks the FABEO property and looks for the respective proof</li>          
      </ul>
    </p>
    </div>      

  <form method="post" class="was-validated">
    <div class="row">
      <div class="col">
        <input type="text" class="form-control" name="title" id="title" value="{{ request.form['title'] }}" placeholder="e.g., cm14-sec-analysis" style="margin-top:30px" required>
        <small id="fieldDesc" class="form-text text-muted">ABE scheme identifier.</small>
        <div class="valid-feedback">Valid.</div>
        <div class="invalid-feedback">Please fill out this field.</div>
      </div>
      <div class="col">
        <input type="text" class="form-control" name="master_key" id="master_key" value="{{ request.form['master_key'] }}" required placeholder="e.g., master key or blinding value" style="margin-top:30px">
        <small id="fieldDesc" class="form-text text-muted">Description of the target.</small>
        <div class="valid-feedback">Valid.</div>
        <div class="invalid-feedback">Please fill out this field.</div>
      </div>
    </div>
    <div class="row">
      <div class="col" style="margin-top:30px">
        <textarea class="form-control" name="k" id="k" rows="3" required placeholder="e.g., [&quot;(alpha_i + r) / b&quot;, &quot;r&quot;]">{{ request.form['k'] }}</textarea>
        <small id="fieldDesc" class="form-text text-muted">List of key encodings.</small>
        <div class="valid-feedback">Valid.</div>
        <div class="invalid-feedback">Please fill out this field.</div>
      </div>
      <div class="col" style="margin-top:30px">
        <textarea class="form-control" name="c" id="c" rows="3" required placeholder="e.g., [&quot;s * b&quot;]">{{ request.form['c'] }}</textarea>
        <small id="fieldDesc" class="form-text text-muted">List of ciphertext encodings.</small>
        <div class="valid-feedback">Valid.</div>
        <div class="invalid-feedback">Please fill out this field.</div>
      </div>
    </div>
    <div class="row">
      <div class="col" style="margin-top:30px">
        <textarea class="form-control" name="mpk" id="mpk" rows="3" placeholder="e.g., [&quot;b&quot;]">{{ request.form['mpk'] }}</textarea>
        <small id="fieldDesc" class="form-text text-muted">List of MPK encodings.</small>
      </div>
      <div class="col" style="margin-top:30px">
        <textarea class="form-control" name="unknown" id="unknown" rows="3" placeholder="e.g., [&quot;alpha_i&quot;, &quot;r&quot;, &quot;s&quot;,&quot;b&quot;]">{{ request.form['unknown'] }}</textarea>
        <small id="fieldDesc" class="form-text text-muted">List of unknown variables.</small>
      </div>
    </div>
    <div class="row">
      <div class="col" style="margin-top:30px">
        <textarea class="form-control" name="corruptable_vars" id="corruptable_vars" rows="3" placeholder="e.g., [&quot;bp&quot;]">{{ request.form['corruptable_vars'] }}</textarea>
        <small id="fieldDesc" class="form-text text-muted">List of variables obtained via corruption.</small>
      </div>
    </div>
    <button type="submit" class="btn btn-primary" value="Analyze" style="margin-top:30px">Check the security of the scheme</button>    
  </form>
</div>

{% endblock %}

<p></p>
{% extends "bottom_layout.html" %}

