
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../abgw/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.19">
    
    
      
        <title>Reference API - ACABELLA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#classes-for-finding-attacks-in-abe-schemes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ACABELLA" class="md-header__button md-logo" aria-label="ACABELLA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ACABELLA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference API
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ACABELLA" class="md-nav__button md-logo" aria-label="ACABELLA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ACABELLA
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ac17/" class="md-nav__link">
        Security analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../master/" class="md-nav__link">
        Finding master key attacks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../decryption/" class="md-nav__link">
        Finding decryption attacks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../corruption/" class="md-nav__link">
        Utilization of corruption
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        Tools
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../json/" class="md-nav__link">
        JSON description
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../abgw/" class="md-nav__link">
        Bridge to the ABGW17 analyzer
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Reference API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Reference API
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#classes-for-finding-attacks-in-abe-schemes" class="md-nav__link">
    Classes for finding attacks in ABE schemes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attack" class="md-nav__link">
    attack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attack.Attack" class="md-nav__link">
    Attack
  </a>
  
    <nav class="md-nav" aria-label="Attack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attack.Attack.format_solution" class="md-nav__link">
    format_solution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack.Attack.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack.Attack.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack.Attack.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master-key-attacks" class="md-nav__link">
    Master key attacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#master_key" class="md-nav__link">
    master_key
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack" class="md-nav__link">
    MasterKeyAttack
  </a>
  
    <nav class="md-nav" aria-label="MasterKeyAttack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_corruptable_var" class="md-nav__link">
    add_corruptable_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_corruptable_variable_generic" class="md-nav__link">
    add_corruptable_variable_generic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_gp_variable" class="md-nav__link">
    add_gp_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_mpk" class="md-nav__link">
    add_mpk()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_mpk_AA" class="md-nav__link">
    add_mpk_AA()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_mpk_CA" class="md-nav__link">
    add_mpk_CA()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_msk_AA" class="md-nav__link">
    add_msk_AA()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_msk_CA" class="md-nav__link">
    add_msk_CA()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.format_encodings" class="md-nav__link">
    format_encodings()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.format_encodings_string" class="md-nav__link">
    format_encodings_string()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.gen_dict" class="md-nav__link">
    gen_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.set_corruption_model" class="md-nav__link">
    set_corruption_model()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#master_key.MasterKeyCorruptedVariable" class="md-nav__link">
    MasterKeyCorruptedVariable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#master_key.MasterKeyCorruptionModel" class="md-nav__link">
    MasterKeyCorruptionModel
  </a>
  
    <nav class="md-nav" aria-label="MasterKeyCorruptionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decryption-key-attacks" class="md-nav__link">
    Decryption key attacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decryption" class="md-nav__link">
    decryption
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack" class="md-nav__link">
    DecryptionAttack
  </a>
  
    <nav class="md-nav" aria-label="DecryptionAttack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_corruptable_var" class="md-nav__link">
    add_corruptable_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_corruptable_var_generic" class="md-nav__link">
    add_corruptable_var_generic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_gp_variable" class="md-nav__link">
    add_gp_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_misc" class="md-nav__link">
    add_misc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_mpk_AAi" class="md-nav__link">
    add_mpk_AAi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_mpk_AAj" class="md-nav__link">
    add_mpk_AAj()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_mpk_variable" class="md-nav__link">
    add_mpk_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.decryption_attack_generalized_alt" class="md-nav__link">
    decryption_attack_generalized_alt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.format_encodings" class="md-nav__link">
    format_encodings()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.format_encodings_string" class="md-nav__link">
    format_encodings_string()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.gen_all_p_ex_dict" class="md-nav__link">
    gen_all_p_ex_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.set_corruption_model" class="md-nav__link">
    set_corruption_model()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.set_not_found_msg" class="md-nav__link">
    set_not_found_msg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.set_sol_msg" class="md-nav__link">
    set_sol_msg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.transform_encoding_list" class="md-nav__link">
    transform_encoding_list()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decryption.DecryptionKeyCorruptedVariable" class="md-nav__link">
    DecryptionKeyCorruptedVariable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decryption.DecryptionKeyCorruptionModel" class="md-nav__link">
    DecryptionKeyCorruptionModel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes-for-analyzing-the-security-of-abe-schemes" class="md-nav__link">
    Classes for analyzing the security of ABE schemes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis.Analysis" class="md-nav__link">
    Analysis
  </a>
  
    <nav class="md-nav" aria-label="Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis.Analysis.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.Analysis.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.Analysis.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.Analysis.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption" class="md-nav__link">
    AnalysisWithCorruption
  </a>
  
    <nav class="md-nav" aria-label="AnalysisWithCorruption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.is_scheme_fractional" class="md-nav__link">
    is_scheme_fractional()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.run_logic" class="md-nav__link">
    run_logic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json-parsing-of-acabella-parameters" class="md-nav__link">
    JSON parsing of ACABELLA parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parse_config" class="md-nav__link">
    parse_config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parse_config.ParseConfig" class="md-nav__link">
    ParseConfig
  </a>
  
    <nav class="md-nav" aria-label="ParseConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_abgw_bridge_params" class="md-nav__link">
    generate_abgw_bridge_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_all_params" class="md-nav__link">
    generate_all_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_conditional_params" class="md-nav__link">
    generate_conditional_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_dec_key_params" class="md-nav__link">
    generate_dec_key_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_master_key_params" class="md-nav__link">
    generate_master_key_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_security_analysis_params" class="md-nav__link">
    generate_security_analysis_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.init_with_str" class="md-nav__link">
    init_with_str()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-generating-indexed-encodings-and-specific-access-structures" class="md-nav__link">
    Methods for generating indexed encodings and specific access structures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures" class="md-nav__link">
    access_structures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.create_policy_matrix_for_AND" class="md-nav__link">
    create_policy_matrix_for_AND()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.create_policy_matrix_for_general_access_policy" class="md-nav__link">
    create_policy_matrix_for_general_access_policy()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.create_share_vector" class="md-nav__link">
    create_share_vector()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_attribute_as_scalar" class="md-nav__link">
    get_attribute_as_scalar()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_attribute_in_group" class="md-nav__link">
    get_attribute_in_group()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_i_of_n_policy_shares" class="md-nav__link">
    get_i_of_n_policy_shares()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_i_of_n_policy_shares_general" class="md-nav__link">
    get_i_of_n_policy_shares_general()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_indexed_encoding" class="md-nav__link">
    get_indexed_encoding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_indexed_encoding_extra_index" class="md-nav__link">
    get_indexed_encoding_extra_index()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-working-with-sympy-symbols" class="md-nav__link">
    Methods for working with Sympy symbols
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common" class="md-nav__link">
    doc_common
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.addcomptodecomp" class="md-nav__link">
    addcomptodecomp()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.appendzeros" class="md-nav__link">
    appendzeros()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.canonical" class="md-nav__link">
    canonical()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.collect_denoms" class="md-nav__link">
    collect_denoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.decompose" class="md-nav__link">
    decompose()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.denoms_prod" class="md-nav__link">
    denoms_prod()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.find_attack_row" class="md-nav__link">
    find_attack_row()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.findsymb" class="md-nav__link">
    findsymb()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.gen_all_p" class="md-nav__link">
    gen_all_p()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.get_vars_list_polynomials" class="md-nav__link">
    get_vars_list_polynomials()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.get_vars_polynomial" class="md-nav__link">
    get_vars_polynomial()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.intersectnotempt" class="md-nav__link">
    intersectnotempt()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.invector" class="md-nav__link">
    invector()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.is_var_denom" class="md-nav__link">
    is_var_denom()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.is_var_not_in_list" class="md-nav__link">
    is_var_not_in_list()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.merge_lists" class="md-nav__link">
    merge_lists()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.recovermonos" class="md-nav__link">
    recovermonos()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.recovervars" class="md-nav__link">
    recovervars()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.reordermatuvec" class="md-nav__link">
    reordermatuvec()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.transform_encoding_list" class="md-nav__link">
    transform_encoding_list()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.trim_matrix_and_uvector" class="md-nav__link">
    trim_matrix_and_uvector()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.var_contains_unknown" class="md-nav__link">
    var_contains_unknown()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.writeencodingasprod" class="md-nav__link">
    writeencodingasprod()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.writepolyasprod" class="md-nav__link">
    writepolyasprod()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-generating-general-encodings" class="md-nav__link">
    Methods for generating general encodings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper" class="md-nav__link">
    encodings_helper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.create_b_encoding" class="md-nav__link">
    create_b_encoding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.create_ciphertext_encoding" class="md-nav__link">
    create_ciphertext_encoding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.create_key_encoding" class="md-nav__link">
    create_key_encoding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.generate_known_variable_set" class="md-nav__link">
    generate_known_variable_set()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.generate_unknown_variable_set" class="md-nav__link">
    generate_unknown_variable_set()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.generate_unknown_variable_set_new" class="md-nav__link">
    generate_unknown_variable_set_new()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-translating-the-acabella-format-to-abgw-inputs" class="md-nav__link">
    Methods for translating the ACABELLA format to ABGW inputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate_abgw_inputs" class="md-nav__link">
    generate_abgw_inputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate_abgw_inputs.generate_abgw_input" class="md-nav__link">
    generate_abgw_input()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate_abgw_inputs.to_c_code" class="md-nav__link">
    to_c_code()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-proof-generation" class="md-nav__link">
    Methods for proof generation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation" class="md-nav__link">
    proof_generation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.check_kernel_products" class="md-nav__link">
    check_kernel_products()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.construct_benc_mats" class="md-nav__link">
    construct_benc_mats()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.construct_lone_vects" class="md-nav__link">
    construct_lone_vects()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.determine_non_lone_vars_in_uvector" class="md-nav__link">
    determine_non_lone_vars_in_uvector()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.extend_mat_and_vec" class="md-nav__link">
    extend_mat_and_vec()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.extend_mat_and_vec2" class="md-nav__link">
    extend_mat_and_vec2()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.generate_proof_co_selective" class="md-nav__link">
    generate_proof_co_selective()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.generate_proof_selective" class="md-nav__link">
    generate_proof_selective()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.get_lone_vecs" class="md-nav__link">
    get_lone_vecs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.get_nonlone_vecs" class="md-nav__link">
    get_nonlone_vecs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.merge_matrices" class="md-nav__link">
    merge_matrices()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.normalize_substitutions" class="md-nav__link">
    normalize_substitutions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.put_special_s_first_entry" class="md-nav__link">
    put_special_s_first_entry()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.select_kern_vec" class="md-nav__link">
    select_kern_vec()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.sublistslonenonlone" class="md-nav__link">
    sublistslonenonlone()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-proof-verification" class="md-nav__link">
    Methods for proof verification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification" class="md-nav__link">
    proof_verification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.enhanced_symbolic_property" class="md-nav__link">
    enhanced_symbolic_property()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.eval_poly" class="md-nav__link">
    eval_poly()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.is_poly" class="md-nav__link">
    is_poly()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.nonlones_independent" class="md-nav__link">
    nonlones_independent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.reorder_mono_args" class="md-nav__link">
    reorder_mono_args()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.verify_collusion_security_only" class="md-nav__link">
    verify_collusion_security_only()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.verify_proof" class="md-nav__link">
    verify_proof()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-checking-if-an-abe-scheme-is-correct-according-to-the-ac17-framework" class="md-nav__link">
    Methods for checking if an ABE scheme is correct according to the AC17 framework
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks" class="md-nav__link">
    ac17_correctness_checks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.all_enc_contains_no_fractions" class="md-nav__link">
    all_enc_contains_no_fractions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.blinding_value_correct_form" class="md-nav__link">
    blinding_value_correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.cenc_correct_form" class="md-nav__link">
    cenc_correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.correct_form" class="md-nav__link">
    correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.correct_form_silent" class="md-nav__link">
    correct_form_silent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.enc_contains_no_fractions" class="md-nav__link">
    enc_contains_no_fractions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.enc_correct_form" class="md-nav__link">
    enc_correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.kenc_correct_form" class="md-nav__link">
    kenc_correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.recover_list_enc_vars" class="md-nav__link">
    recover_list_enc_vars()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-analysis-methods" class="md-nav__link">
    Security analysis methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security_analysis_ac17" class="md-nav__link">
    security_analysis_ac17
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security_analysis_ac17.security_analysis" class="md-nav__link">
    security_analysis()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-security-proof-methods" class="md-nav__link">
    Main security proof methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_security_proof" class="md-nav__link">
    doc_security_proof
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_security_proof.generate_the_encodings_then_the_proofs" class="md-nav__link">
    generate_the_encodings_then_the_proofs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_security_proof.generate_the_proofs" class="md-nav__link">
    generate_the_proofs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trivial-security-and-collusion-checks" class="md-nav__link">
    Trivial security and collusion checks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion" class="md-nav__link">
    doc_trivial_security_and_collusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.analysis_trivial_and_collusion_security" class="md-nav__link">
    analysis_trivial_and_collusion_security()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.generate_the_proofs_and_check_collusion" class="md-nav__link">
    generate_the_proofs_and_check_collusion()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.obtain_masterkeys" class="md-nav__link">
    obtain_masterkeys()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.print_transcript_to_trivial_and_collusion_security" class="md-nav__link">
    print_transcript_to_trivial_and_collusion_security()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.reduce_kern" class="md-nav__link">
    reduce_kern()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.remove_kern_unnecessary_vecs" class="md-nav__link">
    remove_kern_unnecessary_vecs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.verify_collusion_security_generalized" class="md-nav__link">
    verify_collusion_security_generalized()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.verify_trivial_security" class="md-nav__link">
    verify_trivial_security()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.verify_trivial_security_generalized" class="md-nav__link">
    verify_trivial_security_generalized()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-class-for-performing-security-checks-on-abe-schemes" class="md-nav__link">
    Security class for performing security checks on ABE schemes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    security
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security.SecurityAttack" class="md-nav__link">
    SecurityAttack
  </a>
  
    <nav class="md-nav" aria-label="SecurityAttack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.add_corruptable_variable_generic" class="md-nav__link">
    add_corruptable_variable_generic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.format_encodings" class="md-nav__link">
    format_encodings()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.set_not_found_msg" class="md-nav__link">
    set_not_found_msg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.set_sol_msg" class="md-nav__link">
    set_sol_msg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.show_proof" class="md-nav__link">
    show_proof()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.show_proof_latex" class="md-nav__link">
    show_proof_latex()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions-for-checking-the-fabeo-property" class="md-nav__link">
    Functions for checking the FABEO property
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties" class="md-nav__link">
    doc_FABEO_properties
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties.FABEO_properties" class="md-nav__link">
    FABEO_properties()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties.compute_products_ac17" class="md-nav__link">
    compute_products_ac17()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties.determine_nonlones_and_polys" class="md-nav__link">
    determine_nonlones_and_polys()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties.print_transcript_of_FABEO_property" class="md-nav__link">
    print_transcript_of_FABEO_property()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#classes-for-finding-attacks-in-abe-schemes" class="md-nav__link">
    Classes for finding attacks in ABE schemes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attack" class="md-nav__link">
    attack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attack.Attack" class="md-nav__link">
    Attack
  </a>
  
    <nav class="md-nav" aria-label="Attack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attack.Attack.format_solution" class="md-nav__link">
    format_solution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack.Attack.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack.Attack.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack.Attack.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master-key-attacks" class="md-nav__link">
    Master key attacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#master_key" class="md-nav__link">
    master_key
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack" class="md-nav__link">
    MasterKeyAttack
  </a>
  
    <nav class="md-nav" aria-label="MasterKeyAttack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_corruptable_var" class="md-nav__link">
    add_corruptable_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_corruptable_variable_generic" class="md-nav__link">
    add_corruptable_variable_generic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_gp_variable" class="md-nav__link">
    add_gp_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_mpk" class="md-nav__link">
    add_mpk()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_mpk_AA" class="md-nav__link">
    add_mpk_AA()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_mpk_CA" class="md-nav__link">
    add_mpk_CA()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_msk_AA" class="md-nav__link">
    add_msk_AA()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.add_msk_CA" class="md-nav__link">
    add_msk_CA()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.format_encodings" class="md-nav__link">
    format_encodings()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.format_encodings_string" class="md-nav__link">
    format_encodings_string()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.gen_dict" class="md-nav__link">
    gen_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.set_corruption_model" class="md-nav__link">
    set_corruption_model()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master_key.MasterKeyAttack.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#master_key.MasterKeyCorruptedVariable" class="md-nav__link">
    MasterKeyCorruptedVariable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#master_key.MasterKeyCorruptionModel" class="md-nav__link">
    MasterKeyCorruptionModel
  </a>
  
    <nav class="md-nav" aria-label="MasterKeyCorruptionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decryption-key-attacks" class="md-nav__link">
    Decryption key attacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decryption" class="md-nav__link">
    decryption
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack" class="md-nav__link">
    DecryptionAttack
  </a>
  
    <nav class="md-nav" aria-label="DecryptionAttack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_corruptable_var" class="md-nav__link">
    add_corruptable_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_corruptable_var_generic" class="md-nav__link">
    add_corruptable_var_generic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_gp_variable" class="md-nav__link">
    add_gp_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_misc" class="md-nav__link">
    add_misc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_mpk_AAi" class="md-nav__link">
    add_mpk_AAi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_mpk_AAj" class="md-nav__link">
    add_mpk_AAj()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.add_mpk_variable" class="md-nav__link">
    add_mpk_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.decryption_attack_generalized_alt" class="md-nav__link">
    decryption_attack_generalized_alt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.format_encodings" class="md-nav__link">
    format_encodings()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.format_encodings_string" class="md-nav__link">
    format_encodings_string()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.gen_all_p_ex_dict" class="md-nav__link">
    gen_all_p_ex_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.set_corruption_model" class="md-nav__link">
    set_corruption_model()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.set_not_found_msg" class="md-nav__link">
    set_not_found_msg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.set_sol_msg" class="md-nav__link">
    set_sol_msg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decryption.DecryptionAttack.transform_encoding_list" class="md-nav__link">
    transform_encoding_list()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decryption.DecryptionKeyCorruptedVariable" class="md-nav__link">
    DecryptionKeyCorruptedVariable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decryption.DecryptionKeyCorruptionModel" class="md-nav__link">
    DecryptionKeyCorruptionModel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes-for-analyzing-the-security-of-abe-schemes" class="md-nav__link">
    Classes for analyzing the security of ABE schemes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis.Analysis" class="md-nav__link">
    Analysis
  </a>
  
    <nav class="md-nav" aria-label="Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis.Analysis.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.Analysis.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.Analysis.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.Analysis.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption" class="md-nav__link">
    AnalysisWithCorruption
  </a>
  
    <nav class="md-nav" aria-label="AnalysisWithCorruption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.is_scheme_fractional" class="md-nav__link">
    is_scheme_fractional()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.run_logic" class="md-nav__link">
    run_logic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis.AnalysisWithCorruption.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json-parsing-of-acabella-parameters" class="md-nav__link">
    JSON parsing of ACABELLA parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parse_config" class="md-nav__link">
    parse_config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parse_config.ParseConfig" class="md-nav__link">
    ParseConfig
  </a>
  
    <nav class="md-nav" aria-label="ParseConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_abgw_bridge_params" class="md-nav__link">
    generate_abgw_bridge_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_all_params" class="md-nav__link">
    generate_all_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_conditional_params" class="md-nav__link">
    generate_conditional_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_dec_key_params" class="md-nav__link">
    generate_dec_key_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_master_key_params" class="md-nav__link">
    generate_master_key_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.generate_security_analysis_params" class="md-nav__link">
    generate_security_analysis_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.init" class="md-nav__link">
    init()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_config.ParseConfig.init_with_str" class="md-nav__link">
    init_with_str()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-generating-indexed-encodings-and-specific-access-structures" class="md-nav__link">
    Methods for generating indexed encodings and specific access structures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures" class="md-nav__link">
    access_structures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.create_policy_matrix_for_AND" class="md-nav__link">
    create_policy_matrix_for_AND()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.create_policy_matrix_for_general_access_policy" class="md-nav__link">
    create_policy_matrix_for_general_access_policy()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.create_share_vector" class="md-nav__link">
    create_share_vector()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_attribute_as_scalar" class="md-nav__link">
    get_attribute_as_scalar()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_attribute_in_group" class="md-nav__link">
    get_attribute_in_group()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_i_of_n_policy_shares" class="md-nav__link">
    get_i_of_n_policy_shares()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_i_of_n_policy_shares_general" class="md-nav__link">
    get_i_of_n_policy_shares_general()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_indexed_encoding" class="md-nav__link">
    get_indexed_encoding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access_structures.get_indexed_encoding_extra_index" class="md-nav__link">
    get_indexed_encoding_extra_index()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-working-with-sympy-symbols" class="md-nav__link">
    Methods for working with Sympy symbols
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common" class="md-nav__link">
    doc_common
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.addcomptodecomp" class="md-nav__link">
    addcomptodecomp()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.appendzeros" class="md-nav__link">
    appendzeros()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.canonical" class="md-nav__link">
    canonical()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.collect_denoms" class="md-nav__link">
    collect_denoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.decompose" class="md-nav__link">
    decompose()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.denoms_prod" class="md-nav__link">
    denoms_prod()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.find_attack_row" class="md-nav__link">
    find_attack_row()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.findsymb" class="md-nav__link">
    findsymb()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.gen_all_p" class="md-nav__link">
    gen_all_p()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.get_vars_list_polynomials" class="md-nav__link">
    get_vars_list_polynomials()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.get_vars_polynomial" class="md-nav__link">
    get_vars_polynomial()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.intersectnotempt" class="md-nav__link">
    intersectnotempt()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.invector" class="md-nav__link">
    invector()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.is_var_denom" class="md-nav__link">
    is_var_denom()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.is_var_not_in_list" class="md-nav__link">
    is_var_not_in_list()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.merge_lists" class="md-nav__link">
    merge_lists()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.recovermonos" class="md-nav__link">
    recovermonos()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.recovervars" class="md-nav__link">
    recovervars()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.reordermatuvec" class="md-nav__link">
    reordermatuvec()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.transform_encoding_list" class="md-nav__link">
    transform_encoding_list()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.trim_matrix_and_uvector" class="md-nav__link">
    trim_matrix_and_uvector()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.var_contains_unknown" class="md-nav__link">
    var_contains_unknown()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.writeencodingasprod" class="md-nav__link">
    writeencodingasprod()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_common.writepolyasprod" class="md-nav__link">
    writepolyasprod()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-generating-general-encodings" class="md-nav__link">
    Methods for generating general encodings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper" class="md-nav__link">
    encodings_helper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.create_b_encoding" class="md-nav__link">
    create_b_encoding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.create_ciphertext_encoding" class="md-nav__link">
    create_ciphertext_encoding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.create_key_encoding" class="md-nav__link">
    create_key_encoding()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.generate_known_variable_set" class="md-nav__link">
    generate_known_variable_set()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.generate_unknown_variable_set" class="md-nav__link">
    generate_unknown_variable_set()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodings_helper.generate_unknown_variable_set_new" class="md-nav__link">
    generate_unknown_variable_set_new()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-translating-the-acabella-format-to-abgw-inputs" class="md-nav__link">
    Methods for translating the ACABELLA format to ABGW inputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate_abgw_inputs" class="md-nav__link">
    generate_abgw_inputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate_abgw_inputs.generate_abgw_input" class="md-nav__link">
    generate_abgw_input()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate_abgw_inputs.to_c_code" class="md-nav__link">
    to_c_code()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-proof-generation" class="md-nav__link">
    Methods for proof generation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation" class="md-nav__link">
    proof_generation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.check_kernel_products" class="md-nav__link">
    check_kernel_products()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.construct_benc_mats" class="md-nav__link">
    construct_benc_mats()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.construct_lone_vects" class="md-nav__link">
    construct_lone_vects()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.determine_non_lone_vars_in_uvector" class="md-nav__link">
    determine_non_lone_vars_in_uvector()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.extend_mat_and_vec" class="md-nav__link">
    extend_mat_and_vec()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.extend_mat_and_vec2" class="md-nav__link">
    extend_mat_and_vec2()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.generate_proof_co_selective" class="md-nav__link">
    generate_proof_co_selective()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.generate_proof_selective" class="md-nav__link">
    generate_proof_selective()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.get_lone_vecs" class="md-nav__link">
    get_lone_vecs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.get_nonlone_vecs" class="md-nav__link">
    get_nonlone_vecs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.merge_matrices" class="md-nav__link">
    merge_matrices()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.normalize_substitutions" class="md-nav__link">
    normalize_substitutions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.put_special_s_first_entry" class="md-nav__link">
    put_special_s_first_entry()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.select_kern_vec" class="md-nav__link">
    select_kern_vec()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_generation.sublistslonenonlone" class="md-nav__link">
    sublistslonenonlone()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-proof-verification" class="md-nav__link">
    Methods for proof verification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification" class="md-nav__link">
    proof_verification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.enhanced_symbolic_property" class="md-nav__link">
    enhanced_symbolic_property()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.eval_poly" class="md-nav__link">
    eval_poly()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.is_poly" class="md-nav__link">
    is_poly()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.nonlones_independent" class="md-nav__link">
    nonlones_independent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.reorder_mono_args" class="md-nav__link">
    reorder_mono_args()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.verify_collusion_security_only" class="md-nav__link">
    verify_collusion_security_only()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof_verification.verify_proof" class="md-nav__link">
    verify_proof()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods-for-checking-if-an-abe-scheme-is-correct-according-to-the-ac17-framework" class="md-nav__link">
    Methods for checking if an ABE scheme is correct according to the AC17 framework
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks" class="md-nav__link">
    ac17_correctness_checks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.all_enc_contains_no_fractions" class="md-nav__link">
    all_enc_contains_no_fractions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.blinding_value_correct_form" class="md-nav__link">
    blinding_value_correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.cenc_correct_form" class="md-nav__link">
    cenc_correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.correct_form" class="md-nav__link">
    correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.correct_form_silent" class="md-nav__link">
    correct_form_silent()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.enc_contains_no_fractions" class="md-nav__link">
    enc_contains_no_fractions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.enc_correct_form" class="md-nav__link">
    enc_correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.kenc_correct_form" class="md-nav__link">
    kenc_correct_form()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ac17_correctness_checks.recover_list_enc_vars" class="md-nav__link">
    recover_list_enc_vars()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-analysis-methods" class="md-nav__link">
    Security analysis methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security_analysis_ac17" class="md-nav__link">
    security_analysis_ac17
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security_analysis_ac17.security_analysis" class="md-nav__link">
    security_analysis()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-security-proof-methods" class="md-nav__link">
    Main security proof methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_security_proof" class="md-nav__link">
    doc_security_proof
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_security_proof.generate_the_encodings_then_the_proofs" class="md-nav__link">
    generate_the_encodings_then_the_proofs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_security_proof.generate_the_proofs" class="md-nav__link">
    generate_the_proofs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trivial-security-and-collusion-checks" class="md-nav__link">
    Trivial security and collusion checks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion" class="md-nav__link">
    doc_trivial_security_and_collusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.analysis_trivial_and_collusion_security" class="md-nav__link">
    analysis_trivial_and_collusion_security()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.generate_the_proofs_and_check_collusion" class="md-nav__link">
    generate_the_proofs_and_check_collusion()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.obtain_masterkeys" class="md-nav__link">
    obtain_masterkeys()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.print_transcript_to_trivial_and_collusion_security" class="md-nav__link">
    print_transcript_to_trivial_and_collusion_security()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.reduce_kern" class="md-nav__link">
    reduce_kern()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.remove_kern_unnecessary_vecs" class="md-nav__link">
    remove_kern_unnecessary_vecs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.verify_collusion_security_generalized" class="md-nav__link">
    verify_collusion_security_generalized()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.verify_trivial_security" class="md-nav__link">
    verify_trivial_security()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_trivial_security_and_collusion.verify_trivial_security_generalized" class="md-nav__link">
    verify_trivial_security_generalized()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-class-for-performing-security-checks-on-abe-schemes" class="md-nav__link">
    Security class for performing security checks on ABE schemes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    security
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security.SecurityAttack" class="md-nav__link">
    SecurityAttack
  </a>
  
    <nav class="md-nav" aria-label="SecurityAttack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.add_corruptable_variable_generic" class="md-nav__link">
    add_corruptable_variable_generic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.format_encodings" class="md-nav__link">
    format_encodings()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.set_not_found_msg" class="md-nav__link">
    set_not_found_msg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.set_sol_msg" class="md-nav__link">
    set_sol_msg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.show_proof" class="md-nav__link">
    show_proof()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.show_proof_latex" class="md-nav__link">
    show_proof_latex()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security.SecurityAttack.show_solution" class="md-nav__link">
    show_solution()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions-for-checking-the-fabeo-property" class="md-nav__link">
    Functions for checking the FABEO property
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties" class="md-nav__link">
    doc_FABEO_properties
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties.FABEO_properties" class="md-nav__link">
    FABEO_properties()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties.compute_products_ac17" class="md-nav__link">
    compute_products_ac17()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties.determine_nonlones_and_polys" class="md-nav__link">
    determine_nonlones_and_polys()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#doc_FABEO_properties.print_transcript_of_FABEO_property" class="md-nav__link">
    print_transcript_of_FABEO_property()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Reference API</h1>

<p><code>ACABELLA</code> provides different functions and classes for analyzing
the security of ABE schemes.</p>
<h2 id="classes-for-finding-attacks-in-abe-schemes">Classes for finding attacks in ABE schemes</h2>
<p>The base class for finding attacks is the
<code>Attack</code> class:</p>


<div class="doc doc-object doc-module">


<a id="attack"></a>
  <div class="doc doc-contents first">
  
      <p>attack.py: Abstract class with format_solution method</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="attack.Attack" class="doc doc-heading">
          <code>Attack</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Base class for performing attacks. </p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>enabled</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The attack is enabled.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>description</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Description of the attack.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>attack.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Attack</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for performing attacks. </span>

<span class="sd">    Attributes:</span>
<span class="sd">        enabled (bool): The attack is enabled.</span>
<span class="sd">        description (str): Description of the attack.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">description</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">format_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">solution_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given the solution of an attack e.g. if it has found an attack and the</span>
<span class="sd">        description of the ABE scheme, it formats the output to be presented</span>
<span class="sd">        to the user.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            encoding_list (list): Descrition of the scheme encodings.</span>
<span class="sd">            solution_list (sp.core.list.Symbol): Result of the attack.</span>
<span class="sd">            msg (str): Base message to present to the user.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result of the attack (str): Well built string describing the attack result. </span>
<span class="sd">        &quot;&quot;&quot;</span>                                         
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">encoding_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>                                              
        <span class="n">solution_list</span>                                                              
        <span class="p">),</span> <span class="s2">&quot;format_solution: mismatch in encoding and solution lists&quot;</span>                  


        <span class="n">mul_list</span> <span class="o">=</span> <span class="p">[</span>                                                                   
            <span class="n">simplify</span><span class="p">(</span><span class="n">Symbol</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">*</span> <span class="n">Symbol</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>                                  
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">encoding_list</span><span class="p">,</span> <span class="n">solution_list</span><span class="p">)</span>                              
            <span class="k">if</span> <span class="n">b</span> <span class="o">!=</span> <span class="mi">0</span>                                                                  
        <span class="p">]</span>                                                                              

        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">encoding_list</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">solution_list</span><span class="p">)</span>

        <span class="k">return</span><span class="p">(</span>                                                                        
            <span class="n">msg</span> <span class="o">+</span> <span class="s2">&quot; + &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">mul_list</span><span class="p">)</span>         <span class="p">)</span> 

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialization function of the attack.</span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function for running the attack.</span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the result of the attack.</span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="attack.Attack.format_solution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">format_solution</span><span class="p">(</span><span class="n">encoding_list</span><span class="p">,</span> <span class="n">solution_list</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Given the solution of an attack e.g. if it has found an attack and the
description of the ABE scheme, it formats the output to be presented
to the user.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>encoding_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Descrition of the scheme encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>solution_list</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Result of the attack.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>msg</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Base message to present to the user.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Result of the attack (str): Well built string describing the attack result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>attack.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">solution_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the solution of an attack e.g. if it has found an attack and the</span>
<span class="sd">    description of the ABE scheme, it formats the output to be presented</span>
<span class="sd">    to the user.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        encoding_list (list): Descrition of the scheme encodings.</span>
<span class="sd">        solution_list (sp.core.list.Symbol): Result of the attack.</span>
<span class="sd">        msg (str): Base message to present to the user.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result of the attack (str): Well built string describing the attack result. </span>
<span class="sd">    &quot;&quot;&quot;</span>                                         
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">encoding_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>                                              
    <span class="n">solution_list</span>                                                              
    <span class="p">),</span> <span class="s2">&quot;format_solution: mismatch in encoding and solution lists&quot;</span>                  


    <span class="n">mul_list</span> <span class="o">=</span> <span class="p">[</span>                                                                   
        <span class="n">simplify</span><span class="p">(</span><span class="n">Symbol</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">*</span> <span class="n">Symbol</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>                                  
        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">encoding_list</span><span class="p">,</span> <span class="n">solution_list</span><span class="p">)</span>                              
        <span class="k">if</span> <span class="n">b</span> <span class="o">!=</span> <span class="mi">0</span>                                                                  
    <span class="p">]</span>                                                                              

    <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">encoding_list</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">solution_list</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span>                                                                        
        <span class="n">msg</span> <span class="o">+</span> <span class="s2">&quot; + &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">mul_list</span><span class="p">)</span>         <span class="p">)</span> 
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="attack.Attack.init" class="doc doc-heading">
<code class="highlight language-python"><span class="n">init</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialization function of the attack.</p>

          <details class="quote">
            <summary>Source code in <code>attack.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialization function of the attack.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="attack.Attack.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function for running the attack.</p>

          <details class="quote">
            <summary>Source code in <code>attack.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function for running the attack.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="attack.Attack.show_solution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_solution</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shows the result of the attack.</p>

          <details class="quote">
            <summary>Source code in <code>attack.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows the result of the attack.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h3 id="master-key-attacks">Master key attacks</h3>


<div class="doc doc-object doc-module">


<a id="master_key"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="master_key.MasterKeyAttack" class="doc doc-heading">
          <code>MasterKeyAttack</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="attack.Attack" href="#attack.Attack">Attack</a></code></p>

  
      <p>Finds master key attacks in ABE schemes, optionally
assuming the corruption of Central Authorities (CAs)
and Attribute Authorities (AAs).</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>SOL_MSG</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Message to report if a master key attack is found.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>NOT_FOUND_MSG</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Message to report if a master key attack is not found.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>corr_model</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption model involved in the attack.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Master key to recover. </p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>keyenco(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings as a list of sp.core.symbol.Symbol elements. Each
element, k_i, is related to a key encoding involved in the attack. However, we
must note that it can be related to a mpk element or to a gp element.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>unknown(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknown elements (sp.core.symbol.Symbol). These are the elements
that in theory unknown for the attacker. However, they can be disclosed by corrupting
an authority for instance.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>solution(str)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Solution of the attack, if found.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>description(str)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Description of the attack, by default MasterKeyAttack.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>c(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of ciphertext encodings. Not used.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>mpk(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of mpk related variables.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>gp(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of global parameter related variables.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>translation_table(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of mappings variable -&gt; mpk or variable -&gt; gp to improve
the details of an attack when printing the solution.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>MPK_CA(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of mpk variables that belong to the CA.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>MSK_CA(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of msk variables that belong to the CA.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>MPK_AA(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of mpk variables that belong to the AA.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>MSK_AA(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of msk variables that belong to the AA.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>master_key.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MasterKeyAttack</span><span class="p">(</span><span class="n">Attack</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds master key attacks in ABE schemes, optionally</span>
<span class="sd">    assuming the corruption of Central Authorities (CAs)</span>
<span class="sd">    and Attribute Authorities (AAs).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        SOL_MSG (str): Message to report if a master key attack is found.</span>
<span class="sd">        NOT_FOUND_MSG (str): Message to report if a master key attack is not found.</span>
<span class="sd">        corr_model (str): Corruption model involved in the attack.</span>
<span class="sd">        masterkey (sp.core.symbol.Symbol): Master key to recover. </span>
<span class="sd">        keyenco(list): Key encodings as a list of sp.core.symbol.Symbol elements. Each</span>
<span class="sd">            element, k_i, is related to a key encoding involved in the attack. However, we</span>
<span class="sd">            must note that it can be related to a mpk element or to a gp element.</span>
<span class="sd">        unknown(list): List of unknown elements (sp.core.symbol.Symbol). These are the elements</span>
<span class="sd">            that in theory unknown for the attacker. However, they can be disclosed by corrupting</span>
<span class="sd">            an authority for instance.</span>
<span class="sd">        solution(str): Solution of the attack, if found.</span>
<span class="sd">        description(str): Description of the attack, by default MasterKeyAttack.</span>
<span class="sd">        c(list): List of ciphertext encodings. Not used.</span>
<span class="sd">        mpk(list): List of mpk related variables.</span>
<span class="sd">        gp(list): List of global parameter related variables.</span>
<span class="sd">        translation_table(list): List of mappings variable -&gt; mpk or variable -&gt; gp to improve</span>
<span class="sd">            the details of an attack when printing the solution.</span>
<span class="sd">        MPK_CA(list): List of mpk variables that belong to the CA.</span>
<span class="sd">        MSK_CA(list): List of msk variables that belong to the CA.</span>
<span class="sd">        MPK_AA(list): List of mpk variables that belong to the AA.</span>
<span class="sd">        MSK_AA(list): List of msk variables that belong to the AA.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SOL_MSG</span> <span class="o">=</span> <span class="s2">&quot;[*] Master key attack found: &quot;</span>
    <span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="s2">&quot;[!] No Master key attack found&quot;</span>
    <span class="n">corr_model</span> <span class="o">=</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span>
    <span class="n">masterkey</span> <span class="o">=</span> <span class="kc">None</span> 
    <span class="n">keyenco</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;MasterKeyAttack&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">mpk</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">gp</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">translation_table</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># for output improvement</span>
    <span class="c1"># in corruption cases</span>

    <span class="n">MPK_CA</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">MSK_CA</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">MPK_AA</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">MSK_AA</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># utilized for keeping track of the type</span>
    <span class="c1"># of variables that enters the attack</span>
    <span class="c1"># via corruption of CA or AA</span>

    <span class="c1"># a corruption map contains dictionary entries</span>
    <span class="c1"># of the form {&quot;name&quot;, &quot;origin&quot;} where origins</span>
    <span class="c1"># corresponds to one of the entries of the</span>
    <span class="c1"># `MasterKeyCorruptedVariable enumeration</span>

    <span class="n">corruption_map</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The constructor for MasterKeyAttack class. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masterkey</span> <span class="o">=</span> <span class="kc">None</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># master key attacks relies on the</span>
        <span class="c1"># decryption key attack class</span>
        <span class="c1"># we save in keyenco_mk the original</span>
        <span class="c1"># encoding that initialized the master</span>
        <span class="c1"># key attack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;MasterKeyAttack&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">mpk</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">gp</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masterkey</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">keyenco</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unknown</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a master key attack based on:</span>

<span class="sd">        Parameters:</span>
<span class="sd">            masterkey (list): The master key to find.</span>
<span class="sd">            keyenco (list): The key encodings.</span>
<span class="sd">            unknown (list): The list of not known variables of the ABE scheme.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masterkey</span> <span class="o">=</span> <span class="n">masterkey</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="o">=</span> <span class="n">keyenco</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="n">unknown</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tries to find a master key attack on the given ABE scheme.</span>
<span class="sd">        It reuses the implementation of the decryption attack with the</span>
<span class="sd">        flag master_key_attack_only set as True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">decryption_attack</span> <span class="o">=</span> <span class="n">DecryptionAttack</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="p">)</span>

        <span class="c1"># save encodings here before passing them</span>
        <span class="c1"># to decryption class. It will be used for</span>
        <span class="c1"># printing pourposes in format_encodings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="p">)</span>

        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masterkey</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span> <span class="n">master_key_attack_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                            
        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_sol_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SOL_MSG</span><span class="p">)</span>
        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_not_found_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span><span class="p">)</span>

        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>                                                            
        <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="n">decryption_attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">()</span>          

    <span class="k">def</span> <span class="nf">format_encodings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the involved encodings in the given ABE scheme.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of encodings:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">],</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">])</span>

        <span class="c1"># Give details about the corruption model in relation to the</span>
        <span class="c1"># attack</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[j] and attacking an attribute authority AA[i].&quot;</span><span class="p">)</span>          

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of the Central Authority.&quot;</span><span class="p">)</span>                       

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of a Central Authority [i] in a model with several Attribute Authorities [j].&quot;</span><span class="p">)</span>    



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
            <span class="n">dict_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Information on additional encodings:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">[*] </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> corresponds to </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="si">}{</span><span class="n">dict_index</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">dict_index</span> <span class="o">=</span> <span class="n">dict_index</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NOTE: Global parameters gp[i] are added to the matrix as key encodings and could appear as k[i] elements.&quot;</span><span class="p">)</span>

        <span class="c1"># Print the contents of the master key pairs according to the</span>
        <span class="c1"># corruption model:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structure of CA/AAs:&quot;</span><span class="p">)</span>

            <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span><span class="p">:</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="c1"># Print corruption map </span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via the corruption of AA[j]:&quot;</span><span class="p">)</span>    
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via corruption:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">format_encodings_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a string with the involved encodings in the given ABE scheme.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ret_string</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of encodings:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">]))</span>

        <span class="c1"># Give details about the corruption model in relation to the</span>
        <span class="c1"># attack</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[j] and attacking an attribute authority AA[i].&quot;</span><span class="p">)</span>          

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of the Central Authority.&quot;</span><span class="p">)</span>                       

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of a Central Authority [i] in a model with several Attribute Authorities [j].&quot;</span><span class="p">)</span>    



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
            <span class="n">dict_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Information on additional encodings:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">[*] </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> corresponds to </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="si">}{</span><span class="n">dict_index</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">dict_index</span> <span class="o">=</span> <span class="n">dict_index</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NOTE: Global parameters gp[i] are added to the matrix as key encodings and could appear as k[i] elements.&quot;</span><span class="p">)</span>

        <span class="c1"># Print the contents of the master key pairs according to the</span>
        <span class="c1"># corruption model:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span><span class="p">:</span>

            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structure of CA/AAs:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span><span class="p">:</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="c1"># Print corruption map </span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via the corruption of AA[j]:&quot;</span><span class="p">)</span>    
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via corruption:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ret_string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the result of the attack.</span>

<span class="sd">        Returns:</span>
<span class="sd">            solution (str): The result of the attack.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="k">def</span> <span class="nf">add_corruptable_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="n">MasterKeyCorruptedVariable</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a corruptable var from the master pair of CA or AA.</span>
<span class="sd">        Then, calls either add_corruptable_variable_from_CA or</span>
<span class="sd">        add_corruptable_variable_from_AA accordingly.</span>
<span class="sd">        Finally, it adds an entry to the corruption map (`self.corruption_map`)</span>

<span class="sd">        Parameters:</span>
<span class="sd">            origin (MasterKeyCorruptedVariable): MSK/MPK_CA or MSK/PK_AA (Enum)</span>
<span class="sd">            corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># ensure origin belongs to MSK/MPK_CA or MSK/MPK_AA</span>

        <span class="n">corr_belongs</span> <span class="o">=</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span> <span class="ow">or</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span> <span class="ow">or</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span> <span class="ow">or</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">corr_belongs</span><span class="p">:</span>
            <span class="k">match</span> <span class="n">origin</span><span class="p">:</span>
                <span class="k">case</span> <span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_CA</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_corruptable_variable_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">corr</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">:</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">}</span>

                <span class="k">case</span> <span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_AA</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_corruptable_variable_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">corr</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">:</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">}</span>

                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Origin in MasterKeyCorruptedVariable not defined&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_corruptable_variable_generic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds CA variables that can be obtained by corruption.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">((</span><span class="n">corr</span><span class="p">)</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_gp_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpv</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a global parameter to the attack.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            gpv (symbol): global parameter variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gpv</span><span class="p">)</span>

        <span class="c1"># add entry to translation table</span>

        <span class="n">table_entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">gpv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;gp&quot;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table_entry</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_mpk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mpkv</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a master public key to the attack.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            mpkv (sp.core.symbol.Symbol): mpk variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpkv</span><span class="p">)</span>

         <span class="c1"># add entry to translation table</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span> <span class="ow">or</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">):</span>
            <span class="n">table_entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">mpkv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;mpk_i_j&quot;</span><span class="p">}</span>            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table_entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">mpkv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;mpk&quot;</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table_entry</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_mpk_CA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a CA master public key.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            elem (sp.core.symbol.Symbol): mpk CA variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_msk_CA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a CA master secret key.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            elem (sp.core.symbol.Symbol): msk CA variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add_mpk_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an AA master public key.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            elem (sp.core.symbol.Symbol): mpk AA variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_msk_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an AA master secret key.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            elem (sp.core.symbol.Symbol): msk AA variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_corruption_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr_m</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the corruption model involved in the attack. By</span>
<span class="sd">        the default the corruption model is MasterKeyCorruptionModel.NoCorruption.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            corr_m (MasterKeyCorruptionModel): Corruption model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">=</span> <span class="n">corr_m</span>

    <span class="k">def</span> <span class="nf">gen_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates an annotated dictionary based on the encodings</span>
<span class="sd">        of the given ABE scheme:</span>

<span class="sd">        Parameters:</span>
<span class="sd">            k (list): Key encodings of the ABE scheme.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Annotated dictionary (list): Annotated dictionary of the ABE scheme with descriptions. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
            <span class="n">all_k</span> <span class="o">=</span> <span class="p">[]</span>                                                               
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>                                                                 
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>  <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i][j]&quot;</span><span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>  <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span><span class="p">}</span>

                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">e</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                        <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">e</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="c1"># + str(k.index(i))</span>

                <span class="n">all_k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>                                              
        <span class="k">else</span><span class="p">:</span>
            <span class="n">all_k</span> <span class="o">=</span> <span class="p">[]</span>                                                               
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>                                                                
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>  <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))}</span>
                <span class="n">all_k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>                                              

        <span class="k">return</span> <span class="n">all_k</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The constructor for MasterKeyAttack class.</p>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The constructor for MasterKeyAttack class. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">masterkey</span> <span class="o">=</span> <span class="kc">None</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># master key attacks relies on the</span>
    <span class="c1"># decryption key attack class</span>
    <span class="c1"># we save in keyenco_mk the original</span>
    <span class="c1"># encoding that initialized the master</span>
    <span class="c1"># key attack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;MasterKeyAttack&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">mpk</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">gp</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.add_corruptable_var" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">corr</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds a corruptable var from the master pair of CA or AA.
Then, calls either add_corruptable_variable_from_CA or
add_corruptable_variable_from_AA accordingly.
Finally, it adds an entry to the corruption map (<code>self.corruption_map</code>)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>origin</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="master_key.MasterKeyCorruptedVariable" href="#master_key.MasterKeyCorruptedVariable">MasterKeyCorruptedVariable</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>MSK/MPK_CA or MSK/PK_AA (Enum)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>corr</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruptable variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_corruptable_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="n">MasterKeyCorruptedVariable</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a corruptable var from the master pair of CA or AA.</span>
<span class="sd">    Then, calls either add_corruptable_variable_from_CA or</span>
<span class="sd">    add_corruptable_variable_from_AA accordingly.</span>
<span class="sd">    Finally, it adds an entry to the corruption map (`self.corruption_map`)</span>

<span class="sd">    Parameters:</span>
<span class="sd">        origin (MasterKeyCorruptedVariable): MSK/MPK_CA or MSK/PK_AA (Enum)</span>
<span class="sd">        corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ensure origin belongs to MSK/MPK_CA or MSK/MPK_AA</span>

    <span class="n">corr_belongs</span> <span class="o">=</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span> <span class="ow">or</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span> <span class="ow">or</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span> <span class="ow">or</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span>
    <span class="n">entry</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">corr_belongs</span><span class="p">:</span>
        <span class="k">match</span> <span class="n">origin</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_CA</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_corruptable_variable_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">corr</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">:</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">}</span>

            <span class="k">case</span> <span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_AA</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_corruptable_variable_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">corr</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">:</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">}</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Origin in MasterKeyCorruptedVariable not defined&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.add_corruptable_variable_generic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_corruptable_variable_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds CA variables that can be obtained by corruption.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>corr</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruptable variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_corruptable_variable_generic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds CA variables that can be obtained by corruption.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">((</span><span class="n">corr</span><span class="p">)</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.add_gp_variable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_gp_variable</span><span class="p">(</span><span class="n">gpv</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds a global parameter to the attack.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gpv</code></td>
          <td>
                <code>symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>global parameter variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_gp_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpv</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a global parameter to the attack.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        gpv (symbol): global parameter variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gpv</span><span class="p">)</span>

    <span class="c1"># add entry to translation table</span>

    <span class="n">table_entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">gpv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;gp&quot;</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table_entry</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.add_mpk" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mpk</span><span class="p">(</span><span class="n">mpkv</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds a master public key to the attack.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mpkv</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mpk variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_mpk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mpkv</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a master public key to the attack.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mpkv (sp.core.symbol.Symbol): mpk variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpkv</span><span class="p">)</span>

     <span class="c1"># add entry to translation table</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span> <span class="ow">or</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">):</span>
        <span class="n">table_entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">mpkv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;mpk_i_j&quot;</span><span class="p">}</span>            
    <span class="k">else</span><span class="p">:</span>
        <span class="n">table_entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">mpkv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;mpk&quot;</span><span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table_entry</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.add_mpk_AA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mpk_AA</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds an AA master public key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elem</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mpk AA variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_mpk_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an AA master public key.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        elem (sp.core.symbol.Symbol): mpk AA variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.add_mpk_CA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mpk_CA</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds a CA master public key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elem</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mpk CA variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_mpk_CA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a CA master public key.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        elem (sp.core.symbol.Symbol): mpk CA variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.add_msk_AA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_msk_AA</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds an AA master secret key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elem</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>msk AA variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_msk_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an AA master secret key.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        elem (sp.core.symbol.Symbol): msk AA variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.add_msk_CA" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_msk_CA</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds a CA master secret key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elem</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>msk CA variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_msk_CA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a CA master secret key.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        elem (sp.core.symbol.Symbol): msk CA variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.format_encodings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">format_encodings</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prints the involved encodings in the given ABE scheme.</p>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_encodings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints the involved encodings in the given ABE scheme.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of encodings:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">],</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">])</span>

    <span class="c1"># Give details about the corruption model in relation to the</span>
    <span class="c1"># attack</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[j] and attacking an attribute authority AA[i].&quot;</span><span class="p">)</span>          

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of the Central Authority.&quot;</span><span class="p">)</span>                       

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of a Central Authority [i] in a model with several Attribute Authorities [j].&quot;</span><span class="p">)</span>    



    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
        <span class="n">dict_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Information on additional encodings:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">[*] </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> corresponds to </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="si">}{</span><span class="n">dict_index</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">dict_index</span> <span class="o">=</span> <span class="n">dict_index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NOTE: Global parameters gp[i] are added to the matrix as key encodings and could appear as k[i] elements.&quot;</span><span class="p">)</span>

    <span class="c1"># Print the contents of the master key pairs according to the</span>
    <span class="c1"># corruption model:</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structure of CA/AAs:&quot;</span><span class="p">)</span>

        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="c1"># Print corruption map </span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via the corruption of AA[j]:&quot;</span><span class="p">)</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via corruption:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.format_encodings_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">format_encodings_string</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a string with the involved encodings in the given ABE scheme.</p>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_encodings_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a string with the involved encodings in the given ABE scheme.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ret_string</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span><span class="p">:</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of encodings:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">]))</span>

    <span class="c1"># Give details about the corruption model in relation to the</span>
    <span class="c1"># attack</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[j] and attacking an attribute authority AA[i].&quot;</span><span class="p">)</span>          

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">:</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of the Central Authority.&quot;</span><span class="p">)</span>                       

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of a Central Authority [i] in a model with several Attribute Authorities [j].&quot;</span><span class="p">)</span>    



    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
        <span class="n">dict_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Information on additional encodings:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">[*] </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> corresponds to </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="si">}{</span><span class="n">dict_index</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">dict_index</span> <span class="o">=</span> <span class="n">dict_index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NOTE: Global parameters gp[i] are added to the matrix as key encodings and could appear as k[i] elements.&quot;</span><span class="p">)</span>

    <span class="c1"># Print the contents of the master key pairs according to the</span>
    <span class="c1"># corruption model:</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_CA</span><span class="p">:</span>

        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structure of CA/AAs:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the CA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_CA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Contents of the AA MPK encodings: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="c1"># Print corruption map </span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via the corruption of AA[j]:&quot;</span><span class="p">)</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via corruption:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ret_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.gen_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gen_dict</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generates an annotated dictionary based on the encodings
of the given ABE scheme:</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>k</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings of the ABE scheme.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Annotated dictionary (list): Annotated dictionary of the ABE scheme with descriptions.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gen_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates an annotated dictionary based on the encodings</span>
<span class="sd">    of the given ABE scheme:</span>

<span class="sd">    Parameters:</span>
<span class="sd">        k (list): Key encodings of the ABE scheme.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Annotated dictionary (list): Annotated dictionary of the ABE scheme with descriptions. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>
        <span class="n">all_k</span> <span class="o">=</span> <span class="p">[]</span>                                                               
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">:</span>                                                                 
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>  <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i][j]&quot;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>  <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span><span class="p">}</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">e</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
                    <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">e</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="c1"># + str(k.index(i))</span>

            <span class="n">all_k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>                                              
    <span class="k">else</span><span class="p">:</span>
        <span class="n">all_k</span> <span class="o">=</span> <span class="p">[]</span>                                                               
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>                                                                
            <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>  <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))}</span>
            <span class="n">all_k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>                                              

    <span class="k">return</span> <span class="n">all_k</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.init" class="doc doc-heading">
<code class="highlight language-python"><span class="n">init</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">keyenco</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initializes a master key attack based on:</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The master key to find.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>keyenco</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The list of not known variables of the ABE scheme.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masterkey</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">keyenco</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unknown</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a master key attack based on:</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (list): The master key to find.</span>
<span class="sd">        keyenco (list): The key encodings.</span>
<span class="sd">        unknown (list): The list of not known variables of the ABE scheme.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">masterkey</span> <span class="o">=</span> <span class="n">masterkey</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="o">=</span> <span class="n">keyenco</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="n">unknown</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Tries to find a master key attack on the given ABE scheme.
It reuses the implementation of the decryption attack with the
flag master_key_attack_only set as True.</p>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tries to find a master key attack on the given ABE scheme.</span>
<span class="sd">    It reuses the implementation of the decryption attack with the</span>
<span class="sd">    flag master_key_attack_only set as True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decryption_attack</span> <span class="o">=</span> <span class="n">DecryptionAttack</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="p">)</span>

    <span class="c1"># save encodings here before passing them</span>
    <span class="c1"># to decryption class. It will be used for</span>
    <span class="c1"># printing pourposes in format_encodings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keyenco_mk</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="p">)</span>

    <span class="n">decryption_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masterkey</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyenco</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span> <span class="n">master_key_attack_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                            
    <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_sol_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SOL_MSG</span><span class="p">)</span>
    <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_not_found_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span><span class="p">)</span>

    <span class="n">decryption_attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>                                                            
    <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="n">decryption_attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">()</span>          
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.set_corruption_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">corr_m</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets the corruption model involved in the attack. By
the default the corruption model is MasterKeyCorruptionModel.NoCorruption.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>corr_m</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="master_key.MasterKeyCorruptionModel" href="#master_key.MasterKeyCorruptionModel">MasterKeyCorruptionModel</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption model.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_corruption_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr_m</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the corruption model involved in the attack. By</span>
<span class="sd">    the default the corruption model is MasterKeyCorruptionModel.NoCorruption.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        corr_m (MasterKeyCorruptionModel): Corruption model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">=</span> <span class="n">corr_m</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="master_key.MasterKeyAttack.show_solution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_solution</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the result of the attack.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>solution</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the attack.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>master_key.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the result of the attack.</span>

<span class="sd">    Returns:</span>
<span class="sd">        solution (str): The result of the attack.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="master_key.MasterKeyCorruptedVariable" class="doc doc-heading">
          <code>MasterKeyCorruptedVariable</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Describes the origin of corruptable variables in master key attacks.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>MPK_CA</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The variable is part of the corruption of the Central Authority (CA).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>MPK_AA</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The variable belongs to an Attribute Authority j. It will be used to obtain the master key of an AA[i].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>master_key.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MasterKeyCorruptedVariable</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Describes the origin of corruptable variables in master key attacks.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        MPK_CA (int): The variable is part of the corruption of the Central Authority (CA).</span>
<span class="sd">        MPK_AA (int): The variable belongs to an Attribute Authority j. It will be used to obtain the master key of an AA[i].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">MPK_CA</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">MPK_AA</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="master_key.MasterKeyCorruptionModel" class="doc doc-heading">
          <code>MasterKeyCorruptionModel</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Allowed corruption models in master key attacks.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>NoCorruption</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption is not possible.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>CA</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption of the Central Authority (CA).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>AA</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Simple corruption of the Attribute Authority (AA).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>mixed_CA</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CA/CAs and AAs are involved. However only CA/CAs are corruptable.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>mixed_AA</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CA/CAs and AAs are involved. However only AAs are corruptable.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>master_key.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MasterKeyCorruptionModel</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allowed corruption models in master key attacks.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        NoCorruption (int): Corruption is not possible.</span>
<span class="sd">        CA (int): Corruption of the Central Authority (CA).</span>
<span class="sd">        AA (int): Simple corruption of the Attribute Authority (AA).</span>
<span class="sd">        mixed_CA (int): CA/CAs and AAs are involved. However only CA/CAs are corruptable.</span>
<span class="sd">        mixed_AA (int): CA/CAs and AAs are involved. However only AAs are corruptable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">NoCorruption</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">AA</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">mixed_CA</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">mixed_AA</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div><h3 id="decryption-key-attacks">Decryption key attacks</h3>


<div class="doc doc-object doc-module">


<a id="decryption"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="decryption.DecryptionAttack" class="doc doc-heading">
          <code>DecryptionAttack</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="attack.Attack" href="#attack.Attack">Attack</a></code></p>

  
      <p>Finds master key attacks in ABE schemes, optionally
assuming the corruption of the central authority (CA).</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>SOL_MSG</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Message to report if a decryption key attack is found.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>NOT_FOUND_MSG</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Message to report if a decryption key attack is not found.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>corr_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption model involved in the attack.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key to recover. </p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>all_p(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>All the possible combinations of the supplied encodings (of type
sp.core.symbol.Symbol) related to key, ciphertext, global parameters and master public key components.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>unknown(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of variables (of type sp.core.symbol.Symbol) that are
supposed to be unknown to the attacker.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>sol(string)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Solution of the attack, if found.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>k_encodings(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.symbol.Symbol types representing the key
encodings.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>c_encodings(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.symbol.Symbol types representing the
ciphertext components.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>mpk_encodings(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.symbol.Symbol types representing the 
master public key components involved in the attack (they could be related
to corruption of the authorities). </p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>gp_encodings(list)</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.symbol.Symbol types representing the 
global parameter components involved in the attack (they could be related
to corruption of the authorities).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>decryption.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DecryptionAttack</span><span class="p">(</span><span class="n">Attack</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds master key attacks in ABE schemes, optionally</span>
<span class="sd">        assuming the corruption of the central authority (CA).</span>

<span class="sd">        Attributes:</span>
<span class="sd">            SOL_MSG (str): Message to report if a decryption key attack is found.</span>
<span class="sd">            NOT_FOUND_MSG (str): Message to report if a decryption key attack is not found.</span>
<span class="sd">            corr_model (int): Corruption model involved in the attack.</span>
<span class="sd">            key (sp.core.symbol.Symbol): Key to recover. </span>
<span class="sd">            all_p(list): All the possible combinations of the supplied encodings (of type</span>
<span class="sd">                sp.core.symbol.Symbol) related to key, ciphertext, global parameters and master public key components.</span>
<span class="sd">            unknown(list): List of variables (of type sp.core.symbol.Symbol) that are</span>
<span class="sd">                supposed to be unknown to the attacker.</span>
<span class="sd">            sol(string): Solution of the attack, if found.</span>
<span class="sd">            k_encodings(list): List of sp.core.symbol.Symbol types representing the key</span>
<span class="sd">                encodings.</span>
<span class="sd">            c_encodings(list): List of sp.core.symbol.Symbol types representing the</span>
<span class="sd">                ciphertext components.</span>
<span class="sd">            mpk_encodings(list): List of sp.core.symbol.Symbol types representing the </span>
<span class="sd">                master public key components involved in the attack (they could be related</span>
<span class="sd">                to corruption of the authorities). </span>
<span class="sd">            gp_encodings(list): List of sp.core.symbol.Symbol types representing the </span>
<span class="sd">                global parameter components involved in the attack (they could be related</span>
<span class="sd">                to corruption of the authorities).    </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">SOL_MSG</span> <span class="o">=</span> <span class="s2">&quot;[*] Decryption attack found: &quot;</span>
        <span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="s2">&quot;[!] No decryption attack found&quot;</span>
        <span class="n">corr_model</span> <span class="o">=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span>
        <span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">all_p</span> <span class="o">=</span>  <span class="kc">None</span>
        <span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">sol</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">k_encodings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">c_encodings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">mpk_encodings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">gp_encodings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">is_master_key_attack</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">MPK_AAi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">MSK_AAi</span><span class="o">=</span> <span class="p">[]</span>
        <span class="n">MPK_AAj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">MSK_AAj</span><span class="o">=</span> <span class="p">[]</span>
        <span class="n">misc</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># utilized for keeping track of the type</span>
        <span class="c1"># of variables that enters the attack</span>
        <span class="c1"># via corruption of CA or AA</span>

        <span class="c1"># a corruption map contains dictionary entries</span>
        <span class="c1"># of the form {&quot;name&quot;, &quot;origin&quot;} where origins</span>
        <span class="c1"># corresponds to one of the entries of the</span>
        <span class="c1"># `DecryptionKeyCorruptedVariable enumeration</span>

        <span class="n">corruption_map</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">k_encodings</span><span class="p">,</span> <span class="n">c_encodings</span><span class="p">,</span> <span class="n">mpk_encodings</span><span class="p">,</span> <span class="n">gp_encodings</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">master_key_attack_only</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="n">unknown</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;DecryptionAttack&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span> <span class="o">=</span> <span class="n">k_encodings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span> <span class="o">=</span> <span class="n">c_encodings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span> <span class="o">=</span> <span class="n">mpk_encodings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span> <span class="o">=</span> <span class="n">gp_encodings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_master_key_attack</span> <span class="o">=</span> <span class="n">master_key_attack_only</span>

            <span class="k">if</span> <span class="n">master_key_attack_only</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            The constructor for DecryptionAttack class. </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span>  <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_master_key_attack</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAi</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span><span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAj</span><span class="o">=</span> <span class="p">[]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">misc</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Returns the result of the attack.</span>

<span class="sd">            Returns:</span>
<span class="sd">                solution (str): The result of the attack.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">def</span> <span class="nf">format_encodings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Prints the involved encodings in the given ABE scheme.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;List of encodings:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">],</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">])</span>        

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>       
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>       


            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>                        

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>                        

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>

            <span class="c1"># Give details about the corruption model in relation to the</span>
            <span class="c1"># attack</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[i].&quot;</span><span class="p">)</span>          

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[i] where c0 and c1 are obtained from different attribute authorities.&quot;</span><span class="p">)</span>                                    

            <span class="c1"># Print the contents of the master key pairs according to the</span>
            <span class="c1"># corruption model:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAj</span><span class="p">:</span>

                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structure of CA/AAs:&quot;</span><span class="p">)</span>

                <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span><span class="p">:</span>
                    <span class="k">case</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[i]: mpk[i]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">case</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[i]: mpk[i]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[j]: mpk[j]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="c1"># Print corruption map </span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via corruption:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">format_encodings_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a string with the involved encodings in the given ABE scheme.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">ret_string</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;List of encodings:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">]))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; k&quot;</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>       
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>       


            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>                        

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>                        

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>

            <span class="c1"># Give details about the corruption model in relation to the</span>
            <span class="c1"># attack</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[i].&quot;</span><span class="p">)</span>          

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[i] where c0 and c1 are obtained from different attribute authorities.&quot;</span><span class="p">)</span>                                    

            <span class="c1"># Print the contents of the master key pairs according to the</span>
            <span class="c1"># corruption model:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAj</span><span class="p">:</span>

                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structure of CA/AAs:&quot;</span><span class="p">)</span>

                <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span><span class="p">:</span>
                    <span class="k">case</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[i]: mpk[i]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">case</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">:</span>
                        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[i]: mpk[i]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[j]: mpk[j]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="c1"># Print corruption map </span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via corruption:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="p">:</span>
                    <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ret_string</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">add_corruptable_var_generic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Adds CA variables that can be obtained by corruption.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">((</span><span class="n">corr</span><span class="p">)</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_master_key_attack</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span>

        <span class="k">def</span> <span class="nf">add_mpk_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mpkv</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Adds mpk variables that could be obtained by corruption.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                mpkv (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpkv</span><span class="p">)</span>

            <span class="c1"># regenerate encodings</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">add_gp_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpv</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Adds gp variables that could be obtained by corruption.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                gpv (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gpv</span><span class="p">)</span>

            <span class="c1"># regenerate encodings</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">set_sol_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Allows to set the found solution message.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                msg (str): Message.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SOL_MSG</span> <span class="o">=</span> <span class="n">msg</span>

        <span class="k">def</span> <span class="nf">set_not_found_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Allows to set the not found solution message.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                msg (str): Message.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="n">msg</span>

        <span class="k">def</span> <span class="nf">transform_encoding_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denomprod</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Function that &#39;normalizes&#39; the encodings</span>
<span class="sd">            (by multiplying everything with the product of</span>
<span class="sd">            denominators^2 (because each element in p is paired already))</span>
<span class="sd">            (master key is multiplied by the product^2).</span>

<span class="sd">            Parameters:</span>
<span class="sd">                denomprod (sp.core.symbol.Symbo): product of denominators.</span>
<span class="sd">                 p (list): list of all possible combinations between the encodings.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">pcpy</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">pcpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cancel</span><span class="p">(</span><span class="n">pp</span> <span class="o">*</span> <span class="n">denomprod</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">canonical</span><span class="p">(</span><span class="n">pcpy</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">decryption_attack_generalized_alt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masterkey</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Tries to find a decryption attack in the supplied parameters of</span>
<span class="sd">            a particular ABE scheme.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                masterkey (sp.core.symbol.Symbo): Master key to find.</span>
<span class="sd">                p (list): list of all possible combinations between the encodings (sp.core.symbol.Symbo).</span>
<span class="sd">                unkonwn (list): list of unkown components for the attacker (sp.core.symbol.Symbo).</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

            <span class="c1"># function to select all denoms</span>
            <span class="n">denoms</span> <span class="o">=</span> <span class="n">collect_denoms</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
            <span class="n">denomprod</span> <span class="o">=</span> <span class="n">denoms_prod</span><span class="p">(</span><span class="n">denoms</span><span class="p">)</span>

            <span class="c1"># function that &#39;normalizes&#39; the encodings</span>
            <span class="c1"># (by multiplying everything with the product of</span>
            <span class="c1"># denominators**2 (because each element in p is paired already))</span>
            <span class="c1"># (master key is multiplied by the product**2)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_encoding_list</span><span class="p">(</span><span class="n">denomprod</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="n">masterkey</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">([</span><span class="n">cancel</span><span class="p">(</span><span class="n">masterkey</span> <span class="o">*</span> <span class="n">denomprod</span><span class="o">**</span><span class="mi">2</span><span class="p">)])[</span><span class="mi">0</span><span class="p">]</span>

            <span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
            <span class="c1"># could run either of the following lines - using &#39;new&#39; here for certainty</span>
            <span class="c1"># (mat,uvector) = reordermatuvec_new(masterkey,mat,uvector)</span>
            <span class="c1"># (mat, uvector) = reorder_mat_uvec_with_alpha(masterkey, mat, uvector)</span>

            <span class="n">m1</span> <span class="o">=</span> <span class="n">mat</span>
            <span class="n">m2</span> <span class="o">=</span> <span class="n">uvector</span>

            <span class="n">m1_m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
            <span class="n">m2_m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>

            <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

            <span class="c1"># attack target_vector</span>
            <span class="c1"># use here the function from find_solution or something</span>
            <span class="n">luvec1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>
            <span class="n">target_vector</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">writepolyasprod</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)])</span>
            <span class="n">luvec2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">luvec1</span> <span class="o">!=</span> <span class="n">luvec2</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

            <span class="n">mat2</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">row_insert</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">mat</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">target_vector</span><span class="p">)</span>

            <span class="c1">## testing code</span>
            <span class="c1"># &quot;&quot;&quot;</span>
            <span class="p">(</span><span class="n">mat2</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">lis_del_rows</span><span class="p">,</span> <span class="n">lis_del_cols</span><span class="p">)</span> <span class="o">=</span> <span class="n">trim_matrix_and_uvector</span><span class="p">(</span><span class="n">mat2</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span>
            <span class="n">m2_m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_del_cols</span><span class="p">:</span>
                <span class="n">target_vector</span><span class="o">.</span><span class="n">col_del</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
                <span class="n">m1_m</span><span class="o">.</span><span class="n">col_del</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_del_rows</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                <span class="n">m1_m</span><span class="o">.</span><span class="n">row_del</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
            <span class="c1"># &quot;&quot;&quot;</span>
            <span class="c1">## testing code</span>

            <span class="n">ns</span> <span class="o">=</span> <span class="n">mat2</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>

            <span class="n">matns</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">])</span>

            <span class="n">err</span><span class="p">,</span> <span class="n">f_sol</span> <span class="o">=</span> <span class="n">find_attack_row</span><span class="p">(</span><span class="n">matns</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

            <span class="n">n_l</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">m2_m</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n_d</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">mat</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">check_v</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_l</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_sol</span><span class="p">)):</span>
                <span class="n">check_v</span> <span class="o">+=</span> <span class="n">f_sol</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">mat2</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

            <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">check_v</span><span class="p">:</span>
                <span class="n">check_v</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">check_v</span><span class="p">[</span><span class="n">ctr</span><span class="p">])</span>
                <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">m1</span> <span class="o">=</span> <span class="n">m1_m</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">m2</span> <span class="o">=</span> <span class="n">m2_m</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">check_v</span> <span class="o">==</span> <span class="n">target_vector</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">f_sol</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>


        <span class="c1"># version of the super_matrix algorithm with</span>
        <span class="c1"># decryption_attack_generalized</span>

        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Tries to find a decryption attack with the supplied</span>
<span class="sd">            ABE scheme parameters.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">op</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_dict</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">]</span>
            <span class="n">dsc</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_dict</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">]</span>

            <span class="n">result</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decryption_attack_generalized_alt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">dsc</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_dict</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_solution</span><span class="p">(</span><span class="n">dsc</span><span class="p">,</span> <span class="n">sol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SOL_MSG</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span>

        <span class="k">def</span> <span class="nf">set_corruption_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr_m</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Sets the corruption model involved in the attack. By</span>
<span class="sd">            the default the corruption model is DecryptionKeyCorruptionModel.NoCorruption.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                corr_m (DecryptionKeyCorruptionModel): Corruption model.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">=</span> <span class="n">corr_m</span>

        <span class="k">def</span> <span class="nf">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">mpk</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">gp</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Generates all the possible combinations given key, ciphertext, mpk</span>
<span class="sd">            and global parameter related encodings.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                k (list): Key encodings of type sp.core.symbol.Symbol.</span>
<span class="sd">                c (list): Ciphertext encodings of type sp.core.symbol.Symbol.</span>
<span class="sd">                mpk (list): mpk encodings of type sp.core.symbol.Symbol.</span>
<span class="sd">                gp (list): gp encodings of type sp.core.symbol.Symbol.</span>
<span class="sd">            &quot;&quot;&quot;</span>   

            <span class="c1"># k*c</span>

            <span class="n">all_k_c</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="s2">&quot;*c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">))}</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">))}</span>

                    <span class="n">all_k_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

            <span class="c1"># k*mpk</span>

            <span class="n">all_k_mpk</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mpk</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                            <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="s2">&quot;*mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mpk</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                        <span class="p">}</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                            <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mpk</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                        <span class="p">}</span>                        
                    <span class="n">all_k_mpk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

            <span class="c1"># c*mpk</span>

            <span class="n">all_mpk_c</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mpk</span><span class="p">:</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                        <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mpk</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                    <span class="p">}</span>
                    <span class="n">all_mpk_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

            <span class="c1"># c*gp</span>

            <span class="n">all_gp_c</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">:</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                        <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                    <span class="p">}</span>
                    <span class="n">all_gp_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

            <span class="c1"># k*gp</span>

            <span class="n">all_gp_k</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                            <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="s2">&quot;*gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                        <span class="p">}</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                            <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                        <span class="p">}</span>                    
                    <span class="n">all_gp_k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">all_k_c</span> <span class="o">+</span> <span class="n">all_k_mpk</span> <span class="o">+</span> <span class="n">all_mpk_c</span> <span class="o">+</span> <span class="n">all_gp_c</span> <span class="o">+</span> <span class="n">all_gp_k</span>

        <span class="k">def</span> <span class="nf">add_corruptable_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Adds a corruptable var from the master pair of a AA[i]</span>
<span class="sd">                or another related variable obtained via corruption.</span>
<span class="sd">                Then, it calls the correspondent function.</span>
<span class="sd">                Finally, it adds an entry to the corruption map (`self.corruption_map`)</span>

<span class="sd">                Parameters:</span>
<span class="sd">                    origin (DecryptionKeyCorruptedVariable): MSK/MPK_AAi or misc(Enum)</span>
<span class="sd">                    corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">                &quot;&quot;&quot;</span>

                <span class="c1"># ensure origin belongs to possible values</span>

                <span class="n">corr_belongs</span> <span class="o">=</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span> <span class="ow">or</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">misc</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="n">corr_belongs</span><span class="p">:</span>
                    <span class="k">match</span> <span class="n">origin</span><span class="p">:</span>
                        <span class="k">case</span> <span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add_corruptable_var_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
                            <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">corr</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">:</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">}</span>

                        <span class="k">case</span> <span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">misc</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add_corruptable_var_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
                            <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">corr</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">:</span><span class="s2">&quot;AAi&quot;</span><span class="p">}</span>

                        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Origin in DecryptionKeyCorruptedVariable not defined&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">add_mpk_AAi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Describes the structure of AAi in the AA_extended corruption</span>
<span class="sd">            model. It is related to the encoding of MPK_i, for the</span>
<span class="sd">            corrupted A_i authority.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                elem (sp.core.symbol.Symbol): mpk AA variable.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">add_mpk_AAj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Describes the structure of AAj in the AA_extended corruption</span>
<span class="sd">            model. It is related to the encoding of MPK_j, for the</span>
<span class="sd">            honest A_j authority.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                elem (sp.core.symbol.Symbol): mpk AA variable.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">add_misc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Adds an AA master secret key.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                elem (sp.core.symbol.Symbol): msk AA variable.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The constructor for DecryptionAttack class.</p>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The constructor for DecryptionAttack class. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span>  <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_master_key_attack</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAi</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span><span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAj</span><span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">misc</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.add_corruptable_var" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">corr</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds a corruptable var from the master pair of a AA[i]
or another related variable obtained via corruption.
Then, it calls the correspondent function.
Finally, it adds an entry to the corruption map (<code>self.corruption_map</code>)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>origin</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="decryption.DecryptionKeyCorruptedVariable" href="#decryption.DecryptionKeyCorruptedVariable">DecryptionKeyCorruptedVariable</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>MSK/MPK_AAi or misc(Enum)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>corr</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruptable variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_corruptable_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a corruptable var from the master pair of a AA[i]</span>
<span class="sd">        or another related variable obtained via corruption.</span>
<span class="sd">        Then, it calls the correspondent function.</span>
<span class="sd">        Finally, it adds an entry to the corruption map (`self.corruption_map`)</span>

<span class="sd">        Parameters:</span>
<span class="sd">            origin (DecryptionKeyCorruptedVariable): MSK/MPK_AAi or misc(Enum)</span>
<span class="sd">            corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># ensure origin belongs to possible values</span>

        <span class="n">corr_belongs</span> <span class="o">=</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span> <span class="ow">or</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">misc</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">corr_belongs</span><span class="p">:</span>
            <span class="k">match</span> <span class="n">origin</span><span class="p">:</span>
                <span class="k">case</span> <span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_corruptable_var_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">corr</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">:</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">}</span>

                <span class="k">case</span> <span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">misc</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_corruptable_var_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">corr</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">:</span><span class="s2">&quot;AAi&quot;</span><span class="p">}</span>

                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Origin in DecryptionKeyCorruptedVariable not defined&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.add_corruptable_var_generic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_corruptable_var_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds CA variables that can be obtained by corruption.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>corr</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruptable variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_corruptable_var_generic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds CA variables that can be obtained by corruption.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">((</span><span class="n">corr</span><span class="p">)</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_master_key_attack</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.add_gp_variable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_gp_variable</span><span class="p">(</span><span class="n">gpv</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds gp variables that could be obtained by corruption.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gpv</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruptable variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_gp_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpv</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds gp variables that could be obtained by corruption.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        gpv (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gpv</span><span class="p">)</span>

    <span class="c1"># regenerate encodings</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.add_misc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_misc</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds an AA master secret key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elem</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>msk AA variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_misc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an AA master secret key.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        elem (sp.core.symbol.Symbol): msk AA variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.add_mpk_AAi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mpk_AAi</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Describes the structure of AAi in the AA_extended corruption
model. It is related to the encoding of MPK_i, for the
corrupted A_i authority.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elem</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mpk AA variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_mpk_AAi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Describes the structure of AAi in the AA_extended corruption</span>
<span class="sd">    model. It is related to the encoding of MPK_i, for the</span>
<span class="sd">    corrupted A_i authority.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        elem (sp.core.symbol.Symbol): mpk AA variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.add_mpk_AAj" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mpk_AAj</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Describes the structure of AAj in the AA_extended corruption
model. It is related to the encoding of MPK_j, for the
honest A_j authority.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elem</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mpk AA variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_mpk_AAj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Describes the structure of AAj in the AA_extended corruption</span>
<span class="sd">    model. It is related to the encoding of MPK_j, for the</span>
<span class="sd">    honest A_j authority.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        elem (sp.core.symbol.Symbol): mpk AA variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.add_mpk_variable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mpk_variable</span><span class="p">(</span><span class="n">mpkv</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds mpk variables that could be obtained by corruption.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mpkv</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruptable variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_mpk_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mpkv</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds mpk variables that could be obtained by corruption.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mpkv (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpkv</span><span class="p">)</span>

    <span class="c1"># regenerate encodings</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.decryption_attack_generalized_alt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">decryption_attack_generalized_alt</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Tries to find a decryption attack in the supplied parameters of
a particular ABE scheme.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbo">Symbo</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Master key to find.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of all possible combinations between the encodings (sp.core.symbol.Symbo).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unkonwn</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of unkown components for the attacker (sp.core.symbol.Symbo).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">decryption_attack_generalized_alt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masterkey</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tries to find a decryption attack in the supplied parameters of</span>
<span class="sd">    a particular ABE scheme.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.symbol.Symbo): Master key to find.</span>
<span class="sd">        p (list): list of all possible combinations between the encodings (sp.core.symbol.Symbo).</span>
<span class="sd">        unkonwn (list): list of unkown components for the attacker (sp.core.symbol.Symbo).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># function to select all denoms</span>
    <span class="n">denoms</span> <span class="o">=</span> <span class="n">collect_denoms</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="n">denomprod</span> <span class="o">=</span> <span class="n">denoms_prod</span><span class="p">(</span><span class="n">denoms</span><span class="p">)</span>

    <span class="c1"># function that &#39;normalizes&#39; the encodings</span>
    <span class="c1"># (by multiplying everything with the product of</span>
    <span class="c1"># denominators**2 (because each element in p is paired already))</span>
    <span class="c1"># (master key is multiplied by the product**2)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_encoding_list</span><span class="p">(</span><span class="n">denomprod</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">masterkey</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">([</span><span class="n">cancel</span><span class="p">(</span><span class="n">masterkey</span> <span class="o">*</span> <span class="n">denomprod</span><span class="o">**</span><span class="mi">2</span><span class="p">)])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="c1"># could run either of the following lines - using &#39;new&#39; here for certainty</span>
    <span class="c1"># (mat,uvector) = reordermatuvec_new(masterkey,mat,uvector)</span>
    <span class="c1"># (mat, uvector) = reorder_mat_uvec_with_alpha(masterkey, mat, uvector)</span>

    <span class="n">m1</span> <span class="o">=</span> <span class="n">mat</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">uvector</span>

    <span class="n">m1_m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
    <span class="n">m2_m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>

    <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

    <span class="c1"># attack target_vector</span>
    <span class="c1"># use here the function from find_solution or something</span>
    <span class="n">luvec1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>
    <span class="n">target_vector</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">writepolyasprod</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)])</span>
    <span class="n">luvec2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">luvec1</span> <span class="o">!=</span> <span class="n">luvec2</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="n">mat2</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">row_insert</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">mat</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">target_vector</span><span class="p">)</span>

    <span class="c1">## testing code</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">mat2</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">lis_del_rows</span><span class="p">,</span> <span class="n">lis_del_cols</span><span class="p">)</span> <span class="o">=</span> <span class="n">trim_matrix_and_uvector</span><span class="p">(</span><span class="n">mat2</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span>
    <span class="n">m2_m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_del_cols</span><span class="p">:</span>
        <span class="n">target_vector</span><span class="o">.</span><span class="n">col_del</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">m1_m</span><span class="o">.</span><span class="n">col_del</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_del_rows</span><span class="p">:</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">m1_m</span><span class="o">.</span><span class="n">row_del</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="c1">## testing code</span>

    <span class="n">ns</span> <span class="o">=</span> <span class="n">mat2</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>

    <span class="n">matns</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">])</span>

    <span class="n">err</span><span class="p">,</span> <span class="n">f_sol</span> <span class="o">=</span> <span class="n">find_attack_row</span><span class="p">(</span><span class="n">matns</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="n">n_l</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">m2_m</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_d</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">mat</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">check_v</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_l</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_sol</span><span class="p">)):</span>
        <span class="n">check_v</span> <span class="o">+=</span> <span class="n">f_sol</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">mat2</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">check_v</span><span class="p">:</span>
        <span class="n">check_v</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">check_v</span><span class="p">[</span><span class="n">ctr</span><span class="p">])</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">m1</span> <span class="o">=</span> <span class="n">m1_m</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">m2_m</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">check_v</span> <span class="o">==</span> <span class="n">target_vector</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">f_sol</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.format_encodings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">format_encodings</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prints the involved encodings in the given ABE scheme.</p>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_encodings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints the involved encodings in the given ABE scheme.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;List of encodings:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">],</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">])</span>        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>       
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>       


    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>                        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>                        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">)),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span>  <span class="n">elem</span><span class="p">)</span>

    <span class="c1"># Give details about the corruption model in relation to the</span>
    <span class="c1"># attack</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[i].&quot;</span><span class="p">)</span>          

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[i] where c0 and c1 are obtained from different attribute authorities.&quot;</span><span class="p">)</span>                                    

    <span class="c1"># Print the contents of the master key pairs according to the</span>
    <span class="c1"># corruption model:</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAj</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structure of CA/AAs:&quot;</span><span class="p">)</span>

        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[i]: mpk[i]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[i]: mpk[i]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[j]: mpk[j]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="c1"># Print corruption map </span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via corruption:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.format_encodings_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">format_encodings_string</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a string with the involved encodings in the given ABE scheme.</p>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_encodings_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a string with the involved encodings in the given ABE scheme.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ret_string</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">:</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;List of encodings:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">]))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; k&quot;</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>       
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>       


    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>                        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>                        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gp_encodings</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>

    <span class="c1"># Give details about the corruption model in relation to the</span>
    <span class="c1"># attack</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[i].&quot;</span><span class="p">)</span>          

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">==</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">:</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">For the corruption of an attribute authority AA[i] where c0 and c1 are obtained from different attribute authorities.&quot;</span><span class="p">)</span>                                    

    <span class="c1"># Print the contents of the master key pairs according to the</span>
    <span class="c1"># corruption model:</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAi</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSK_AAj</span><span class="p">:</span>

        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structure of CA/AAs:&quot;</span><span class="p">)</span>

        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[i]: mpk[i]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">:</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[i]: mpk[i]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Master key pair of AA[j]: mpk[j]: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MPK_AAj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="c1"># Print corruption map </span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
        <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List of variables obtained via corruption:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruption_map</span><span class="p">:</span>
            <span class="n">ret_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> from </span><span class="si">{</span><span class="n">elem</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ret_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.gen_all_p_ex_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gen_all_p_ex_dict</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mpk</span><span class="p">,</span> <span class="n">gp</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generates all the possible combinations given key, ciphertext, mpk
and global parameter related encodings.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>k</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings of type sp.core.symbol.Symbol.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>c</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings of type sp.core.symbol.Symbol.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mpk</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mpk encodings of type sp.core.symbol.Symbol.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>gp</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>gp encodings of type sp.core.symbol.Symbol.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gen_all_p_ex_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">mpk</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">gp</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates all the possible combinations given key, ciphertext, mpk</span>
<span class="sd">    and global parameter related encodings.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        k (list): Key encodings of type sp.core.symbol.Symbol.</span>
<span class="sd">        c (list): Ciphertext encodings of type sp.core.symbol.Symbol.</span>
<span class="sd">        mpk (list): mpk encodings of type sp.core.symbol.Symbol.</span>
<span class="sd">        gp (list): gp encodings of type sp.core.symbol.Symbol.</span>
<span class="sd">    &quot;&quot;&quot;</span>   

    <span class="c1"># k*c</span>

    <span class="n">all_k_c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="s2">&quot;*c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">))}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">))}</span>

            <span class="n">all_k_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="c1"># k*mpk</span>

    <span class="n">all_k_mpk</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mpk</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                    <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="s2">&quot;*mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mpk</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                    <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mpk</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                <span class="p">}</span>                        
            <span class="n">all_k_mpk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="c1"># c*mpk</span>

    <span class="n">all_mpk_c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mpk</span><span class="p">:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*mpk&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mpk</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
            <span class="p">}</span>
            <span class="n">all_mpk_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="c1"># c*gp</span>

    <span class="n">all_gp_c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
            <span class="p">}</span>
            <span class="n">all_gp_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="c1"># k*gp</span>

    <span class="n">all_gp_k</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">!=</span> <span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                    <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[i]&quot;</span> <span class="o">+</span> <span class="s2">&quot;*gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span>
                    <span class="s2">&quot;dsc&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;*gp&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                <span class="p">}</span>                    
            <span class="n">all_gp_k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">all_k_c</span> <span class="o">+</span> <span class="n">all_k_mpk</span> <span class="o">+</span> <span class="n">all_mpk_c</span> <span class="o">+</span> <span class="n">all_gp_c</span> <span class="o">+</span> <span class="n">all_gp_k</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Tries to find a decryption attack with the supplied
ABE scheme parameters.</p>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tries to find a decryption attack with the supplied</span>
<span class="sd">    ABE scheme parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">op</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_dict</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">]</span>
    <span class="n">dsc</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_dict</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">]</span>

    <span class="n">result</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decryption_attack_generalized_alt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">dsc</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_dict</span><span class="p">[</span><span class="s2">&quot;dsc&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_p</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_solution</span><span class="p">(</span><span class="n">dsc</span><span class="p">,</span> <span class="n">sol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SOL_MSG</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.set_corruption_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">corr_m</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets the corruption model involved in the attack. By
the default the corruption model is DecryptionKeyCorruptionModel.NoCorruption.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>corr_m</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="decryption.DecryptionKeyCorruptionModel" href="#decryption.DecryptionKeyCorruptionModel">DecryptionKeyCorruptionModel</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption model.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_corruption_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr_m</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the corruption model involved in the attack. By</span>
<span class="sd">    the default the corruption model is DecryptionKeyCorruptionModel.NoCorruption.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        corr_m (DecryptionKeyCorruptionModel): Corruption model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">corr_model</span> <span class="o">=</span> <span class="n">corr_m</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.set_not_found_msg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_not_found_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Allows to set the not found solution message.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>msg</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_not_found_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows to set the not found solution message.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        msg (str): Message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="n">msg</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.set_sol_msg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_sol_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Allows to set the found solution message.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>msg</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_sol_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows to set the found solution message.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        msg (str): Message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SOL_MSG</span> <span class="o">=</span> <span class="n">msg</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.show_solution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_solution</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the result of the attack.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>solution</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the attack.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the result of the attack.</span>

<span class="sd">    Returns:</span>
<span class="sd">        solution (str): The result of the attack.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="decryption.DecryptionAttack.transform_encoding_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">transform_encoding_list</span><span class="p">(</span><span class="n">denomprod</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function that 'normalizes' the encodings
(by multiplying everything with the product of
denominators^2 (because each element in p is paired already))
(master key is multiplied by the product^2).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>denomprod</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbo">Symbo</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>product of denominators.
p (list): list of all possible combinations between the encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>decryption.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transform_encoding_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denomprod</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that &#39;normalizes&#39; the encodings</span>
<span class="sd">    (by multiplying everything with the product of</span>
<span class="sd">    denominators^2 (because each element in p is paired already))</span>
<span class="sd">    (master key is multiplied by the product^2).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        denomprod (sp.core.symbol.Symbo): product of denominators.</span>
<span class="sd">         p (list): list of all possible combinations between the encodings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pcpy</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="n">pcpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cancel</span><span class="p">(</span><span class="n">pp</span> <span class="o">*</span> <span class="n">denomprod</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">canonical</span><span class="p">(</span><span class="n">pcpy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="decryption.DecryptionKeyCorruptedVariable" class="doc doc-heading">
          <code>DecryptionKeyCorruptedVariable</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Describes the origin of corruptable variables in decryption key attacks.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>MPK_AAi</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>MPK of an attribute authority [i].</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>misc</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>misc. variable part of an attribute autority [i].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>decryption.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DecryptionKeyCorruptedVariable</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Describes the origin of corruptable variables in decryption key attacks.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        MPK_AAi (int): MPK of an attribute authority [i].</span>
<span class="sd">        misc (int): misc. variable part of an attribute autority [i].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MPK_AAi</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">misc</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="decryption.DecryptionKeyCorruptionModel" class="doc doc-heading">
          <code>DecryptionKeyCorruptionModel</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Allowed corruption models in decryption key attacks.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>NoCorruption</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption is not possible.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>AA</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption of one Attribute Authority (AA[i]).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>AA_extended</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruption of the Attribute Authority (AA[i]) where
the interaction with a second Attribute Authority AA[j] is required.
This interaction means that a second attribute-independent ciphertext
is generated from a second authority.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>decryption.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DecryptionKeyCorruptionModel</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allowed corruption models in decryption key attacks.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        NoCorruption (int): Corruption is not possible.</span>
<span class="sd">        AA (int): Corruption of one Attribute Authority (AA[i]).</span>
<span class="sd">        AA_extended (int): Corruption of the Attribute Authority (AA[i]) where</span>
<span class="sd">            the interaction with a second Attribute Authority AA[j] is required.</span>
<span class="sd">            This interaction means that a second attribute-independent ciphertext</span>
<span class="sd">            is generated from a second authority.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">NoCorruption</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">AA</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">AA_extended</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="classes-for-analyzing-the-security-of-abe-schemes">Classes for analyzing the security of ABE schemes</h2>


<div class="doc doc-object doc-module">


<a id="analysis"></a>
  <div class="doc doc-contents first">
  
      <p>analysis.py: Definition of the analysis class that aims to perform different tests on a given ABE scheme</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="analysis.Analysis" class="doc doc-heading">
          <code>Analysis</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Base analysis class with methods to perform basic master key and 
decryption attacks. AnalysisWithCorruption inherits this class
and extends to also provide security analysis of the ABE scheme.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>analysis_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of analysis to perform by the class via run.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>sol_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Solutions found via the analysis in analysis_list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>analysis.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base analysis class with methods to perform basic master key and </span>
<span class="sd">    decryption attacks. AnalysisWithCorruption inherits this class</span>
<span class="sd">    and extends to also provide security analysis of the ABE scheme.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        analysis_list (list): List of analysis to perform by the class via run.</span>
<span class="sd">        sol_list (list): Solutions found via the analysis in analysis_list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The constructor for the Analysis class. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master_key_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">decryption_key_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the analysis class with the respective params for</span>
<span class="sd">        master key attacks and decryption attacks :</span>

<span class="sd">        Parameters:</span>
<span class="sd">            master_key_params (dict): The parameters required for a master key attack.</span>
<span class="sd">            decryption_key_params (dict): The parameters required for a decryption key attack.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">master_key_attack</span> <span class="o">=</span> <span class="n">MasterKeyAttack</span><span class="p">()</span>
        <span class="n">master_key_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;masterkey&quot;</span><span class="p">],</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;keyenco&quot;</span><span class="p">],</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

        <span class="n">decryption_attack</span> <span class="o">=</span> <span class="n">DecryptionAttack</span><span class="p">()</span>
        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;all_p&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decryption_attack</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">master_key_attack</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tries to find master key and decryption attacks in the</span>
<span class="sd">        provided ABE scheme.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the result of the attacks.</span>

<span class="sd">        Returns:</span>
<span class="sd">            solution (list): The result of the attacks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="analysis.Analysis.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The constructor for the Analysis class.</p>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The constructor for the Analysis class. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="analysis.Analysis.init" class="doc doc-heading">
<code class="highlight language-python"><span class="n">init</span><span class="p">(</span><span class="n">master_key_params</span><span class="p">,</span> <span class="n">decryption_key_params</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initializes the analysis class with the respective params for
master key attacks and decryption attacks :</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>master_key_params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The parameters required for a master key attack.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>decryption_key_params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The parameters required for a decryption key attack.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master_key_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">decryption_key_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the analysis class with the respective params for</span>
<span class="sd">    master key attacks and decryption attacks :</span>

<span class="sd">    Parameters:</span>
<span class="sd">        master_key_params (dict): The parameters required for a master key attack.</span>
<span class="sd">        decryption_key_params (dict): The parameters required for a decryption key attack.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">master_key_attack</span> <span class="o">=</span> <span class="n">MasterKeyAttack</span><span class="p">()</span>
    <span class="n">master_key_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;masterkey&quot;</span><span class="p">],</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;keyenco&quot;</span><span class="p">],</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

    <span class="n">decryption_attack</span> <span class="o">=</span> <span class="n">DecryptionAttack</span><span class="p">()</span>
    <span class="n">decryption_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;all_p&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decryption_attack</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">master_key_attack</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="analysis.Analysis.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Tries to find master key and decryption attacks in the
provided ABE scheme.</p>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tries to find master key and decryption attacks in the</span>
<span class="sd">    provided ABE scheme.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="analysis.Analysis.show_solution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_solution</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the result of the attacks.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>solution</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the attacks.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the result of the attacks.</span>

<span class="sd">    Returns:</span>
<span class="sd">        solution (list): The result of the attacks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="analysis.AnalysisWithCorruption" class="doc doc-heading">
          <code>AnalysisWithCorruption</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="analysis.Analysis" href="#analysis.Analysis">Analysis</a></code></p>

  
      <p>This class performs the security analysis of the provided
scheme as well as look for master and decryption attacks if
sufficient parameters are provided.</p>

            <details class="quote">
              <summary>Source code in <code>analysis.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AnalysisWithCorruption</span><span class="p">(</span><span class="n">Analysis</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class performs the security analysis of the provided</span>
<span class="sd">    scheme as well as look for master and decryption attacks if</span>
<span class="sd">    sufficient parameters are provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_MK</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_DK</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master_key_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">decryption_key_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">corruptable_vars_MK</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">corruptable_vars_DK</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">security_analysis_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the AnalysisWithCorruption class.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            master_key_params (dict): Required parameters to look for master key attack.</span>
<span class="sd">            decryption_key_params (dict): Required parameters to look for a decryption attack.</span>
<span class="sd">            corruptable_vars_MK (list): The list of corruptable variables involved in the master key attack (if any).</span>
<span class="sd">            corruptable_vars_DK (list): The list of corruptable variables involved in the decryption attack (if any).</span>
<span class="sd">            security_analysis_params (dict): The required parameters to perform a security analysis of the scheme.</span>


<span class="sd">        Returns:</span>
<span class="sd">            (bool): If the inputs are valid e.g. corruption models and variable type are correct.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_MK</span> <span class="o">=</span> <span class="n">corruptable_vars_MK</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_DK</span> <span class="o">=</span> <span class="n">corruptable_vars_DK</span>

        <span class="k">if</span> <span class="n">security_analysis_params</span><span class="p">:</span>
            <span class="n">security_attack</span> <span class="o">=</span> <span class="n">SecurityAttack</span><span class="p">()</span>
            <span class="n">security_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
                                 <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span>
                                 <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">],</span>
                                 <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">],</span> 
                                 <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">],</span>
                                 <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

            <span class="c1"># update unknown variables array with list of corruptable vars</span>

            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]:</span>
                <span class="n">security_attack</span><span class="o">.</span><span class="n">add_corruptable_variable_generic</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">security_attack</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">master_key_params</span><span class="p">:</span>
            <span class="n">master_key_attack</span> <span class="o">=</span> <span class="n">MasterKeyAttack</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;NoCorruption&#39;</span><span class="p">:</span>
                <span class="n">master_key_attack</span><span class="o">.</span><span class="n">SOL_MSG</span> <span class="o">=</span> <span class="s2">&quot;[*] Master key attack with corruption found: &quot;</span>
                <span class="n">master_key_attack</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="s2">&quot;[!] No Master key attack with corruption found&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">master_key_attack</span><span class="o">.</span><span class="n">SOL_MSG</span> <span class="o">=</span> <span class="s2">&quot;[*] Master key attack found: &quot;</span>
                <span class="n">master_key_attack</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="s2">&quot;[!] No Master key attack found. &quot;</span>

            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;masterkey&quot;</span><span class="p">],</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;keyenco&quot;</span><span class="p">],</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

            <span class="k">match</span> <span class="nb">str</span><span class="p">(</span><span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]):</span>
               <span class="k">case</span> <span class="s1">&#39;NoCorruption&#39;</span><span class="p">:</span>
                  <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">)</span>
               <span class="k">case</span> <span class="s2">&quot;CA&quot;</span><span class="p">:</span>
                  <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">)</span>
               <span class="k">case</span> <span class="s1">&#39;AA&#39;</span><span class="p">:</span>
                  <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
               <span class="k">case</span> <span class="s1">&#39;mixed_CA_corr&#39;</span><span class="p">:</span>
                  <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">)</span>
               <span class="k">case</span> <span class="s1">&#39;mixed_AA_corr&#39;</span><span class="p">:</span>
                  <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">)</span>
               <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                 <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]:</span>
                <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_mpk_CA</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]:</span>
                <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_mpk_AA</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]:</span>
                <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_mpk</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]:</span>
                <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_gp_variable</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_MK</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_MK</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;var&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">,</span> <span class="s2">&quot;MSK_CA&quot;</span><span class="p">,</span> <span class="s2">&quot;MPK_AA&quot;</span><span class="p">,</span> <span class="s2">&quot;MSK_AA&quot;</span><span class="p">]:</span>
                                    <span class="k">match</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]):</span>
                                        <span class="k">case</span> <span class="s2">&quot;MPK_CA&quot;</span><span class="p">:</span>
                                            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_CA</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                        <span class="k">case</span> <span class="s2">&quot;MSK_CA&quot;</span><span class="p">:</span>
                                            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MSK_CA</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                        <span class="k">case</span> <span class="s2">&quot;MPK_AA&quot;</span><span class="p">:</span>
                                            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_AA</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                        <span class="k">case</span> <span class="s2">&quot;MSK_AA&quot;</span><span class="p">:</span>
                                            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MSK_AA</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                                            <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">master_key_attack</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">decryption_key_params</span><span class="p">:</span>
            <span class="n">decryption_attack</span> <span class="o">=</span> <span class="n">DecryptionAttack</span><span class="p">()</span>
            <span class="n">decryption_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">],</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">],</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;gp_encodings&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

            <span class="k">match</span> <span class="nb">str</span><span class="p">(</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]):</span>
               <span class="k">case</span> <span class="s1">&#39;NoCorruption&#39;</span><span class="p">:</span>
                  <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">)</span>
               <span class="k">case</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span>
                  <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
               <span class="k">case</span> <span class="s1">&#39;AA_extended&#39;</span><span class="p">:</span>
                  <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">)</span>
               <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                 <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">False</span>


            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]:</span>
                <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_mpk_AAi</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]:</span>
                <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_mpk_AAj</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]:</span>
                <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_misc</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_DK</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_DK</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;var&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>    
                            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">,</span> <span class="s2">&quot;MSK_AAi&quot;</span><span class="p">,</span> <span class="s2">&quot;misc&quot;</span><span class="p">]:</span>
                                <span class="k">match</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]):</span>
                                    <span class="k">case</span> <span class="s2">&quot;MPK_AAi&quot;</span><span class="p">:</span>
                                        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                    <span class="k">case</span> <span class="s2">&quot;MSK_AAi&quot;</span><span class="p">:</span>
                                        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">MSK_AAi</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                    <span class="k">case</span> <span class="s2">&quot;misc&quot;</span><span class="p">:</span>
                                        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">misc</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                                        <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decryption_attack</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">is_init_correct</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For those analysis with sufficient parameters, it runs them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">run_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For those analysis with sufficient parameters, it runs them.</span>
<span class="sd">        However, it only tries to find attacks whenever the security</span>
<span class="sd">        analysis fails.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Starting complete analysis&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;SecurityAttack&quot;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Security analysys&quot;</span><span class="p">)</span>
                    <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">trivial_secure</span> <span class="ow">or</span> <span class="n">attack</span><span class="o">.</span><span class="n">collusion_secure</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Looking for attacks...&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;MasterKeyAttack&quot;</span><span class="p">:</span>
                        <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;DecryptionAttack&quot;</span><span class="p">:</span>
                        <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;MasterKeyAttack&quot;</span><span class="p">:</span>
                        <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;DecryptionAttack&quot;</span><span class="p">:</span>
                        <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the results of the performed analysis.</span>

<span class="sd">        Returns:</span>
<span class="sd">            solution (list): The results obtained.</span>
<span class="sd">            proof_data (list): </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">proof_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">proof_header</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">match</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
                        <span class="k">case</span> <span class="s2">&quot;SecurityAttack&quot;</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[*] Security analysis results:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;sec_placeholder&quot;</span><span class="p">)</span>                           
                            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                            <span class="n">attack</span><span class="o">.</span><span class="n">show_proof</span><span class="p">()</span>
                            <span class="n">proof_data</span><span class="p">,</span> <span class="n">proof_header</span> <span class="o">=</span> <span class="n">attack</span><span class="o">.</span><span class="n">show_proof_latex</span><span class="p">()</span>                        
                        <span class="k">case</span> <span class="s2">&quot;MasterKeyAttack&quot;</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[*] Master key attack results:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">attack</span><span class="o">.</span><span class="n">format_encodings</span><span class="p">()</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;mk_placeholder&quot;</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">format_encodings_string</span><span class="p">())</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                        <span class="k">case</span> <span class="s2">&quot;DecryptionAttack&quot;</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[*] Decryption key attack results:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">attack</span><span class="o">.</span><span class="n">format_encodings</span><span class="p">()</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;da_placeholder&quot;</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">format_encodings_string</span><span class="p">())</span>                         
                            <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                            <span class="k">pass</span> <span class="c1"># TODO: catch error      </span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="p">,</span> <span class="n">proof_data</span><span class="p">,</span> <span class="n">proof_header</span>

    <span class="k">def</span> <span class="nf">is_scheme_fractional</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If there is a security analysis attached, it</span>
<span class="sd">        returns if the ABE scheme is fractional or not.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (bool): Is the scheme fractional ?</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;SecurityAttack&quot;</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">attack</span><span class="o">.</span><span class="n">is_fractional</span>

        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="analysis.AnalysisWithCorruption.init" class="doc doc-heading">
<code class="highlight language-python"><span class="n">init</span><span class="p">(</span><span class="n">master_key_params</span><span class="p">,</span> <span class="n">decryption_key_params</span><span class="p">,</span> <span class="n">corruptable_vars_MK</span><span class="p">,</span> <span class="n">corruptable_vars_DK</span><span class="p">,</span> <span class="n">security_analysis_params</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initializes the AnalysisWithCorruption class.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>master_key_params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Required parameters to look for master key attack.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>decryption_key_params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Required parameters to look for a decryption attack.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>corruptable_vars_MK</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The list of corruptable variables involved in the master key attack (if any).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>corruptable_vars_DK</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The list of corruptable variables involved in the decryption attack (if any).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>security_analysis_params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The required parameters to perform a security analysis of the scheme.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the inputs are valid e.g. corruption models and variable type are correct.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master_key_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">decryption_key_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">corruptable_vars_MK</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">corruptable_vars_DK</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">security_analysis_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the AnalysisWithCorruption class.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        master_key_params (dict): Required parameters to look for master key attack.</span>
<span class="sd">        decryption_key_params (dict): Required parameters to look for a decryption attack.</span>
<span class="sd">        corruptable_vars_MK (list): The list of corruptable variables involved in the master key attack (if any).</span>
<span class="sd">        corruptable_vars_DK (list): The list of corruptable variables involved in the decryption attack (if any).</span>
<span class="sd">        security_analysis_params (dict): The required parameters to perform a security analysis of the scheme.</span>


<span class="sd">    Returns:</span>
<span class="sd">        (bool): If the inputs are valid e.g. corruption models and variable type are correct.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_MK</span> <span class="o">=</span> <span class="n">corruptable_vars_MK</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_DK</span> <span class="o">=</span> <span class="n">corruptable_vars_DK</span>

    <span class="k">if</span> <span class="n">security_analysis_params</span><span class="p">:</span>
        <span class="n">security_attack</span> <span class="o">=</span> <span class="n">SecurityAttack</span><span class="p">()</span>
        <span class="n">security_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
                             <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span>
                             <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">],</span>
                             <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">],</span> 
                             <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">],</span>
                             <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

        <span class="c1"># update unknown variables array with list of corruptable vars</span>

        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]:</span>
            <span class="n">security_attack</span><span class="o">.</span><span class="n">add_corruptable_variable_generic</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">security_attack</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">master_key_params</span><span class="p">:</span>
        <span class="n">master_key_attack</span> <span class="o">=</span> <span class="n">MasterKeyAttack</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;NoCorruption&#39;</span><span class="p">:</span>
            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">SOL_MSG</span> <span class="o">=</span> <span class="s2">&quot;[*] Master key attack with corruption found: &quot;</span>
            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="s2">&quot;[!] No Master key attack with corruption found&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">SOL_MSG</span> <span class="o">=</span> <span class="s2">&quot;[*] Master key attack found: &quot;</span>
            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="s2">&quot;[!] No Master key attack found. &quot;</span>

        <span class="n">master_key_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;masterkey&quot;</span><span class="p">],</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;keyenco&quot;</span><span class="p">],</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

        <span class="k">match</span> <span class="nb">str</span><span class="p">(</span><span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]):</span>
           <span class="k">case</span> <span class="s1">&#39;NoCorruption&#39;</span><span class="p">:</span>
              <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">)</span>
           <span class="k">case</span> <span class="s2">&quot;CA&quot;</span><span class="p">:</span>
              <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">CA</span><span class="p">)</span>
           <span class="k">case</span> <span class="s1">&#39;AA&#39;</span><span class="p">:</span>
              <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
           <span class="k">case</span> <span class="s1">&#39;mixed_CA_corr&#39;</span><span class="p">:</span>
              <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_CA</span><span class="p">)</span>
           <span class="k">case</span> <span class="s1">&#39;mixed_AA_corr&#39;</span><span class="p">:</span>
              <span class="n">master_key_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">MasterKeyCorruptionModel</span><span class="o">.</span><span class="n">mixed_AA</span><span class="p">)</span>
           <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
             <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]:</span>
            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_mpk_CA</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]:</span>
            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_mpk_AA</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]:</span>
            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_mpk</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">master_key_params</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]:</span>
            <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_gp_variable</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_MK</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_MK</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;var&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">,</span> <span class="s2">&quot;MSK_CA&quot;</span><span class="p">,</span> <span class="s2">&quot;MPK_AA&quot;</span><span class="p">,</span> <span class="s2">&quot;MSK_AA&quot;</span><span class="p">]:</span>
                                <span class="k">match</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]):</span>
                                    <span class="k">case</span> <span class="s2">&quot;MPK_CA&quot;</span><span class="p">:</span>
                                        <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_CA</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                    <span class="k">case</span> <span class="s2">&quot;MSK_CA&quot;</span><span class="p">:</span>
                                        <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MSK_CA</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                    <span class="k">case</span> <span class="s2">&quot;MPK_AA&quot;</span><span class="p">:</span>
                                        <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_AA</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                    <span class="k">case</span> <span class="s2">&quot;MSK_AA&quot;</span><span class="p">:</span>
                                        <span class="n">master_key_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">MasterKeyCorruptedVariable</span><span class="o">.</span><span class="n">MSK_AA</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                                        <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">master_key_attack</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">decryption_key_params</span><span class="p">:</span>
        <span class="n">decryption_attack</span> <span class="o">=</span> <span class="n">DecryptionAttack</span><span class="p">()</span>
        <span class="n">decryption_attack</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">],</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">],</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;gp_encodings&quot;</span><span class="p">],</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">])</span>

        <span class="k">match</span> <span class="nb">str</span><span class="p">(</span><span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]):</span>
           <span class="k">case</span> <span class="s1">&#39;NoCorruption&#39;</span><span class="p">:</span>
              <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">NoCorruption</span><span class="p">)</span>
           <span class="k">case</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span>
              <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
           <span class="k">case</span> <span class="s1">&#39;AA_extended&#39;</span><span class="p">:</span>
              <span class="n">decryption_attack</span><span class="o">.</span><span class="n">set_corruption_model</span><span class="p">(</span><span class="n">DecryptionKeyCorruptionModel</span><span class="o">.</span><span class="n">AA_extended</span><span class="p">)</span>
           <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
             <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]:</span>
            <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_mpk_AAi</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]:</span>
            <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_mpk_AAj</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">decryption_key_params</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]:</span>
            <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_misc</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_DK</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corruptable_vars_DK</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;var&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>    
                        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">,</span> <span class="s2">&quot;MSK_AAi&quot;</span><span class="p">,</span> <span class="s2">&quot;misc&quot;</span><span class="p">]:</span>
                            <span class="k">match</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]):</span>
                                <span class="k">case</span> <span class="s2">&quot;MPK_AAi&quot;</span><span class="p">:</span>
                                    <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">MPK_AAi</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                <span class="k">case</span> <span class="s2">&quot;MSK_AAi&quot;</span><span class="p">:</span>
                                    <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">MSK_AAi</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                <span class="k">case</span> <span class="s2">&quot;misc&quot;</span><span class="p">:</span>
                                    <span class="n">decryption_attack</span><span class="o">.</span><span class="n">add_corruptable_var</span><span class="p">(</span><span class="n">DecryptionKeyCorruptedVariable</span><span class="o">.</span><span class="n">misc</span><span class="p">,</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]))</span>
                                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                                    <span class="n">is_init_correct</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decryption_attack</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">is_init_correct</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="analysis.AnalysisWithCorruption.is_scheme_fractional" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_scheme_fractional</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>If there is a security analysis attached, it
returns if the ABE scheme is fractional or not.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Is the scheme fractional ?</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_scheme_fractional</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If there is a security analysis attached, it</span>
<span class="sd">    returns if the ABE scheme is fractional or not.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Is the scheme fractional ?</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;SecurityAttack&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">attack</span><span class="o">.</span><span class="n">is_fractional</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="analysis.AnalysisWithCorruption.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>For those analysis with sufficient parameters, it runs them.</p>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For those analysis with sufficient parameters, it runs them.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="analysis.AnalysisWithCorruption.run_logic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_logic</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>For those analysis with sufficient parameters, it runs them.
However, it only tries to find attacks whenever the security
analysis fails.</p>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For those analysis with sufficient parameters, it runs them.</span>
<span class="sd">    However, it only tries to find attacks whenever the security</span>
<span class="sd">    analysis fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Starting complete analysis&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;SecurityAttack&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Security analysys&quot;</span><span class="p">)</span>
                <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">trivial_secure</span> <span class="ow">or</span> <span class="n">attack</span><span class="o">.</span><span class="n">collusion_secure</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Looking for attacks...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;MasterKeyAttack&quot;</span><span class="p">:</span>
                    <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;DecryptionAttack&quot;</span><span class="p">:</span>
                    <span class="n">attack</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;MasterKeyAttack&quot;</span><span class="p">:</span>
                    <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;DecryptionAttack&quot;</span><span class="p">:</span>
                    <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="analysis.AnalysisWithCorruption.show_solution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_solution</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the results of the performed analysis.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>solution</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The results obtained.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>proof_data</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>analysis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the results of the performed analysis.</span>

<span class="sd">    Returns:</span>
<span class="sd">        solution (list): The results obtained.</span>
<span class="sd">        proof_data (list): </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">proof_data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">proof_header</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">attack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attack</span><span class="o">.</span><span class="n">enabled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">match</span> <span class="n">attack</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
                    <span class="k">case</span> <span class="s2">&quot;SecurityAttack&quot;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[*] Security analysis results:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;sec_placeholder&quot;</span><span class="p">)</span>                           
                        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                        <span class="n">attack</span><span class="o">.</span><span class="n">show_proof</span><span class="p">()</span>
                        <span class="n">proof_data</span><span class="p">,</span> <span class="n">proof_header</span> <span class="o">=</span> <span class="n">attack</span><span class="o">.</span><span class="n">show_proof_latex</span><span class="p">()</span>                        
                    <span class="k">case</span> <span class="s2">&quot;MasterKeyAttack&quot;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[*] Master key attack results:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">attack</span><span class="o">.</span><span class="n">format_encodings</span><span class="p">()</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;mk_placeholder&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">format_encodings_string</span><span class="p">())</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                    <span class="k">case</span> <span class="s2">&quot;DecryptionAttack&quot;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[*] Decryption key attack results:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">attack</span><span class="o">.</span><span class="n">format_encodings</span><span class="p">()</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;da_placeholder&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">format_encodings_string</span><span class="p">())</span>                         
                        <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attack</span><span class="o">.</span><span class="n">show_solution</span><span class="p">())</span>
                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                        <span class="k">pass</span> <span class="c1"># TODO: catch error      </span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_list</span><span class="p">,</span> <span class="n">proof_data</span><span class="p">,</span> <span class="n">proof_header</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="json-parsing-of-acabella-parameters">JSON parsing of ACABELLA parameters</h2>


<div class="doc doc-object doc-module">


<a id="parse_config"></a>
  <div class="doc doc-contents first">
  
      <p>parse_config.py: JSON parser for ACABELLA analysis</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="parse_config.ParseConfig" class="doc doc-heading">
          <code>ParseConfig</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>This class parses the JSON input files for ACABELLA involving
all type of checks: master key attacks, decryption attacks,
security analysis via AC17, etc.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>json_parsed</code></td>
          <td>
                <code>string</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Resulting string after JSON parsing.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>parse_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ParseConfig</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class parses the JSON input files for ACABELLA involving</span>
<span class="sd">    all type of checks: master key attacks, decryption attacks,</span>
<span class="sd">    security analysis via AC17, etc.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        json_parsed (string): Resulting string after JSON parsing.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="o">=</span> <span class="kc">None</span> 

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the parser with a json configuration file</span>
<span class="sd">        that describes the analysis.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            config_file (str): Path to the JSON file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">read_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">read_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">init_with_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        It is also possible to initialize the parser with</span>
<span class="sd">        a string containing JSON instead of using a file</span>
<span class="sd">        that needs to be open, read, etc.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            data (str): String containing JSON code.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_master_key_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Based on the JSON input files, it generates a dictionary</span>
<span class="sd">        with the corresponding parameters to look for master key</span>
<span class="sd">        attacks. If a list of corruptable variables is supplied,</span>
<span class="sd">        it also generates a list of those variables.</span>

<span class="sd">        Returns:</span>
<span class="sd">                Tuple (tuple): Master key attack parameters and corruptable variables. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">master_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">corruptable_vars</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;keyenco&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;masterkey&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;master_key&quot;</span><span class="p">])</span>
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span>

            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]]</span> 

            <span class="n">corruptable_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">master_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">master_params</span><span class="p">,</span> <span class="n">corruptable_vars</span>

    <span class="k">def</span> <span class="nf">generate_dec_key_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Based on the JSON input files, it generates a dictionary</span>
<span class="sd">        with the corresponding parameters to look for decryption</span>
<span class="sd">        attacks. If a list of corruptable variables is supplied,</span>
<span class="sd">        it also generates a list of those variables.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple (tuple): Decryption attack parameters and corruptable variables</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="c1"># prepare decryption params</span>

        <span class="n">dec_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">corruptable_vars</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;gp_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;gp&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 

            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span>

            <span class="c1"># NOTE We suppose every field is always available in the JSON file.</span>
            <span class="c1"># It will be empty if it is not related to a particular corruption model.</span>

            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]]</span> 

            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]]</span> 

            <span class="n">corruptable_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">dec_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">dec_params</span><span class="p">,</span> <span class="n">corruptable_vars</span> 

    <span class="k">def</span> <span class="nf">generate_conditional_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Based on the JSON input files, it generates a dictionary</span>
<span class="sd">        with the corresponding parameters to look for conditional</span>
<span class="sd">        attacks. If a list of corruptable variables is supplied,</span>
<span class="sd">        it also generates a list of those variables.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parameters (dict): Conditional attack parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        TODO: Some of this configuration generation can be automated e.g.</span>
<span class="sd">            # these are fixed in the system</span>
<span class="sd">            att_mpk_group = parse_expr(&quot;att_mpk_group&quot;)</span>
<span class="sd">            att_scalar = parse_expr(&quot;att_scalar&quot;)</span>
<span class="sd">            policy_share = parse_expr(&quot;lambda_policy_share&quot;)</span>

<span class="sd">            k_fixed_1 = alpha + r</span>
<span class="sd">            k_att_1 = r + get_indexed_encoding(&quot;rp&quot;, 1)*att_mpk_group</span>
<span class="sd">            k_att_2 = get_indexed_encoding(&quot;rp&quot;, 1)</span>
<span class="sd">            c_att_1 = policy_share*att_mpk_group</span>
<span class="sd">            c_att_2 = policy_share</span>
<span class="sd">            mpk1 = att_mpk_group</span>
<span class="sd">            special_s = s</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">att_mpk_group</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;att_mpk_group&quot;</span><span class="p">)</span>
            <span class="n">att_scalar</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;att_scalar&quot;</span><span class="p">)</span>
            <span class="n">policy_share</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;lambda_policy_share&quot;</span><span class="p">)</span>

            <span class="n">mpk1</span> <span class="o">=</span> <span class="n">att_mpk_group</span>
            <span class="n">special_s</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
            <span class="n">k_fixed</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k_fixed&quot;</span><span class="p">]]</span> 
            <span class="n">k_att</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k_indexed&quot;</span><span class="p">]]</span> 
            <span class="n">c_fixed</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c_fixed&quot;</span><span class="p">]]</span> 
            <span class="n">c_att</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c_indexed&quot;</span><span class="p">]]</span> 
            <span class="n">unkown</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]]</span> 

            <span class="n">mpk</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rp&quot;</span><span class="p">]</span>
            <span class="n">nr_indexed_encodings</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># prepare conditional params</span>

            <span class="n">cd_params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">)</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;special_s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">special_s</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpk</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;k_fixed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_fixed</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;k_att&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_att</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;c_fixed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_fixed</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;c_att&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_att</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;unkown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;prefixes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefixes</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;nr_indexed_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nr_indexed_encodings</span>
            <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unkown</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cd_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">cd_params</span>

    <span class="k">def</span> <span class="nf">generate_abgw_bridge_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Based on the JSON input files, it generates a dictionary</span>
<span class="sd">        with the corresponding parameters to transform a description</span>
<span class="sd">        of an ABE scheme in ACABELLA format into a configuration file</span>
<span class="sd">        to the tool that creates inputs for the ABGW tool in order</span>
<span class="sd">        to check the security of the scheme.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parameters (dict): ABGW parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
            <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
            <span class="n">mpk</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
            <span class="n">gp</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;gp&quot;</span><span class="p">]]</span> 

            <span class="c1"># prepare abgw params</span>

            <span class="n">abgw_params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
            <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
            <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
            <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpk</span>
            <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;gp_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gp</span>

            <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
            <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;known&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;known_vars&quot;</span><span class="p">]]</span> 
        <span class="k">except</span><span class="p">:</span>
            <span class="n">abgw_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">abgw_params</span>

    <span class="k">def</span> <span class="nf">generate_security_analysis_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Based on the JSON input files, it generates a dictionary</span>
<span class="sd">        with the corresponding parameters to perform a security</span>
<span class="sd">        analysis of the provided scheme.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parameters (dict): Security analysis parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="c1"># prepare security_analysis_params</span>

        <span class="n">security_analysis_params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
            <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
            <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
            <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
            <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
            <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]]</span> 
        <span class="k">except</span><span class="p">:</span>
            <span class="n">security_analysis_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">security_analysis_params</span>

    <span class="k">def</span> <span class="nf">generate_all_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Based on the JSON input files, it generates a dictionary</span>
<span class="sd">        with the corresponding parameters to look for decryption</span>
<span class="sd">        and master key attacks as well as to check the security</span>
<span class="sd">        of the provided ABE scheme.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parameters (dict): All involved parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>       
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">master_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">corruptable_vars_master</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">dec_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">corruptable_vars_dec</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># parse security params</span>

        <span class="n">security_params_json</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">security_params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">security_params_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span>
            <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
            <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
            <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
            <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
            <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
            <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]]</span> 
        <span class="k">except</span><span class="p">:</span>
            <span class="n">security_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># parse dec params</span>

        <span class="n">dec_params_json</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">corruptable_vars_dec</span> <span class="o">=</span>  <span class="kc">None</span>
        <span class="n">dec_params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">dec_params_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;decryption&quot;</span><span class="p">]</span>
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;gp_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;gp&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span>

            <span class="c1"># NOTE We suppose every field is always available in the JSON file.</span>
            <span class="c1"># It will be empty if it is not related to a particular corruption model.</span>

            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]]</span> 
            <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]]</span> 
            <span class="n">corruptable_vars_dec</span> <span class="o">=</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">dec_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># parse master params</span>

        <span class="n">master_params_json</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">corruptable_vars_master</span> <span class="o">=</span> <span class="kc">None</span>        

        <span class="k">try</span><span class="p">:</span>
            <span class="n">master_params_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;master_key&quot;</span><span class="p">]</span>

            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;keyenco&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;masterkey&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;master_key&quot;</span><span class="p">])</span>
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span>

            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]]</span> 
            <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]]</span> 
            <span class="n">corruptable_vars_master</span> <span class="o">=</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">master_params</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">security_params</span><span class="p">,</span> <span class="n">master_params</span><span class="p">,</span> <span class="n">corruptable_vars_master</span><span class="p">,</span> <span class="n">dec_params</span><span class="p">,</span> <span class="n">corruptable_vars_dec</span> 
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="parse_config.ParseConfig.generate_abgw_bridge_params" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_abgw_bridge_params</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Based on the JSON input files, it generates a dictionary
with the corresponding parameters to transform a description
of an ABE scheme in ACABELLA format into a configuration file
to the tool that creates inputs for the ABGW tool in order
to check the security of the scheme.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Parameters</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ABGW parameters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>parse_config.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_abgw_bridge_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Based on the JSON input files, it generates a dictionary</span>
<span class="sd">    with the corresponding parameters to transform a description</span>
<span class="sd">    of an ABE scheme in ACABELLA format into a configuration file</span>
<span class="sd">    to the tool that creates inputs for the ABGW tool in order</span>
<span class="sd">    to check the security of the scheme.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Parameters (dict): ABGW parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
        <span class="n">mpk</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
        <span class="n">gp</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;gp&quot;</span><span class="p">]]</span> 

        <span class="c1"># prepare abgw params</span>

        <span class="n">abgw_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
        <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
        <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpk</span>
        <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;gp_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gp</span>

        <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
        <span class="n">abgw_params</span><span class="p">[</span><span class="s2">&quot;known&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;known_vars&quot;</span><span class="p">]]</span> 
    <span class="k">except</span><span class="p">:</span>
        <span class="n">abgw_params</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">abgw_params</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="parse_config.ParseConfig.generate_all_params" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_all_params</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Based on the JSON input files, it generates a dictionary
with the corresponding parameters to look for decryption
and master key attacks as well as to check the security
of the provided ABE scheme.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Parameters</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>All involved parameters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>parse_config.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_all_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Based on the JSON input files, it generates a dictionary</span>
<span class="sd">    with the corresponding parameters to look for decryption</span>
<span class="sd">    and master key attacks as well as to check the security</span>
<span class="sd">    of the provided ABE scheme.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Parameters (dict): All involved parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>       
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="n">master_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">corruptable_vars_master</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dec_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">corruptable_vars_dec</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># parse security params</span>

    <span class="n">security_params_json</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">security_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">security_params_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span>
        <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
        <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
        <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
        <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
        <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
        <span class="n">security_params</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">security_params_json</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]]</span> 
    <span class="k">except</span><span class="p">:</span>
        <span class="n">security_params</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># parse dec params</span>

    <span class="n">dec_params_json</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">corruptable_vars_dec</span> <span class="o">=</span>  <span class="kc">None</span>
    <span class="n">dec_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dec_params_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;decryption&quot;</span><span class="p">]</span>
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;gp_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;gp&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span>

        <span class="c1"># NOTE We suppose every field is always available in the JSON file.</span>
        <span class="c1"># It will be empty if it is not related to a particular corruption model.</span>

        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]]</span> 
        <span class="n">corruptable_vars_dec</span> <span class="o">=</span> <span class="n">dec_params_json</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">dec_params</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># parse master params</span>

    <span class="n">master_params_json</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">corruptable_vars_master</span> <span class="o">=</span> <span class="kc">None</span>        

    <span class="k">try</span><span class="p">:</span>
        <span class="n">master_params_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;master_key&quot;</span><span class="p">]</span>

        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;keyenco&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;masterkey&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;master_key&quot;</span><span class="p">])</span>
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span>

        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]]</span> 
        <span class="n">corruptable_vars_master</span> <span class="o">=</span> <span class="n">master_params_json</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">master_params</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">security_params</span><span class="p">,</span> <span class="n">master_params</span><span class="p">,</span> <span class="n">corruptable_vars_master</span><span class="p">,</span> <span class="n">dec_params</span><span class="p">,</span> <span class="n">corruptable_vars_dec</span> 
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="parse_config.ParseConfig.generate_conditional_params" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_conditional_params</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Based on the JSON input files, it generates a dictionary
with the corresponding parameters to look for conditional
attacks. If a list of corruptable variables is supplied,
it also generates a list of those variables.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Parameters</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Conditional attack parameters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>parse_config.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_conditional_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Based on the JSON input files, it generates a dictionary</span>
<span class="sd">    with the corresponding parameters to look for conditional</span>
<span class="sd">    attacks. If a list of corruptable variables is supplied,</span>
<span class="sd">    it also generates a list of those variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Parameters (dict): Conditional attack parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TODO: Some of this configuration generation can be automated e.g.</span>
<span class="sd">        # these are fixed in the system</span>
<span class="sd">        att_mpk_group = parse_expr(&quot;att_mpk_group&quot;)</span>
<span class="sd">        att_scalar = parse_expr(&quot;att_scalar&quot;)</span>
<span class="sd">        policy_share = parse_expr(&quot;lambda_policy_share&quot;)</span>

<span class="sd">        k_fixed_1 = alpha + r</span>
<span class="sd">        k_att_1 = r + get_indexed_encoding(&quot;rp&quot;, 1)*att_mpk_group</span>
<span class="sd">        k_att_2 = get_indexed_encoding(&quot;rp&quot;, 1)</span>
<span class="sd">        c_att_1 = policy_share*att_mpk_group</span>
<span class="sd">        c_att_2 = policy_share</span>
<span class="sd">        mpk1 = att_mpk_group</span>
<span class="sd">        special_s = s</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">att_mpk_group</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;att_mpk_group&quot;</span><span class="p">)</span>
        <span class="n">att_scalar</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;att_scalar&quot;</span><span class="p">)</span>
        <span class="n">policy_share</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;lambda_policy_share&quot;</span><span class="p">)</span>

        <span class="n">mpk1</span> <span class="o">=</span> <span class="n">att_mpk_group</span>
        <span class="n">special_s</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
        <span class="n">k_fixed</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k_fixed&quot;</span><span class="p">]]</span> 
        <span class="n">k_att</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k_indexed&quot;</span><span class="p">]]</span> 
        <span class="n">c_fixed</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c_fixed&quot;</span><span class="p">]]</span> 
        <span class="n">c_att</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c_indexed&quot;</span><span class="p">]]</span> 
        <span class="n">unkown</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]]</span> 

        <span class="n">mpk</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rp&quot;</span><span class="p">]</span>
        <span class="n">nr_indexed_encodings</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># prepare conditional params</span>

        <span class="n">cd_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">)</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;special_s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">special_s</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpk</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;k_fixed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_fixed</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;k_att&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_att</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;c_fixed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_fixed</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;c_att&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_att</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;unkown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;prefixes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefixes</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;nr_indexed_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nr_indexed_encodings</span>
        <span class="n">cd_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unkown</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">cd_params</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">cd_params</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="parse_config.ParseConfig.generate_dec_key_params" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_dec_key_params</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Based on the JSON input files, it generates a dictionary
with the corresponding parameters to look for decryption
attacks. If a list of corruptable variables is supplied,
it also generates a list of those variables.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Tuple</code></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Decryption attack parameters and corruptable variables</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>parse_config.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_dec_key_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Based on the JSON input files, it generates a dictionary</span>
<span class="sd">    with the corresponding parameters to look for decryption</span>
<span class="sd">    attacks. If a list of corruptable variables is supplied,</span>
<span class="sd">    it also generates a list of those variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple (tuple): Decryption attack parameters and corruptable variables</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="c1"># prepare decryption params</span>

    <span class="n">dec_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">corruptable_vars</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;gp_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;gp&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 

        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span>

        <span class="c1"># NOTE We suppose every field is always available in the JSON file.</span>
        <span class="c1"># It will be empty if it is not related to a particular corruption model.</span>

        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_AAi&quot;</span><span class="p">]]</span> 
        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_AAj&quot;</span><span class="p">]]</span> 

        <span class="n">dec_params</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;misc_vars&quot;</span><span class="p">]]</span> 

        <span class="n">corruptable_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">dec_params</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">dec_params</span><span class="p">,</span> <span class="n">corruptable_vars</span> 
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="parse_config.ParseConfig.generate_master_key_params" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_master_key_params</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Based on the JSON input files, it generates a dictionary
with the corresponding parameters to look for master key
attacks. If a list of corruptable variables is supplied,
it also generates a list of those variables.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Tuple</code></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Master key attack parameters and corruptable variables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>parse_config.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_master_key_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Based on the JSON input files, it generates a dictionary</span>
<span class="sd">    with the corresponding parameters to look for master key</span>
<span class="sd">    attacks. If a list of corruptable variables is supplied,</span>
<span class="sd">    it also generates a list of those variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">            Tuple (tuple): Master key attack parameters and corruptable variables. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="n">master_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">corruptable_vars</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;keyenco&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;masterkey&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;master_key&quot;</span><span class="p">])</span>
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruption_model&quot;</span><span class="p">]</span>

        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_CA&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_AA&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;MPK_vars&quot;</span><span class="p">]]</span> 
        <span class="n">master_params</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;GP_vars&quot;</span><span class="p">]]</span> 

        <span class="n">corruptable_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">master_params</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">master_params</span><span class="p">,</span> <span class="n">corruptable_vars</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="parse_config.ParseConfig.generate_security_analysis_params" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_security_analysis_params</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Based on the JSON input files, it generates a dictionary
with the corresponding parameters to perform a security
analysis of the provided scheme.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Parameters</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Security analysis parameters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>parse_config.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_security_analysis_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Based on the JSON input files, it generates a dictionary</span>
<span class="sd">    with the corresponding parameters to perform a security</span>
<span class="sd">    analysis of the provided scheme.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Parameters (dict): Security analysis parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parse_config object is not initialized&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="c1"># prepare security_analysis_params</span>

    <span class="n">security_analysis_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
        <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;k_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]]</span> 
        <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;c_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]]</span>  
        <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;mpk_encodings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;mpk&quot;</span><span class="p">]]</span> 
        <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;unknown&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;unknown_vars&quot;</span><span class="p">]]</span> 
        <span class="n">security_analysis_params</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span><span class="p">[</span><span class="s2">&quot;corruptable_vars&quot;</span><span class="p">]]</span> 
    <span class="k">except</span><span class="p">:</span>
        <span class="n">security_analysis_params</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">security_analysis_params</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="parse_config.ParseConfig.init" class="doc doc-heading">
<code class="highlight language-python"><span class="n">init</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initializes the parser with a json configuration file
that describes the analysis.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>config_file</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the JSON file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>parse_config.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the parser with a json configuration file</span>
<span class="sd">    that describes the analysis.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        config_file (str): Path to the JSON file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">read_file</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">read_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="parse_config.ParseConfig.init_with_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">init_with_str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>It is also possible to initialize the parser with
a string containing JSON instead of using a file
that needs to be open, read, etc.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String containing JSON code.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>parse_config.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">init_with_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It is also possible to initialize the parser with</span>
<span class="sd">    a string containing JSON instead of using a file</span>
<span class="sd">    that needs to be open, read, etc.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        data (str): String containing JSON code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">json_parsed</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="methods-for-generating-indexed-encodings-and-specific-access-structures">Methods for generating indexed encodings and specific access structures</h2>


<div class="doc doc-object doc-module">


<a id="access_structures"></a>
  <div class="doc doc-contents first">
  
      <p>access_structures.py: This module contains functions for generating specific
access structures and for generating encodings utilized in the ACABELLA
analysis methods.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="access_structures.create_policy_matrix_for_AND" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_policy_matrix_for_AND</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a policy matrix for the AND-gate of a given length.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>length</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of the policy matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Policy matrix for AND.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_policy_matrix_for_AND</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a policy matrix for the AND-gate of a given length.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        length (int): Length of the policy matrix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (array): Policy matrix for AND.</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">matrix_A</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
    <span class="n">matrix_A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">matrix_A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">matrix_A</span><span class="p">[</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">matrix_A</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">matrix_A</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">matrix_A</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="access_structures.create_policy_matrix_for_general_access_policy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_policy_matrix_for_general_access_policy</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a policy matrix for the  general case of a given length.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>length</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of the policy matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Policy matrix for AND.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_policy_matrix_for_general_access_policy</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a policy matrix for the  general case of a given length.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        length (int): Length of the policy matrix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (array): Policy matrix for AND.</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">matrix_A</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">sum_row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">length</span><span class="p">):</span>
            <span class="n">new_entry</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;A_(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
            <span class="n">matrix_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_entry</span>
            <span class="n">w_entry</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;w_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">sum_row</span> <span class="o">-=</span> <span class="n">new_entry</span><span class="o">*</span><span class="n">w_entry</span>
        <span class="c1"># matrix_A[i,0] = parse_expr(&quot;A_(&quot; + str(i+1) + &quot;,1)&quot;)</span>
        <span class="n">matrix_A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum_row</span>
    <span class="k">return</span> <span class="n">matrix_A</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="access_structures.create_share_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_share_vector</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">special_s</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a share vector v.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>length</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of the policy matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy description of s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vector of shares.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_share_vector</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">special_s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a share vector v.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        length (int): Length of the policy matrix.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Sympy description of s.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Vector of shares.</span>
<span class="sd">    &quot;&quot;&quot;</span>      
    <span class="n">vec_v</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">vec_v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">special_s</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">length</span><span class="p">):</span>
        <span class="n">vec_v</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;v_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">vec_v</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="access_structures.get_attribute_as_scalar" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_attribute_as_scalar</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns a scalar x_att for some index</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index to add at the end of the encoding.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Encoding starting with x_</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_attribute_as_scalar</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a scalar x_att for some index</span>

<span class="sd">    Parameters:</span>
<span class="sd">        index (str): Index to add at the end of the encoding.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (sp.core.list.Symbol): Encoding starting with x_</span>
<span class="sd">    &quot;&quot;&quot;</span>      
    <span class="k">return</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="access_structures.get_attribute_in_group" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_attribute_in_group</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns a public key b_att for attribute with index</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index to add at the end of the encoding.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Encoding starting with b_</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_attribute_in_group</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a public key b_att for attribute with index</span>

<span class="sd">    Parameters:</span>
<span class="sd">        index (str): Index to add at the end of the encoding.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (sp.core.list.Symbol): Encoding starting with b_</span>
<span class="sd">    &quot;&quot;&quot;</span>      
    <span class="k">return</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;b_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="access_structures.get_i_of_n_policy_shares" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_i_of_n_policy_shares</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">special_s</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the i-th share for a policy of length n for a policy 
consisting of an AND-gate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Position in the lambda vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>length</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of the AND policy matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy description of s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value of lambda vector at index position.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_i_of_n_policy_shares</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">special_s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the i-th share for a policy of length n for a policy </span>
<span class="sd">    consisting of an AND-gate.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        index (int): Position in the lambda vector.</span>
<span class="sd">        length (int): Length of the AND policy matrix.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Sympy description of s.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (sp.core.list.Symbol): Value of lambda vector at index position.</span>
<span class="sd">    &quot;&quot;&quot;</span>      
    <span class="n">vec_lambda</span> <span class="o">=</span> <span class="n">create_policy_matrix_for_AND</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">*</span> <span class="n">create_share_vector</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">special_s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vec_lambda</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="access_structures.get_i_of_n_policy_shares_general" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_i_of_n_policy_shares_general</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">special_s</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the i-th share for a policy of length n where the policy is a general matrix.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Position in the lambda vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>length</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of the AND policy matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy description of s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value of lambda vector at index position.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_i_of_n_policy_shares_general</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">special_s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the i-th share for a policy of length n where the policy is a general matrix.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        index (int): Position in the lambda vector.</span>
<span class="sd">        length (int): Length of the AND policy matrix.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Sympy description of s.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (sp.core.list.Symbol): Value of lambda vector at index position.</span>
<span class="sd">    &quot;&quot;&quot;</span>      
    <span class="n">vec_lambda</span> <span class="o">=</span> <span class="n">create_policy_matrix_for_general_access_policy</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">*</span> <span class="n">create_share_vector</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">special_s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vec_lambda</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="access_structures.get_indexed_encoding" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_indexed_encoding</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns an indexed encoding with prefix with extra indices for the 
attribute and the key nr, e.g., r_(1,att).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>prefix</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prefix to add to the encoding.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index to add at the end of the encoding.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indexed encoding</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_indexed_encoding</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an indexed encoding with prefix with extra indices for the </span>
<span class="sd">    attribute and the key nr, e.g., r_(1,att).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        prefix (str): Prefix to add to the encoding.</span>
<span class="sd">        index (str): Index to add at the end of the encoding.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (sp.core.list.Symbol): Indexed encoding </span>
<span class="sd">    &quot;&quot;&quot;</span>      
    <span class="k">return</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;indexed_enc_&quot;</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="access_structures.get_indexed_encoding_extra_index" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_indexed_encoding_extra_index</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">,</span> <span class="n">index_key</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns an indexed encoding with prefix with extra indices (2) for the 
attribute and the key nr, e.g., r_(1,att).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>prefix</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prefix to add to the encoding.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index1</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>First index to add.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index2</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Second index to add.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index to add at the end of the encoding.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indexed encoding</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>access_structures.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_indexed_encoding_extra_index</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">,</span> <span class="n">index_key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an indexed encoding with prefix with extra indices (2) for the </span>
<span class="sd">    attribute and the key nr, e.g., r_(1,att).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        prefix (str): Prefix to add to the encoding.</span>
<span class="sd">        index1 (str): First index to add.</span>
<span class="sd">        index2 (str): Second index to add.</span>
<span class="sd">        index_key (str): Index to add at the end of the encoding.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (sp.core.list.Symbol): Indexed encoding </span>
<span class="sd">    &quot;&quot;&quot;</span>      
    <span class="k">return</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;_(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,att_&quot;</span> 
                      <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_key</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="methods-for-working-with-sympy-symbols">Methods for working with Sympy symbols</h2>


<div class="doc doc-object doc-module">


<a id="doc_common"></a>
  <div class="doc doc-contents first">
  
      <p>common.py: general methods for dealing with symbols in the attack
and analysis implementations</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="doc_common.addcomptodecomp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">addcomptodecomp</span><span class="p">(</span><span class="n">kvector</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">toadd</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds a new monomial split in a known and unknown part to kvector and uvector</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Known vector of variables</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown vector of variables</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>toadd</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Monomial split</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">addcomptodecomp</span><span class="p">(</span><span class="n">kvector</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">uvector</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">toadd</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a new monomial split in a known and unknown part to kvector and uvector</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kvector (list): Known vector of variables</span>
<span class="sd">        uvector (list): Unknown vector of variables</span>
<span class="sd">        toadd (list): Monomial split</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">toadd</span>
    <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">umul</span><span class="p">)</span> <span class="o">=</span> <span class="n">invector</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span>
    <span class="n">kmul</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="n">kmul</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="n">kmul</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">kvector</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Add</span><span class="p">(</span><span class="n">kvector</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">kmul</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kmul</span><span class="p">)</span>
        <span class="n">uvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">umul</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.appendzeros" class="doc doc-heading">
<code class="highlight language-python"><span class="n">appendzeros</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Takes a matrix as input and makes each row as long as uvector</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mat</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input matrix</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown vector of variables</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">appendzeros</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a matrix as input and makes each row as long as uvector</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mat (array): Input matrix</span>
<span class="sd">        uvector (list): Unknown vector of variables</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">mat</span><span class="p">:</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.canonical" class="doc doc-heading">
<code class="highlight language-python"><span class="n">canonical</span><span class="p">(</span><span class="n">listpolys</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>First ensure that all polynomials are in canonical form.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>listpolys</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of poynomials.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of polynomials in canonical form.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">canonical</span><span class="p">(</span><span class="n">listpolys</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    First ensure that all polynomials are in canonical form.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        listpolys (list): List of poynomials.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): List of polynomials in canonical form.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">copylist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">listpolys</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
        <span class="n">copylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">copylist</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.collect_denoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">collect_denoms</span><span class="p">(</span><span class="n">lis</span><span class="p">,</span> <span class="n">unknowns</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Collects the denominators of the encodings
not to be confused with demons</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lis</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input list of sp.core.list.Symbol expressions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknowns as sympy expressions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of denominators.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">collect_denoms</span><span class="p">(</span><span class="n">lis</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unknowns</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collects the denominators of the encodings</span>
<span class="sd">    not to be confused with demons</span>

<span class="sd">    Parameters:</span>
<span class="sd">        lis (list): Input list of sp.core.list.Symbol expressions.</span>
<span class="sd">        unknown (list): List of unknowns as sympy expressions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): List of denominators.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="c1">## this part is the same as in writepolyasprod</span>
    <span class="n">colmono</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
        <span class="n">recovermonos</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">colmono</span><span class="p">)</span>
        <span class="n">cmcpy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">colmono</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">f</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">cmcpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">variables</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">cmcpy</span><span class="p">:</span>
        <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
    <span class="n">denoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_var_denom</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">var_contains_unknown</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">unknowns</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">is_var_not_in_list</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">denoms</span><span class="p">):</span>
                    <span class="n">denoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">denoms</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.decompose" class="doc doc-heading">
<code class="highlight language-python"><span class="n">decompose</span><span class="p">(</span><span class="n">lisi</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Decomposes list lisi of variables in two lists:
k = list of known variables and u = list of unknown variables</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lisi</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of variables</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unkonwn variables</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>According to the intersection of lis1 and list2</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">decompose</span><span class="p">(</span><span class="n">lisi</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decomposes list lisi of variables in two lists:</span>
<span class="sd">    k = list of known variables and u = list of unknown variables</span>

<span class="sd">    Parameters:</span>
<span class="sd">        lisi (list): List of variables</span>
<span class="sd">        unknown (list): Unkonwn variables</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): According to the intersection of lis1 and list2</span>
<span class="sd">    &quot;&quot;&quot;</span>    

    <span class="n">k</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">lisi</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">findsymb</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">intersectnotempt</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
            <span class="n">u</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">u</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.denoms_prod" class="doc doc-heading">
<code class="highlight language-python"><span class="n">denoms_prod</span><span class="p">(</span><span class="n">denoms</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Computes the product of denoms</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>denoms</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Product of denominators.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Product of denominators.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">denoms_prod</span><span class="p">(</span><span class="n">denoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the product of denoms</span>

<span class="sd">    Parameters:</span>
<span class="sd">        denoms (list): Product of denominators.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Product of denominators.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">denomprod</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">denom</span> <span class="ow">in</span> <span class="n">denoms</span><span class="p">:</span>
        <span class="n">denomprod</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="n">denomprod</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">denomprod</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.find_attack_row" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_attack_row</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Given a matrix finds the
attack row.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>matrix</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a row can be attacked.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Row.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_attack_row</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a matrix finds the</span>
<span class="sd">    attack row.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        matrix (array): Input matrix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): If a row can be attacked.</span>
<span class="sd">        (list): Row.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">nr_rows</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">mat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">nr_rows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_rows</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">row</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">row</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.findsymb" class="doc doc-heading">
<code class="highlight language-python"><span class="n">findsymb</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds the symbols occurring in f to g</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>f</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>first expression</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>g</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>second expression</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">findsymb</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds the symbols occurring in f to g</span>

<span class="sd">    Parameters:</span>
<span class="sd">        f (list of sp.core.list.Symbol): first expression</span>
<span class="sd">        g (list of sp.core.list.Symbol): second expression</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">Symbol</span><span class="p">:</span>
        <span class="n">g</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="n">findsymb</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.gen_all_p" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gen_all_p</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mpk</span><span class="p">,</span> <span class="n">gp</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Gives all possible products that an attacker can generate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>k</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>c</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mpk</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of MPK encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>gp</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of global parameter encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>All possible combinations of encodings.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gen_all_p</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mpk</span><span class="p">,</span> <span class="n">gp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gives all possible products that an attacker can generate.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        k (list): List of key encodings.</span>
<span class="sd">        c (list): List of ciphertext encodings.</span>
<span class="sd">        mpk (list): List of MPK encodings.</span>
<span class="sd">        gp (list): List of global parameter encodings.</span>
<span class="sd">    Returns:</span>
<span class="sd">        (list): All possible combinations of encodings. </span>
<span class="sd">    &quot;&quot;&quot;</span>   

    <span class="c1"># k*c</span>

    <span class="n">all_k_c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">all_k_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span>

    <span class="c1"># k*mpk</span>

    <span class="n">all_k_mpk</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mpk</span><span class="p">:</span>
            <span class="n">all_k_mpk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span>

    <span class="c1"># c*mpk</span>

    <span class="n">all_mpk_c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mpk</span><span class="p">:</span>
            <span class="n">all_mpk_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span>

    <span class="c1"># c*gp</span>

    <span class="n">all_gp_c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">:</span>
            <span class="n">all_gp_c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span>

    <span class="c1"># k*gp</span>

    <span class="n">all_gp_k</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">:</span>
            <span class="n">all_gp_k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">all_k_c</span> <span class="o">+</span> <span class="n">all_k_mpk</span> <span class="o">+</span> <span class="n">all_mpk_c</span> <span class="o">+</span> <span class="n">all_gp_c</span> <span class="o">+</span> <span class="n">all_gp_k</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.get_vars_list_polynomials" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_vars_list_polynomials</span><span class="p">(</span><span class="n">polys</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns list of variables occuring in the list of polynomials.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>polys</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Polynomial.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of variables occuring in poly.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_vars_list_polynomials</span><span class="p">(</span><span class="n">polys</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns list of variables occuring in the list of polynomials.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        polys (list): Polynomial.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): List of variables occuring in poly.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">lis_vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">polys</span><span class="p">:</span>
        <span class="n">lis_vars</span> <span class="o">+=</span> <span class="n">get_vars_polynomial</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lis_vars</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.get_vars_polynomial" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_vars_polynomial</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns a list of variables occuring in the polynomial poly.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>poly</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Polynomial.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of variables occuring in poly.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_vars_polynomial</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of variables occuring in the polynomial poly.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        poly (list): Polynomial.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): List of variables occuring in poly.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">monos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recovermonos</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">monos</span><span class="p">)</span>
    <span class="n">monos_cpy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">monos</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">monos_cpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">monos</span> <span class="o">=</span> <span class="n">monos_cpy</span>
    <span class="n">lis_vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">monos</span><span class="p">:</span>
        <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis_vars</span><span class="p">)</span>

    <span class="n">lis_vars_cpy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">lis_vars</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">lis_vars_cpy</span><span class="p">:</span>
            <span class="n">lis_vars_cpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lis_vars_cpy</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.intersectnotempt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">intersectnotempt</span><span class="p">(</span><span class="n">lis1</span><span class="p">,</span> <span class="n">lis2</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if the intersection of lis1 and lis2 is not empty.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>list1</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>First list</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>list2</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Second list</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>According to the intersection of lis1 and list2</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">intersectnotempt</span><span class="p">(</span><span class="n">lis1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">lis2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the intersection of lis1 and lis2 is not empty.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        list1 (list): First list</span>
<span class="sd">        list2 (list): Second list</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): According to the intersection of lis1 and list2</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">lis1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">lis2</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.invector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">invector</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if the monomial f is already in vec</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>f</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Monomial f</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>vec</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input vector</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">invector</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">vec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the monomial f is already in vec</span>

<span class="sd">    Parameters:</span>
<span class="sd">        f (list): Monomial f</span>
<span class="sd">        vec (list): Input vector</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">fmul</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">fmul</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="n">fmul</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fmul</span> <span class="o">==</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">fmul</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fmul</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.is_var_denom" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_var_denom</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>It detects if a variable is part of the
denominator.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>var</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Result of checking if a variable is part of the denominator.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_var_denom</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It detects if a variable is part of the</span>
<span class="sd">    denominator.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        var (sp.core.list.Symbol): Input variable.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Result of checking if a variable is part of the denominator.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">Pow</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.is_var_not_in_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_var_not_in_list</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>It detects if a variable doesn't belong
to a list.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>var</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lis</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sympy expressions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Result of check.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_var_not_in_list</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It detects if a variable doesn&#39;t belong</span>
<span class="sd">    to a list.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        var (sp.core.list.Symbol): Input variable.</span>
<span class="sd">        lis (list): List of sympy expressions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Result of check.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="k">for</span> <span class="n">varx</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="n">varx</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.merge_lists" class="doc doc-heading">
<code class="highlight language-python"><span class="n">merge_lists</span><span class="p">(</span><span class="n">lis1</span><span class="p">,</span> <span class="n">lis2</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Merges two lists of sp.core.list.Symbol expresions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lis1</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.list.Symbol expresions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lis2</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.list.Symbol expresions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Merged list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">merge_lists</span><span class="p">(</span><span class="n">lis1</span><span class="p">,</span> <span class="n">lis2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges two lists of sp.core.list.Symbol expresions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        lis1 (list): List of sp.core.list.Symbol expresions.</span>
<span class="sd">        lis2 (list): List of sp.core.list.Symbol expresions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Merged list.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">lis3</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">lis1</span> <span class="o">+</span> <span class="n">lis2</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">lis3</span><span class="p">:</span>
            <span class="n">lis3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lis3</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.recovermonos" class="doc doc-heading">
<code class="highlight language-python"><span class="n">recovermonos</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns a list of monomials of a given polynomial ar</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ar</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input polynomial</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>col</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of monomials of polynomial ar</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">recovermonos</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of monomials of a given polynomial ar</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ar (list): Input polynomial</span>
<span class="sd">        col (list): List of monomials of polynomial ar</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ar</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">Add</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ar</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="n">col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recovermonos</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.recovervars" class="doc doc-heading">
<code class="highlight language-python"><span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds the variables of a monomial to list lis</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mono</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Monomial</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lis</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List to add teh variables</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds the variables of a monomial to list lis</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mono (list): Monomial</span>
<span class="sd">        lis (list): List to add teh variables</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">if</span> <span class="n">mono</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">Mul</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">mono</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="n">recovervars</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.reordermatuvec" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reordermatuvec</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reordering matrix and uvector so master key is in first entry.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of poynomials.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unkonwn variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The master key was identified.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Matrix reordered so mater key is in the first entry.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unkown variables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reordermatuvec</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reordering matrix and uvector so master key is in first entry.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): List of poynomials.</span>
<span class="sd">        uvector (list): List of unkonwn variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): The master key was identified.</span>
<span class="sd">        (array): Matrix reordered so mater key is in the first entry.</span>
<span class="sd">        (list): List of unkown variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">mk_found</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">uvector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">masterkey</span><span class="p">:</span>
        <span class="n">mk_found</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">mk_found</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="n">masterkey</span><span class="p">:</span>
            <span class="n">cp</span> <span class="o">=</span> <span class="n">c</span>
            <span class="n">mk_found</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">mk_found</span><span class="p">:</span>
        <span class="n">uvector</span> <span class="o">=</span> <span class="p">[</span><span class="n">uvector</span><span class="p">[</span><span class="n">cp</span><span class="p">]]</span> <span class="o">+</span> <span class="n">uvector</span><span class="p">[:</span><span class="n">cp</span><span class="p">]</span> <span class="o">+</span> <span class="n">uvector</span><span class="p">[</span><span class="n">cp</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
        <span class="n">matcpy</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">lis</span> <span class="ow">in</span> <span class="n">mat</span><span class="p">:</span>
            <span class="n">lis</span> <span class="o">=</span> <span class="p">[</span><span class="n">lis</span><span class="p">[</span><span class="n">cp</span><span class="p">]]</span> <span class="o">+</span> <span class="n">lis</span><span class="p">[:</span><span class="n">cp</span><span class="p">]</span> <span class="o">+</span> <span class="n">lis</span><span class="p">[</span><span class="n">cp</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="n">matcpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">mk_found</span><span class="p">,</span> <span class="n">matcpy</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">mk_found</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.transform_encoding_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">transform_encoding_list</span><span class="p">(</span><span class="n">denomprod</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Normalizes the encoding list with respect to the denominators.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>denomprod</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of denominators.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Encoding list.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Transformed encoding list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transform_encoding_list</span><span class="p">(</span><span class="n">denomprod</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalizes the encoding list with respect to the denominators.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        denomprod (list): List of denominators.</span>
<span class="sd">        p (list): Encoding list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Transformed encoding list.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">pcpy</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="n">pcpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cancel</span><span class="p">(</span><span class="n">pp</span> <span class="o">*</span> <span class="n">denomprod</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">canonical</span><span class="p">(</span><span class="n">pcpy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.trim_matrix_and_uvector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">trim_matrix_and_uvector</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvec</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Removes the rows in the matrix that do not contribute an attack.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mat</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attacking matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvec</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Matrix after trimming.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">trim_matrix_and_uvector</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes the rows in the matrix that do not contribute an attack.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mat (array): Attacking matrix.</span>
<span class="sd">        uvec: Unknown vector.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (array): Matrix after trimming.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">nr_rows</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">mat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nr_columns</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">mat</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">rows_to_delete</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cols_to_delete</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">jind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_columns</span><span class="p">):</span>
        <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">last_iind</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">iind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_rows</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mat</span><span class="p">[</span><span class="n">iind</span><span class="p">,</span><span class="n">jind</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">last_iind</span> <span class="o">=</span> <span class="n">iind</span>
        <span class="k">if</span> <span class="n">ctr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">last_iind</span> <span class="ow">in</span> <span class="n">rows_to_delete</span><span class="p">:</span>
                <span class="n">rows_to_delete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last_iind</span><span class="p">)</span>
            <span class="n">cols_to_delete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jind</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">jind</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">cols_to_delete</span><span class="p">):</span>
        <span class="n">mat</span><span class="o">.</span><span class="n">col_del</span><span class="p">(</span><span class="n">jind</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">uvec</span><span class="p">[</span><span class="n">jind</span><span class="p">]</span>

    <span class="n">rows_to_delete2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nr_rows</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">rows_to_delete</span><span class="p">:</span>
            <span class="n">rows_to_delete2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">rows_to_delete2</span><span class="p">:</span>
        <span class="n">mat</span><span class="o">.</span><span class="n">row_del</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvec</span><span class="p">,</span> <span class="n">rows_to_delete2</span><span class="p">,</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">cols_to_delete</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.var_contains_unknown" class="doc doc-heading">
<code class="highlight language-python"><span class="n">var_contains_unknown</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">unknowns</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>It detects if a sympy variable is part of the
unknowns.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>var</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknowns as sympy expressions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Result of check.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">var_contains_unknown</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">unknowns</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It detects if a sympy variable is part of the</span>
<span class="sd">    unknowns.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        var (sp.core.list.Symbol): Input variable.</span>
<span class="sd">        unknown (list): List of unknowns as sympy expressions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Result of check.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">Symbol</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">unknowns</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unknowns</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.writeencodingasprod" class="doc doc-heading">
<code class="highlight language-python"><span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">enco</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This takes as input an encoding and a set of unknown variables.
It outputs a matrix decomposition, where the matrix consists of
integers and known variables, and the vector of unknown variables.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>enco</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input encoding.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vector of unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">writeencodingasprod</span><span class="p">(</span><span class="n">enco</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unknown</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This takes as input an encoding and a set of unknown variables.</span>
<span class="sd">    It outputs a matrix decomposition, where the matrix consists of</span>
<span class="sd">    integers and known variables, and the vector of unknown variables.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        enco (list): Input encoding.</span>
<span class="sd">        unknown (list): Vector of unknown variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">uvector</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">enco</span><span class="p">:</span>
        <span class="n">mat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">writepolyasprod</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">unknown</span><span class="p">))</span>
    <span class="n">appendzeros</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_common.writepolyasprod" class="doc doc-heading">
<code class="highlight language-python"><span class="n">writepolyasprod</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This takes as input a polynomial, and a set of unknown variables.
It outputs a vector decomposition, where the kvector consists of
integers and known variables, and the uvector of unknown variables.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>poly</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Polynomial expression.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vector decomposition.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vector of unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">writepolyasprod</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">uvector</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unknown</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This takes as input a polynomial, and a set of unknown variables.</span>
<span class="sd">    It outputs a vector decomposition, where the kvector consists of</span>
<span class="sd">    integers and known variables, and the uvector of unknown variables.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        poly (sp.core.list.Symbol): Polynomial expression.</span>
<span class="sd">        uvector (list): Vector decomposition.</span>
<span class="sd">        unknown (list): Vector of unknown variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">colmono</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># this recovers a list colmono of monomials</span>
    <span class="n">recovermonos</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">colmono</span><span class="p">)</span>
    <span class="n">cmcpy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># this eliminates all occurrences of &#39;None&#39;</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">colmono</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">f</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">cmcpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">variables</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># for each monomial in the list, we:</span>
    <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">cmcpy</span><span class="p">:</span>
        <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># recover a list of the variables</span>
        <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
        <span class="c1"># note that variables is a list of lists of variables</span>
        <span class="c1"># the first entry is the list of variables of the first monomial, etc.</span>
        <span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span>
    <span class="n">kvector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">]</span>
    <span class="c1"># for each list of variables f</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="c1"># we decompose it into a subset of known and subset of unknown variables</span>
        <span class="n">liso</span> <span class="o">=</span> <span class="n">decompose</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
        <span class="c1"># we add the decomposition to the known and uknown-variable vector</span>
        <span class="c1"># this is done by first checking wether the product of the unknown</span>
        <span class="c1"># variables is already in uvector or not</span>
        <span class="n">addcomptodecomp</span><span class="p">(</span><span class="n">kvector</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">liso</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kvector</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="methods-for-generating-general-encodings">Methods for generating general encodings</h2>


<div class="doc doc-object doc-module">


<a id="encodings_helper"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="encodings_helper.create_b_encoding" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_b_encoding</span><span class="p">(</span><span class="n">gp</span><span class="p">,</span> <span class="n">mpk</span><span class="p">,</span> <span class="n">att_range</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates the encoding for the common variables b based on the used attributes.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gp</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of global parameters.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mpk</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of mpk encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>b encoding</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>encodings_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_b_encoding</span><span class="p">(</span><span class="n">gp</span><span class="p">,</span> <span class="n">mpk</span><span class="p">,</span> <span class="n">att_range</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates the encoding for the common variables b based on the used attributes.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        gp (list): List of global parameters.</span>
<span class="sd">        mpk (list): List of mpk encodings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): b encoding</span>
<span class="sd">    &quot;&quot;&quot;</span>      
    <span class="n">benc</span> <span class="o">=</span> <span class="n">gp</span> <span class="o">+</span> <span class="n">mpk</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">att_range</span><span class="p">:</span>
        <span class="n">benc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_attribute_in_group</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">benc</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="encodings_helper.create_ciphertext_encoding" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_ciphertext_encoding</span><span class="p">(</span><span class="n">c_fixed</span><span class="p">,</span> <span class="n">c_att</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">att_range</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function creates a ciphertext encoding for the attributes in the 
att_range, for the AND-policy over all the attributes</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>c_fixed</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of fixed ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>c_att</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of attribute-dependent ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Description of s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>att_range</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attributes to use in the ciphertext encoding generation.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>prefixes</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prefixes to se.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nr_indexed_encodings</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indexed encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of generated ciphertext encodings.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>encodings_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_ciphertext_encoding</span><span class="p">(</span><span class="n">c_fixed</span><span class="p">,</span> <span class="n">c_att</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">att_range</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates a ciphertext encoding for the attributes in the </span>
<span class="sd">    att_range, for the AND-policy over all the attributes</span>

<span class="sd">    Parameters:</span>
<span class="sd">        c_fixed (list): List of fixed ciphertext encodings.</span>
<span class="sd">        c_att (list): List of attribute-dependent ciphertext encodings.</span>
<span class="sd">        special_s (list): Description of s.</span>
<span class="sd">        att_range (list): Attributes to use in the ciphertext encoding generation.</span>
<span class="sd">        prefixes (list): Prefixes to se.</span>
<span class="sd">        nr_indexed_encodings (list): Indexed encodings.</span>
<span class="sd">    Returns:</span>
<span class="sd">        (list): List of generated ciphertext encodings.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">cenc</span> <span class="o">=</span> <span class="n">c_fixed</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">att_range</span><span class="p">)):</span>
        <span class="n">cenc</span> <span class="o">+=</span> <span class="n">substitute_encodings</span><span class="p">(</span><span class="n">c_att</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">att_range</span><span class="p">,</span> 
                                         <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cenc</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="encodings_helper.create_key_encoding" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_key_encoding</span><span class="p">(</span><span class="n">k_fixed</span><span class="p">,</span> <span class="n">k_att</span><span class="p">,</span> <span class="n">att_range</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">,</span> <span class="n">key_index_range</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function creates key encodings for each entry in the key_index_range 
list, for attributes in the att_range.        </p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>k_fixed</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of fixed key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>k_att</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of attribute-dependent key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nr_indexed_encodings</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indexed encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>key_index_range</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key index range.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>key encodings</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>encodings_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_key_encoding</span><span class="p">(</span><span class="n">k_fixed</span><span class="p">,</span> <span class="n">k_att</span><span class="p">,</span> <span class="n">att_range</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">,</span> <span class="n">key_index_range</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates key encodings for each entry in the key_index_range </span>
<span class="sd">    list, for attributes in the att_range.        </span>

<span class="sd">    Parameters:</span>
<span class="sd">        k_fixed (list): List of fixed key encodings.</span>
<span class="sd">        k_att (list): List of attribute-dependent key encodings.</span>
<span class="sd">        nr_indexed_encodings (list): Indexed encodings.</span>
<span class="sd">        key_index_range (list): Key index range.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): key encodings</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">kenc</span> <span class="o">=</span> <span class="n">k_fixed</span>
    <span class="k">for</span> <span class="n">ind2</span> <span class="ow">in</span> <span class="n">key_index_range</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">att_range</span><span class="p">)):</span>
            <span class="n">no_s</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s2">&quot;no_s&quot;</span><span class="p">)</span>
            <span class="n">kenc</span> <span class="o">+=</span> <span class="n">substitute_encodings</span><span class="p">(</span><span class="n">k_att</span><span class="p">,</span> <span class="n">no_s</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">att_range</span><span class="p">,</span> 
                                             <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">,</span> <span class="n">ind2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kenc</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="encodings_helper.generate_known_variable_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_known_variable_set</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns all known variables by determining all the variables in the 
encodings. .</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of b encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of generated known variables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>encodings_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_known_variable_set</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns all known variables by determining all the variables in the </span>
<span class="sd">    encodings. .</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kenc (list): List of key encodings.</span>
<span class="sd">        cenc (list): List of ciphertext encodings.</span>
<span class="sd">        benc (list): List of b encodings.</span>
<span class="sd">    Returns:</span>
<span class="sd">        (list): List of generated known variables.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">all_vars</span> <span class="o">=</span> <span class="n">EmptySet</span>

    <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="n">benc</span> <span class="o">+</span> <span class="n">cenc</span> <span class="o">+</span> <span class="n">kenc</span><span class="p">:</span>
        <span class="n">all_vars</span> <span class="o">=</span> <span class="n">Union</span><span class="p">(</span><span class="n">all_vars</span><span class="p">,</span> <span class="n">enc</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span>

    <span class="n">all_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_vars</span><span class="p">)</span>

    <span class="n">knowns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">all_vars</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">unknown</span><span class="p">:</span>
            <span class="n">knowns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">knowns</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="encodings_helper.generate_unknown_variable_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_unknown_variable_set</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">att_range_ct</span><span class="p">,</span> <span class="n">att_range_key</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns all unknown variables by determining all the variables in the 
encodings. It filters out those that are generated by get_attribute_as_scalar.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of b encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>att_range_ct</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attributes in ciphertext range.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>att_range_key</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attributes in key range.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of generated unknown variables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>encodings_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_unknown_variable_set</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">att_range_ct</span><span class="p">,</span> <span class="n">att_range_key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns all unknown variables by determining all the variables in the </span>
<span class="sd">    encodings. It filters out those that are generated by get_attribute_as_scalar.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kenc (list): List of key encodings.</span>
<span class="sd">        cenc (list): List of ciphertext encodings.</span>
<span class="sd">        benc (list): List of b encodings.</span>
<span class="sd">        att_range_ct (list): Attributes in ciphertext range.</span>
<span class="sd">        att_range_key (list): Attributes in key range.</span>
<span class="sd">    Returns:</span>
<span class="sd">        (list): List of generated unknown variables.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">all_vars</span> <span class="o">=</span> <span class="n">EmptySet</span>

    <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="n">benc</span> <span class="o">+</span> <span class="n">cenc</span> <span class="o">+</span> <span class="n">kenc</span><span class="p">:</span>
        <span class="n">all_vars</span> <span class="o">=</span> <span class="n">Union</span><span class="p">(</span><span class="n">all_vars</span><span class="p">,</span> <span class="n">enc</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span>

    <span class="n">knowns</span> <span class="o">=</span> <span class="n">EmptySet</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">att_range_ct</span> <span class="o">+</span> <span class="n">att_range_key</span><span class="p">:</span>
        <span class="n">knowns</span> <span class="o">=</span> <span class="n">Union</span><span class="p">(</span><span class="n">knowns</span><span class="p">,</span> <span class="p">{</span><span class="n">get_attribute_as_scalar</span><span class="p">(</span><span class="n">ind</span><span class="p">)})</span>

    <span class="n">unknown</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">all_vars</span><span class="p">:</span>
        <span class="n">contains</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">elp</span> <span class="ow">in</span> <span class="n">knowns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">el</span> <span class="o">==</span> <span class="n">elp</span><span class="p">:</span>
                <span class="n">contains</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contains</span><span class="p">:</span>
            <span class="n">unknown</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">unknown</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="encodings_helper.generate_unknown_variable_set_new" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_unknown_variable_set_new</span><span class="p">(</span><span class="n">known</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">att_range_ct</span><span class="p">,</span> <span class="n">att_range_key</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns all unknown variables by determining all the variables in the 
encodings. It filters out those that are generated by get_attribute_as_scalar.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of b encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>att_range_ct</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attributes in ciphertext range.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>att_range_key</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attributes in key range.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of generated unknown variables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>encodings_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_unknown_variable_set_new</span><span class="p">(</span><span class="n">known</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">att_range_ct</span><span class="p">,</span> <span class="n">att_range_key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns all unknown variables by determining all the variables in the </span>
<span class="sd">    encodings. It filters out those that are generated by get_attribute_as_scalar.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kenc (list): List of key encodings.</span>
<span class="sd">        cenc (list): List of ciphertext encodings.</span>
<span class="sd">        benc (list): List of b encodings.</span>
<span class="sd">        att_range_ct (list): Attributes in ciphertext range.</span>
<span class="sd">        att_range_key (list): Attributes in key range.</span>
<span class="sd">    Returns:</span>
<span class="sd">        (list): List of generated unknown variables.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">all_vars</span> <span class="o">=</span> <span class="n">EmptySet</span>

    <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="n">benc</span> <span class="o">+</span> <span class="n">cenc</span> <span class="o">+</span> <span class="n">kenc</span><span class="p">:</span>
        <span class="n">all_vars</span> <span class="o">=</span> <span class="n">Union</span><span class="p">(</span><span class="n">all_vars</span><span class="p">,</span> <span class="n">enc</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span>

    <span class="n">knowns</span> <span class="o">=</span> <span class="n">EmptySet</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">known</span><span class="p">:</span>
        <span class="n">knowns</span> <span class="o">=</span> <span class="n">Union</span><span class="p">(</span><span class="n">knowns</span><span class="p">,</span> <span class="p">{</span><span class="n">elem</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">att_range_ct</span> <span class="o">+</span> <span class="n">att_range_key</span><span class="p">:</span>
        <span class="n">knowns</span> <span class="o">=</span> <span class="n">Union</span><span class="p">(</span><span class="n">knowns</span><span class="p">,</span> <span class="p">{</span><span class="n">get_attribute_as_scalar</span><span class="p">(</span><span class="n">ind</span><span class="p">)})</span>

    <span class="n">unknown</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">all_vars</span><span class="p">:</span>
        <span class="n">contains</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">elp</span> <span class="ow">in</span> <span class="n">knowns</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">elp</span><span class="p">))]</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">elp</span><span class="p">):</span>
                <span class="n">contains</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contains</span><span class="p">:</span>
            <span class="n">unknown</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">unknown</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="methods-for-translating-the-acabella-format-to-abgw-inputs">Methods for translating the ACABELLA format to ABGW inputs</h2>


<div class="doc doc-object doc-module">


<a id="generate_abgw_inputs"></a>
  <div class="doc doc-contents first">
  
      <p>generate_abgw_inputs.py: This module contains functions involved in the
translation of ACABELLA inputs to the ABGW format.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="generate_abgw_inputs.generate_abgw_input" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_abgw_input</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">known</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function generates a valid ABGW input given a description of
the ABE scheme.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blindingvalue</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding value, by default a*s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of key encodings</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of ciphertext encodings</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of b encodings</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code><span title="generate_abgw_inputs.unknown">unknown</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknown values</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>known</code></td>
          <td>
                <code><span title="generate_abgw_inputs.known">known</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of known values</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>generate_abgw_inputs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_abgw_input</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">known</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function generates a valid ABGW input given a description of</span>
<span class="sd">    the ABE scheme.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        blindingvalue (sp.core.list.Symbol): Blinding value, by default a*s.</span>
<span class="sd">        kenc (list): List of key encodings</span>
<span class="sd">        cenc (list): List of ciphertext encodings</span>
<span class="sd">        benc (list): List of b encodings</span>
<span class="sd">        unknown (unknown): List of unknown values</span>
<span class="sd">        known (known): List of known values</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">penc</span> <span class="o">=</span> <span class="n">gen_all_p</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
    <span class="n">penc</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">penc</span><span class="p">)</span>
    <span class="n">penc</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_c_code</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">penc</span><span class="p">]</span>

    <span class="c1"># prepare header</span>

    <span class="c1">## c_i&#39;s</span>

    <span class="n">coef</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ctr2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">penc</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">ctr2</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">penc</span><span class="p">)</span><span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">coef</span> <span class="o">+=</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coef</span> <span class="o">+=</span> <span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; in Zp.&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">params &quot;</span> <span class="o">+</span> <span class="n">coef</span><span class="p">)</span>

    <span class="c1">## vars</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vars &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">unknown</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">elem</span> <span class="o">!=</span> <span class="n">unknown</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; in Zp.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">known</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">## extra params</span>

    <span class="k">if</span> <span class="n">known</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;params &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">known</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span> <span class="o">!=</span> <span class="n">known</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; in Zp.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># prepare constraints</span>

    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">en</span> <span class="ow">in</span> <span class="n">penc</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">en</span> <span class="o">!=</span> <span class="n">penc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;*(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">en</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span> <span class="o">+</span> <span class="s2">&quot; +&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;*(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">en</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;= a * s.</span><span class="se">\n\n</span><span class="s2">go.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>    
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="generate_abgw_inputs.to_c_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_c_code</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This functions removes squares in the form x*<em>2 and replace them
by x</em>x. This is required in the ABGW tool. This function is
based on https://stackoverflow.com/questions/14264431/expanding-algebraic-powers-in-python-sympy</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression to transform.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Transformed Sympy expression.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>generate_abgw_inputs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_c_code</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This functions removes squares in the form x**2 and replace them</span>
<span class="sd">    by x*x. This is required in the ABGW tool. This function is</span>
<span class="sd">    based on https://stackoverflow.com/questions/14264431/expanding-algebraic-powers-in-python-sympy</span>

<span class="sd">    Parameters:</span>
<span class="sd">        expr (sp.core.list.Symbol): Sympy expression to transform.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (sp.core.list.Symbol): Transformed Sympy expression.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">code</span> <span class="o">=</span> <span class="n">ccode</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
    <span class="c1"># sympy has a hard time unsimplifying x**2 to x*x</span>
    <span class="c1"># replace all pow(var,2) with var*var</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">CPOW</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\g&lt;var&gt;*\g&lt;var&gt;&#39;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">code</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="methods-for-proof-generation">Methods for proof generation</h2>


<div class="doc doc-object doc-module">


<a id="proof_generation"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="proof_generation.check_kernel_products" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_kernel_products</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks whether the kernel contains vectors that are not zero in the important entries.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Equations found.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Equations.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_kernel_products</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the kernel contains vectors that are not zero in the important entries.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Equations found.</span>
<span class="sd">        (list): Equations.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">kenc</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">kenc</span><span class="p">)</span>
    <span class="n">cenc</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">cenc</span><span class="p">)</span>

    <span class="n">penc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k_el</span> <span class="ow">in</span> <span class="n">kenc</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c_el</span> <span class="ow">in</span> <span class="n">cenc</span><span class="p">:</span>
            <span class="n">penc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cancel</span><span class="p">(</span><span class="n">k_el</span><span class="o">*</span><span class="n">c_el</span><span class="p">))</span>

    <span class="p">(</span><span class="n">mat</span><span class="p">,</span><span class="n">uvector</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">penc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">BigMat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

    <span class="n">mk_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">el</span> <span class="o">==</span> <span class="n">masterkey</span> <span class="o">*</span> <span class="n">special_s</span><span class="p">:</span>
            <span class="n">mk_index</span> <span class="o">=</span> <span class="n">ctr</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">kern</span> <span class="o">=</span> <span class="n">BigMat</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>

    <span class="n">eqs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">eqsfound</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vec</span><span class="p">[</span><span class="n">mk_index</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">eqsfound</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">mk_index</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">eqsfound</span><span class="p">,</span> <span class="n">eqs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.construct_benc_mats" class="doc doc-heading">
<code class="highlight language-python"><span class="n">construct_benc_mats</span><span class="p">(</span><span class="n">benc</span><span class="p">,</span> <span class="n">nonlonesub</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">kern</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Constructs the matrices for the common variables b implied by mpk.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nonlonesub</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of non-lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kern</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Matrix for the common variable b.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of variables not in b.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">construct_benc_mats</span><span class="p">(</span><span class="n">benc</span><span class="p">,</span> <span class="n">nonlonesub</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">kern</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs the matrices for the common variables b implied by mpk.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        benc (list): List of public key encodings.</span>
<span class="sd">        nonlonesub (list): List of non-lone variables.</span>
<span class="sd">        uvector (list): List of unknown variables.</span>
<span class="sd">        kern (list): Kernel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Matrix for the common variable b.</span>
<span class="sd">        (list): List of variables not in b.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">benc_mats</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">notinit_b</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">bx</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
        <span class="n">bx_not_in_benc</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nonlonesub</span><span class="p">]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
                <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span><span class="n">lis</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">bx</span> <span class="ow">in</span> <span class="n">lis</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">bx_not_in_benc</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">sindex</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">lis</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">bx</span><span class="p">)</span>
                    <span class="n">svar</span> <span class="o">=</span> <span class="n">lis</span><span class="p">[</span><span class="n">sindex</span><span class="p">]</span>
                    <span class="n">row_s</span> <span class="o">=</span> <span class="n">nonlonesub</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">svar</span><span class="p">)</span>
                    <span class="n">count_kern</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
                        <span class="n">bmat</span><span class="p">[</span><span class="n">row_s</span><span class="p">][</span><span class="n">count_kern</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">count</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">count_kern</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">bx_not_in_benc</span><span class="p">:</span>
            <span class="n">notinit_b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  
            <span class="n">bmat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">bmat</span><span class="p">)</span>
            <span class="n">benc_mats</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bx</span><span class="p">,</span><span class="n">bmat</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">benc_mats</span><span class="p">,</span> <span class="n">notinit_b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.construct_lone_vects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">construct_lone_vects</span><span class="p">(</span><span class="n">benc</span><span class="p">,</span> <span class="n">lonesub</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">kern</span><span class="p">,</span> <span class="n">len_vec</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Constructs the vectors for the lone variables associated with the ciphertext
(or key in the case of co-selective security).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lonesub</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kern</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>len_vec</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lone variables vector.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">construct_lone_vects</span><span class="p">(</span><span class="n">benc</span><span class="p">,</span> <span class="n">lonesub</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">kern</span><span class="p">,</span> <span class="n">len_vec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs the vectors for the lone variables associated with the ciphertext</span>
<span class="sd">    (or key in the case of co-selective security).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        benc (list): List of public key encodings.</span>
<span class="sd">        lonesub (list): List of lone variables.</span>
<span class="sd">        uvector (list): List of unknown variables.</span>
<span class="sd">        kern (list): Kernel.</span>
<span class="sd">        len_vec: Length of vector.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Lone variables vector.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">lone_vects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">slone</span> <span class="ow">in</span> <span class="n">lonesub</span><span class="p">:</span>
        <span class="n">svec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_vec</span><span class="p">)]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
                <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span><span class="n">lis</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">slone</span> <span class="ow">in</span> <span class="n">lis</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">row_s</span> <span class="o">=</span> <span class="n">lonesub</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">slone</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kern</span><span class="p">)):</span>                  
                        <span class="n">svec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">kern</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">count</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">svec</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">svec</span><span class="p">])</span> <span class="c1">#.transpose()</span>
        <span class="n">lone_vects</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">slone</span><span class="p">,</span> <span class="n">svec</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">lone_vects</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.determine_non_lone_vars_in_uvector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">determine_non_lone_vars_in_uvector</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns a list of non-lone variables that occur in the uvector.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>enc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-Lone variables in unknown vector.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">determine_non_lone_vars_in_uvector</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">uvector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of non-lone variables that occur in the uvector.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        enc (list): List of encodings.</span>
<span class="sd">        benc (list): List of public key encodings.</span>
<span class="sd">        uvector (list): List of unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Non-Lone variables in unknown vector.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">list_non_common_vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span><span class="n">lis</span><span class="p">)</span>        
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">benc</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">list_non_common_vars</span><span class="p">:</span>
                    <span class="n">list_non_common_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">list_nonlone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">list_non_common_vars</span><span class="p">:</span>
        <span class="n">non_lone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
                <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span><span class="n">lis</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
                            <span class="n">non_lone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">list_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">non_lone</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">list_nonlone</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.extend_mat_and_vec" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extend_mat_and_vec</span><span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">nonlones</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extends the matrix and uvector with combinations that are not in the encodings.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>matc</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvectorc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List uf unkown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nonlones</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extend_mat_and_vec</span><span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">nonlones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extends the matrix and uvector with combinations that are not in the encodings.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        matc (array): Input matrix.</span>
<span class="sd">        uvectorc (list): List uf unkown variables.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        nonlones (list): Non-lone variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">zero_vec</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">matc</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">nr_cols</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">matc</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">x_b</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">x_c</span> <span class="ow">in</span> <span class="n">nonlones</span><span class="p">:</span>
            <span class="n">prod</span> <span class="o">=</span> <span class="n">x_b</span> <span class="o">*</span> <span class="n">x_c</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">uvectorc</span><span class="p">:</span>
                <span class="n">uvectorc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod</span><span class="p">)</span>
                <span class="n">matc</span> <span class="o">=</span> <span class="n">matc</span><span class="o">.</span><span class="n">col_insert</span><span class="p">(</span><span class="n">nr_cols</span><span class="p">,</span><span class="n">zero_vec</span><span class="p">)</span>
                <span class="n">nr_cols</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.extend_mat_and_vec2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extend_mat_and_vec2</span><span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">nonlones</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extends the matrix and uvector with common variables that are not in the encodings</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>matc</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvectorc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List uf unkown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nonlones</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extend_mat_and_vec2</span><span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">nonlones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extends the matrix and uvector with common variables that are not in the encodings</span>

<span class="sd">    Parameters:</span>
<span class="sd">        matc (array): Input matrix.</span>
<span class="sd">        uvectorc (list): List uf unkown variables.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        nonlones (list): Non-lone variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">zero_vec</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">matc</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">nr_cols</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">matc</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">spec_s</span> <span class="o">=</span> <span class="n">nonlones</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">x_b</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
        <span class="n">b_in_uvec</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">x_c</span> <span class="ow">in</span> <span class="n">nonlones</span><span class="p">:</span>
            <span class="n">prod</span> <span class="o">=</span> <span class="n">x_b</span> <span class="o">*</span> <span class="n">x_c</span>
            <span class="k">if</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">uvectorc</span><span class="p">:</span>
                <span class="n">b_in_uvec</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">b_in_uvec</span><span class="p">:</span>
            <span class="n">uvectorc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_b</span> <span class="o">*</span> <span class="n">spec_s</span><span class="p">)</span>
            <span class="n">matc</span> <span class="o">=</span> <span class="n">matc</span><span class="o">.</span><span class="n">col_insert</span><span class="p">(</span><span class="n">nr_cols</span><span class="p">,</span><span class="n">zero_vec</span><span class="p">)</span>
            <span class="n">nr_cols</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.generate_proof_co_selective" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_proof_co_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates an AC17 co-selective proof.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Co-selective proof.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_proof_co_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates an AC17 co-selective proof.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Co-selective proof.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">output</span> <span class="o">=</span> <span class="n">generate_proof_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="p">(</span><span class="n">benc_mats</span><span class="p">,</span> <span class="n">rvectors_nonlone</span><span class="p">,</span> <span class="n">rvectors_lone</span><span class="p">,</span> <span class="n">svectors_nonlone</span><span class="p">,</span> <span class="n">svectors_lone</span><span class="p">)</span> <span class="o">=</span> <span class="n">output</span>

    <span class="k">if</span> <span class="n">benc_mats</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="n">benc_mats_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">bx</span><span class="p">,</span> <span class="n">mat</span><span class="p">)</span> <span class="ow">in</span> <span class="n">benc_mats</span><span class="p">:</span>
        <span class="n">mat_new</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">benc_mats_new</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bx</span><span class="p">,</span> <span class="n">mat_new</span><span class="p">))</span>

    <span class="n">rvectors_nonlone_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_nonlone</span><span class="p">:</span>
        <span class="n">vec_new</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">rvectors_nonlone_new</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">vec_new</span><span class="p">))</span>

    <span class="n">rvectors_lone_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_lone</span><span class="p">:</span>
        <span class="n">vec_new</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">rvectors_lone_new</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">vec_new</span><span class="p">))</span>

    <span class="n">svectors_nonlone_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_nonlone</span><span class="p">:</span>
        <span class="n">vec_new</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">svectors_nonlone_new</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">vec_new</span><span class="p">))</span>

    <span class="n">svectors_lone_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_lone</span><span class="p">:</span>
        <span class="n">vec_new</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">svectors_lone_new</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">vec_new</span><span class="p">))</span>

    <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="n">benc_mats_new</span><span class="p">,</span> <span class="n">svectors_nonlone_new</span><span class="p">,</span> <span class="n">svectors_lone_new</span><span class="p">,</span> <span class="n">rvectors_nonlone_new</span><span class="p">,</span> <span class="n">rvectors_lone_new</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.generate_proof_selective" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_proof_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates an AC17 selective proof.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Selective proof.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_proof_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates an AC17 selective proof.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Selective proof.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">kenc</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">kenc</span><span class="p">)</span>
    <span class="n">cenc</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">cenc</span><span class="p">)</span>
    <span class="p">(</span><span class="n">matk</span><span class="p">,</span> <span class="n">uvectork</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">Mat_k</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">matk</span><span class="p">)</span>
    <span class="n">Mat_c</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">matc</span><span class="p">)</span>

    <span class="n">nonlone_c</span> <span class="o">=</span> <span class="n">determine_non_lone_vars_in_uvector</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">)</span>

    <span class="p">(</span><span class="n">sublist_nonlones_c</span><span class="p">,</span> <span class="n">sublist_lones_c</span><span class="p">)</span> <span class="o">=</span> <span class="n">sublistslonenonlone</span><span class="p">(</span><span class="n">nonlone_c</span><span class="p">)</span>

    <span class="n">sublist_nonlones_c</span> <span class="o">=</span> <span class="n">put_special_s_first_entry</span><span class="p">(</span><span class="n">special_s</span><span class="p">,</span> <span class="n">sublist_nonlones_c</span><span class="p">)</span>

    <span class="c1"># this can also be run with extend_mat_and_vec but yields larger vectors and matrices</span>
    <span class="p">(</span><span class="n">Mat_c</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">)</span> <span class="o">=</span> <span class="n">extend_mat_and_vec2</span><span class="p">(</span><span class="n">Mat_c</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">sublist_nonlones_c</span><span class="p">)</span>

    <span class="n">kern_c</span> <span class="o">=</span> <span class="n">Mat_c</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kern_c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># print(&quot;\n - No proof found.\n&quot;)</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">(</span><span class="n">benc_mats</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">construct_benc_mats</span><span class="p">(</span><span class="n">benc</span><span class="p">,</span> <span class="n">sublist_nonlones_c</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">kern_c</span><span class="p">)</span>

    <span class="n">nonlone_k</span> <span class="o">=</span> <span class="n">determine_non_lone_vars_in_uvector</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">uvectork</span><span class="p">)</span>

    <span class="p">(</span><span class="n">sublist_nonlones_k</span><span class="p">,</span> <span class="n">sublist_lones_k</span><span class="p">)</span> <span class="o">=</span> <span class="n">sublistslonenonlone</span><span class="p">(</span><span class="n">nonlone_k</span><span class="p">)</span>

    <span class="n">bm_sh</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">benc_mats</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">bm_rows</span> <span class="o">=</span> <span class="n">bm_sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bm_columns</span> <span class="o">=</span> <span class="n">bm_sh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">svectors_nonlone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sublist_nonlones_c</span><span class="p">:</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">bm_rows</span><span class="p">)</span>
        <span class="n">vec</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">svectors_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">))</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">svectors_lone</span> <span class="o">=</span> <span class="n">construct_lone_vects</span><span class="p">(</span><span class="n">benc</span><span class="p">,</span> <span class="n">sublist_lones_c</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">kern_c</span><span class="p">,</span> <span class="n">bm_columns</span><span class="p">)</span>

    <span class="p">(</span><span class="n">big_matrix</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">)</span> <span class="o">=</span> <span class="n">merge_matrices</span><span class="p">(</span><span class="n">Mat_c</span><span class="p">,</span> <span class="n">Mat_k</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">uvectork</span><span class="p">,</span> <span class="n">sublist_nonlones_c</span><span class="p">,</span> <span class="n">sublist_nonlones_k</span><span class="p">)</span>
    <span class="n">kern_bm</span> <span class="o">=</span> <span class="n">big_matrix</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kern_bm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">kern_vec</span> <span class="o">=</span> <span class="n">select_kern_vec</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">sublist_nonlones_c</span><span class="p">,</span> <span class="n">kern_bm</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">)</span>

    <span class="n">rvectors_nonlone</span> <span class="o">=</span> <span class="n">get_nonlone_vecs</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">,</span> <span class="n">kern_c</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">,</span> <span class="n">sublist_nonlones_k</span><span class="p">)</span>
    <span class="n">rvectors_lone</span> <span class="o">=</span> <span class="n">get_lone_vecs</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">,</span> <span class="n">sublist_lones_k</span><span class="p">,</span> <span class="n">sublist_nonlones_c</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="n">benc_mats</span><span class="p">,</span> <span class="n">svectors_nonlone</span><span class="p">,</span> <span class="n">svectors_lone</span><span class="p">,</span> <span class="n">rvectors_nonlone</span><span class="p">,</span> <span class="n">rvectors_lone</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.get_lone_vecs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_lone_vecs</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">,</span> <span class="n">lones_k</span><span class="p">,</span> <span class="n">nonlones_c</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates the vectors for the lone variables based on the large kernel</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kern_vec</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kern_c</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext-related kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvectorc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables in ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvectork</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables in key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lones_k</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lone key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nonlones_c</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_lone_vecs</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">,</span> <span class="n">lones_k</span><span class="p">,</span> <span class="n">nonlones_c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the vectors for the lone variables based on the large kernel</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kern_vec (list): Kernel vector.</span>
<span class="sd">        kern_c (list): Ciphertext-related kernel.</span>
<span class="sd">        uvectorc (list): Unknown variables in ciphertext encodings.</span>
<span class="sd">        uvectork (list): Unknown variables in key encodings.</span>
<span class="sd">        lones_k (list): Lone key encodings.</span>
<span class="sd">        nonlones_c (list): Non-lone ciphertext encodings.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">rvectors_lone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">l_el</span> <span class="ow">in</span> <span class="n">lones_k</span><span class="p">:</span>
        <span class="n">rvec</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">nl_el</span> <span class="ow">in</span> <span class="n">nonlones_c</span><span class="p">:</span>
            <span class="n">prd</span> <span class="o">=</span> <span class="n">l_el</span> <span class="o">*</span> <span class="n">nl_el</span>
            <span class="k">if</span> <span class="n">prd</span> <span class="ow">in</span> <span class="n">big_uvector</span><span class="p">:</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">big_uvector</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">prd</span><span class="p">)</span>
                <span class="n">rvec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rvec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">rvectors_lone</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">l_el</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">rvec</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">rvectors_lone</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.get_nonlone_vecs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_nonlone_vecs</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">,</span> <span class="n">kern_c</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">,</span> <span class="n">nonlones_k</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates the vectors for the non-lone variables based on the large kernel</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kern_vec</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kern_c</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext-related kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvectorc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables in ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvectork</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables in key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nonlones_k</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_nonlone_vecs</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">,</span> <span class="n">kern_c</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">,</span> <span class="n">nonlones_k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the vectors for the non-lone variables based on the large kernel</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kern_vec (list): Kernel vector.</span>
<span class="sd">        kern_c (list): Ciphertext-related kernel.</span>
<span class="sd">        uvectorc (list): Unknown variables in ciphertext encodings.</span>
<span class="sd">        uvectork (list): Unknown variables in key encodings.</span>
<span class="sd">        nonlones_k (list): Non-lone key encodings.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">rvectors_nonlone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">nl_el</span> <span class="ow">in</span> <span class="n">nonlones_k</span><span class="p">:</span>
        <span class="n">sub_vec</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ctr</span><span class="p">,</span> <span class="n">ctr</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvectorc</span><span class="p">)):</span>
            <span class="n">sub_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sub_vec</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">sub_vec</span><span class="p">)</span>

        <span class="n">new_mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">vec</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern_c</span> <span class="o">+</span> <span class="p">[</span><span class="n">sub_vec</span><span class="p">]])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">ns_new_mat</span> <span class="o">=</span> <span class="n">new_mat</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ns_vec</span> <span class="ow">in</span> <span class="n">ns_new_mat</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ns_vec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ns_vec2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="o">/</span><span class="n">ns_vec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ns_vec</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">rvectors_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nl_el</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ns_vec2</span><span class="p">)))</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvectorc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rvectors_nonlone</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.merge_matrices" class="doc doc-heading">
<code class="highlight language-python"><span class="n">merge_matrices</span><span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">matk</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">uvectork</span><span class="p">,</span> <span class="n">nonlones_c</span><span class="p">,</span> <span class="n">nonlones_k</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Merges the matrix for the ciphertext and key encodings.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>matc</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>matk</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvectorc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables in ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvectork</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables in key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nonlones_c</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nonlones_k</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">merge_matrices</span><span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">matk</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">,</span> <span class="n">uvectork</span><span class="p">,</span> <span class="n">nonlones_c</span><span class="p">,</span> <span class="n">nonlones_k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges the matrix for the ciphertext and key encodings.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        matc (array): Ciphertext matrix.</span>
<span class="sd">        matk (array): Key matrix.</span>
<span class="sd">        uvectorc (list): Unknown variables in ciphertext encodings.</span>
<span class="sd">        uvectork (list): Unknown variables in key encodings.</span>
<span class="sd">        nonlones_c (list): Non-lone ciphertext encodings.</span>
<span class="sd">        nonlones_k (list): Non-lone key encodings.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">len_nl_c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nonlones_c</span><span class="p">)</span>
    <span class="n">len_nl_k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nonlones_k</span><span class="p">)</span>
    <span class="n">matc_rows</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">matc</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">matc_cols</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">matc</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">matk_rows</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">matk</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">matk_cols</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">matk</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">big_uvectorc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x_k</span> <span class="ow">in</span> <span class="n">nonlones_k</span><span class="p">:</span>
        <span class="n">big_uvectorc</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x_k</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">uvectorc</span><span class="p">]</span>

    <span class="n">big_uvectork</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x_c</span> <span class="ow">in</span> <span class="n">nonlones_c</span><span class="p">:</span>
        <span class="n">big_uvectork</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x_c</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">uvectork</span><span class="p">]</span>

    <span class="n">big_uvector</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">big_uvector</span> <span class="o">+=</span> <span class="n">big_uvectorc</span>
    <span class="k">for</span> <span class="n">x_u</span> <span class="ow">in</span> <span class="n">big_uvectork</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">x_u</span> <span class="ow">in</span> <span class="n">big_uvector</span><span class="p">:</span>
            <span class="n">big_uvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_u</span><span class="p">)</span>

    <span class="n">big_matc</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">matc_rows</span><span class="o">*</span><span class="n">len_nl_k</span><span class="p">,</span> <span class="n">matc_cols</span><span class="o">*</span><span class="n">len_nl_k</span><span class="p">)</span>
    <span class="n">big_matk</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">matk_rows</span><span class="o">*</span><span class="n">len_nl_c</span><span class="p">,</span> <span class="n">matk_cols</span><span class="o">*</span><span class="n">len_nl_c</span><span class="p">)</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x_k</span> <span class="ow">in</span> <span class="n">nonlones_k</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matc_rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matc_cols</span><span class="p">):</span>
                <span class="n">big_matc</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">ctr</span><span class="o">*</span><span class="n">matc_rows</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="n">ctr</span><span class="o">*</span><span class="n">matc_cols</span><span class="p">]</span> <span class="o">+=</span> <span class="n">matc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x_c</span> <span class="ow">in</span> <span class="n">nonlones_c</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matk_rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matk_cols</span><span class="p">):</span>
                <span class="n">big_matk</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">ctr</span><span class="o">*</span><span class="n">matk_rows</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="n">ctr</span><span class="o">*</span><span class="n">matk_cols</span><span class="p">]</span> <span class="o">+=</span> <span class="n">matk</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">big_matc_rows</span> <span class="o">=</span> <span class="n">matc_rows</span><span class="o">*</span><span class="n">len_nl_k</span>
    <span class="n">big_matk_rows</span> <span class="o">=</span> <span class="n">matk_rows</span><span class="o">*</span><span class="n">len_nl_c</span>
    <span class="n">big_mat</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">big_matc_rows</span> <span class="o">+</span> <span class="n">big_matk_rows</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">big_uvector</span><span class="p">))</span>
    <span class="n">i_u</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x_u</span> <span class="ow">in</span> <span class="n">big_uvector</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x_c</span> <span class="ow">in</span> <span class="n">big_uvectorc</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x_u</span> <span class="o">==</span> <span class="n">x_c</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">big_matc_rows</span><span class="p">):</span>
                    <span class="n">big_mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i_u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">big_matc</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x_k</span> <span class="ow">in</span> <span class="n">big_uvectork</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x_u</span> <span class="o">==</span> <span class="n">x_k</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">big_matk_rows</span><span class="p">):</span>
                    <span class="n">big_mat</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">big_matc_rows</span><span class="p">,</span><span class="n">i_u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">big_matk</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">i_u</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">big_mat</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.normalize_substitutions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">normalize_substitutions</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">proofs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Ensures that the first entry of the master-key and special non-lone s is 1.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proofs</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of proofs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalize_substitutions</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">proofs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the first entry of the master-key and special non-lone s is 1.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        proofs (list): List of proofs.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="p">(</span><span class="n">benc_mats</span><span class="p">,</span> <span class="n">svectors_nonlone</span><span class="p">,</span> <span class="n">svectors_lone</span><span class="p">,</span> <span class="n">rvectors_nonlone</span><span class="p">,</span> <span class="n">rvectors_lone</span><span class="p">)</span> <span class="o">=</span> <span class="n">proofs</span>

    <span class="n">nm_factor_keys</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">nm_factor_ct</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">swap</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">init_key</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">rvectors_lone</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_lone</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">masterkey</span><span class="p">:</span>
                <span class="n">master_key_vec</span> <span class="o">=</span> <span class="n">vec</span>
                <span class="n">init_key</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">init_ct</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">svectors_nonlone</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_nonlone</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">special_s</span><span class="p">:</span>
                <span class="n">special_s_vec</span> <span class="o">=</span> <span class="n">vec</span>
                <span class="n">init_ct</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">init_key</span> <span class="ow">and</span> <span class="n">init_ct</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">master_key_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">special_s_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">master_key_vec</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">master_key_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">special_s_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="n">swap</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">nm_factor_keys</span> <span class="o">=</span> <span class="n">master_key_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">nm_factor_ct</span> <span class="o">=</span> <span class="n">special_s_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nm_factor_keys</span> <span class="o">=</span> <span class="n">master_key_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">nm_factor_ct</span> <span class="o">=</span> <span class="n">special_s_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">rvectors_lone</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctr_vecs</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_lone</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">swap</span><span class="p">:</span>
                    <span class="n">vec</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">elementary_row_op</span><span class="p">(</span><span class="s1">&#39;n&lt;-&gt;m&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
                    <span class="n">rvectors_lone</span><span class="p">[</span><span class="n">ctr_vecs</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span>
                <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
                    <span class="n">vec</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">entry</span><span class="o">/</span><span class="n">nm_factor_keys</span><span class="p">)</span>
                    <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">ctr_vecs</span><span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">rvectors_nonlone</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_nonlone</span><span class="p">:</span>
                <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
                    <span class="n">vec</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">entry</span><span class="o">/</span><span class="n">nm_factor_keys</span><span class="p">)</span>
                    <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">svectors_nonlone</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctr_vecs</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_nonlone</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">swap</span><span class="p">:</span>
                    <span class="n">vec</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">elementary_col_op</span><span class="p">(</span><span class="s1">&#39;n&lt;-&gt;m&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
                    <span class="n">svectors_nonlone</span><span class="p">[</span><span class="n">ctr_vecs</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span>
                <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
                    <span class="n">vec</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">entry</span><span class="o">/</span><span class="n">nm_factor_ct</span><span class="p">)</span>
                    <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">ctr_vecs</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">svectors_lone</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_lone</span><span class="p">:</span>
                <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
                    <span class="n">vec</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">entry</span><span class="o">/</span><span class="n">nm_factor_ct</span><span class="p">)</span>
                    <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">swap</span><span class="p">:</span>
            <span class="n">ctr_rows</span> <span class="o">=</span>  <span class="mi">0</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">mat</span><span class="p">)</span> <span class="ow">in</span> <span class="n">benc_mats</span><span class="p">:</span>
                <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">elementary_row_op</span><span class="p">(</span><span class="s1">&#39;n&lt;-&gt;m&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
                <span class="n">benc_mats</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">mat</span><span class="p">)</span>
                <span class="n">ctr_rows</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">proofs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.put_special_s_first_entry" class="doc doc-heading">
<code class="highlight language-python"><span class="n">put_special_s_first_entry</span><span class="p">(</span><span class="n">special_s</span><span class="p">,</span> <span class="n">sublist</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Ensures that the special_s is in the first entry of the sublist.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sublist</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input sublist.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">put_special_s_first_entry</span><span class="p">(</span><span class="n">special_s</span><span class="p">,</span> <span class="n">sublist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the special_s is in the first entry of the sublist.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        sublist (list): Input sublist.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">entry</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x_s</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x_s</span> <span class="o">==</span> <span class="n">special_s</span><span class="p">:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">ctr</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">cpy_first</span> <span class="o">=</span> <span class="n">sublist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sublist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">special_s</span>
    <span class="n">sublist</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpy_first</span>
    <span class="k">return</span> <span class="n">sublist</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.select_kern_vec" class="doc doc-heading">
<code class="highlight language-python"><span class="n">select_kern_vec</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">nonlones</span><span class="p">,</span> <span class="n">kern_bm</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Selects the kern vector that has 1 in the entry corresponding to <code>alpha * s</code>
and 0 in all other combinations of alpha and nonlones.   </p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Master key descryption.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nonlones</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kern_bm</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>big_uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_kern_vec</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">nonlones</span><span class="p">,</span> <span class="n">kern_bm</span><span class="p">,</span> <span class="n">big_uvector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects the kern vector that has 1 in the entry corresponding to `alpha * s`</span>
<span class="sd">    and 0 in all other combinations of alpha and nonlones.   </span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Master key descryption.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        nonlones (list): Non-lone variables.</span>
<span class="sd">        kern_bm (list): Kernel.</span>
<span class="sd">        big_uvector (list): Unknown variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">sub_kern</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mk_entry</span> <span class="o">=</span> <span class="n">big_uvector</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">masterkey</span> <span class="o">*</span> <span class="n">special_s</span><span class="p">)</span>
    <span class="n">null_entries</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nonlones</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">special_s</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">masterkey</span> <span class="o">*</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">big_uvector</span><span class="p">:</span>
            <span class="n">null_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">big_uvector</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">masterkey</span> <span class="o">*</span> <span class="n">el</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern_bm</span><span class="p">:</span>
        <span class="n">vec_qualified</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">mk_entry</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">en</span> <span class="ow">in</span> <span class="n">null_entries</span><span class="p">:</span>
            <span class="n">vec_qualified</span> <span class="o">=</span> <span class="n">vec_qualified</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">en</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vec_qualified</span><span class="p">:</span>
            <span class="n">sub_kern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_kern</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">kern_vec</span> <span class="o">=</span> <span class="n">sub_kern</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">sub_kern</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">kern_vec</span> <span class="o">+=</span> <span class="n">vec</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">kern_vec</span> <span class="o">=</span> <span class="n">kern_bm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">kern_vec</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_generation.sublistslonenonlone" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sublistslonenonlone</span><span class="p">(</span><span class="n">list_lone_nonlone</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Separates the list of lone and non-lone variables in two sublists.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>list_lone_nonlone</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of lone and lone-lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of lone variables.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of non-lone variables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_generation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sublistslonenonlone</span><span class="p">(</span><span class="n">list_lone_nonlone</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Separates the list of lone and non-lone variables in two sublists.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        list_lone_nonlone (list): List of lone and lone-lone variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): List of lone variables.</span>
<span class="sd">        (list): List of non-lone variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">sublist_nonlones</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sublist_lones</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">nonlone</span><span class="p">)</span> <span class="ow">in</span> <span class="n">list_lone_nonlone</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nonlone</span><span class="p">:</span>
            <span class="n">sublist_nonlones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">sublist_lones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">sublist_nonlones</span><span class="p">,</span> <span class="n">sublist_lones</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="methods-for-proof-verification">Methods for proof verification</h2>


<div class="doc doc-object doc-module">


<a id="proof_verification"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="proof_verification.enhanced_symbolic_property" class="doc doc-heading">
<code class="highlight language-python"><span class="n">enhanced_symbolic_property</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">proofs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if the additional requirements of the enhanced symbolic property hold.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proofs</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Proofs elements.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Analysis result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_verification.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">enhanced_symbolic_property</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">proofs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the additional requirements of the enhanced symbolic property hold.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        proofs (list): Proofs elements.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Analysis result.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="p">(</span><span class="n">benc_mats</span><span class="p">,</span> <span class="n">svectors_nonlone</span><span class="p">,</span> <span class="n">svectors_lone</span><span class="p">,</span> <span class="n">rvectors_nonlone</span><span class="p">,</span> <span class="n">rvectors_lone</span><span class="p">)</span> <span class="o">=</span> <span class="n">proofs</span>
    <span class="n">k_nonlone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_nonlone</span><span class="p">:</span>
        <span class="n">k_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">c_nonlone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_nonlone</span><span class="p">:</span>
        <span class="n">c_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">substitutions</span> <span class="o">=</span> <span class="n">rvectors_nonlone</span> <span class="o">+</span> <span class="n">rvectors_lone</span> <span class="o">+</span> <span class="n">benc_mats</span> <span class="o">+</span> <span class="n">svectors_nonlone</span> <span class="o">+</span> <span class="n">svectors_lone</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_lone</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">masterkey</span><span class="p">:</span>
            <span class="n">masterkey_vec</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="n">enhanced_s_p</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># first check</span>
    <span class="n">masterkey_correct_form</span> <span class="o">=</span> <span class="p">(</span><span class="n">masterkey_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">masterkey_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">el</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">masterkey_correct_form</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">masterkey_correct_form</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The master key is not of the correct form.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">enhanced_s_p</span> <span class="o">=</span> <span class="n">enhanced_s_p</span> <span class="ow">and</span> <span class="n">masterkey_correct_form</span>

    <span class="c1"># second check TODO</span>

    <span class="c1"># third check TODO</span>

    <span class="c1"># fourth check</span>
    <span class="n">nl_i_r</span> <span class="o">=</span> <span class="n">nonlones_independent</span><span class="p">(</span><span class="n">rvectors_nonlone</span><span class="p">)</span>
    <span class="n">nl_i_s</span> <span class="o">=</span> <span class="n">nonlones_independent</span><span class="p">(</span><span class="n">svectors_nonlone</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">nl_i_r</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The non-lone key variables are not linearly independent. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">nl_i_s</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The non-lone ciphertext variables are not linearly independent. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">enhanced_s_p</span> <span class="o">=</span> <span class="n">enhanced_s_p</span> <span class="ow">and</span> <span class="n">nl_i_r</span> <span class="ow">and</span> <span class="n">nl_i_s</span>

    <span class="k">if</span> <span class="n">enhanced_s_p</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_verification.eval_poly" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_poly</span><span class="p">(</span><span class="n">is_key_encoding</span><span class="p">,</span> <span class="n">poly</span><span class="p">,</span> <span class="n">substitutions</span><span class="p">,</span> <span class="n">benc</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Evaluates the given encoding polynomial with the substituted values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_key_encoding</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If it is a key encoding.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>poly</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Polynomial.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>substitutions</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Substituded values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of public key encodings.  </p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Polynomial evaluation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_verification.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_poly</span><span class="p">(</span><span class="n">is_key_encoding</span><span class="p">,</span> <span class="n">poly</span><span class="p">,</span> <span class="n">substitutions</span><span class="p">,</span> <span class="n">benc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates the given encoding polynomial with the substituted values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        is_key_encoding (bool): If it is a key encoding.</span>
<span class="sd">        poly (list): Polynomial.</span>
<span class="sd">        substitutions (list): Substituded values.</span>
<span class="sd">        benc (list): List of public key encodings.  </span>
<span class="sd">    Returns:</span>
<span class="sd">        (list): Polynomial evaluation.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">sub_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">substitutions</span><span class="p">:</span>
        <span class="n">sub_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">poly</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">Mul</span><span class="p">:</span>
        <span class="n">lis_var</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mono_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mono_args</span> <span class="o">=</span> <span class="n">reorder_mono_args</span><span class="p">(</span><span class="n">mono_args</span><span class="p">,</span> <span class="n">sub_args</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">is_key_encoding</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">mono_args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">sub_args</span><span class="p">:</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">sub_args</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                <span class="n">lis_var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substitutions</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">lis_var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="n">subs_mono</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">lis_var</span><span class="p">)</span> <span class="c1">#.transpose()</span>
        <span class="k">return</span> <span class="n">subs_mono</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_poly</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mono</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">Mul</span><span class="p">:</span>
                <span class="n">lis_var</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">mono_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mono</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
                <span class="n">mono_args</span> <span class="o">=</span> <span class="n">reorder_mono_args</span><span class="p">(</span><span class="n">mono_args</span><span class="p">,</span> <span class="n">sub_args</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">is_key_encoding</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">mono_args</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">sub_args</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="n">sub_args</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                        <span class="n">lis_var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substitutions</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span> 
                        <span class="n">lis_var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                <span class="n">subs_mono</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">lis_var</span><span class="p">)</span> <span class="c1">#.transpose()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">sub_args</span><span class="p">:</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">sub_args</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span>
                    <span class="n">subs_mono</span> <span class="o">=</span> <span class="n">substitutions</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">subs_mono</span> <span class="o">=</span> <span class="n">mono</span>
            <span class="n">new_poly</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subs_mono</span><span class="p">)</span>
        <span class="n">sum_poly</span> <span class="o">=</span> <span class="n">new_poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">new_poly</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">sum_poly</span> <span class="o">=</span> <span class="n">sum_poly</span> <span class="o">+</span> <span class="n">mono</span>
        <span class="k">return</span> <span class="n">sum_poly</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_verification.is_poly" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_poly</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">lones</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Helper function to determine whether the encoding is a polynomial.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>entry</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Entry to analyze.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lones</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of lone encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_verification.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_poly</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">lones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to determine whether the encoding is a polynomial.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        entry (sp.core.list.Symbol): Entry to analyze.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        lones (list): List of lone encodings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Result.</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">lone_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">lone_var</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">lones</span><span class="p">:</span>
        <span class="n">lone_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lone_var</span><span class="p">)</span>

    <span class="n">is_polynomial</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">recovervars</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">benc</span> <span class="ow">or</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lone_args</span><span class="p">:</span>
                <span class="n">is_polynomial</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">is_polynomial</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_verification.nonlones_independent" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nonlones_independent</span><span class="p">(</span><span class="n">list_of_nonlones</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if the non-lone variables are linearly independent or not.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>list_of_nonlones</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of non-lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_verification.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nonlones_independent</span><span class="p">(</span><span class="n">list_of_nonlones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the non-lone variables are linearly independent or not.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        list_of_nonlones (list): List of non-lone variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Result.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">nonlone_vects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">list_of_nonlones</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">shape</span><span class="p">(</span><span class="n">vec</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">nonlone_vects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">nonlone_vects</span><span class="p">)</span>
    <span class="n">rs</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">rowspace</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">shape</span><span class="p">(</span><span class="n">mat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">rs</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_verification.reorder_mono_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reorder_mono_args</span><span class="p">(</span><span class="n">mono_args</span><span class="p">,</span> <span class="n">sub_args</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">is_key_encoding</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Helper function to ensure that the product of vector and matrix is done in 
the right order.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mono_args</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of monomials.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sub_args</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Substituded values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>is_key_encoding</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If it is a key encoding.      </p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ordered product of vector and matrix.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_verification.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reorder_mono_args</span><span class="p">(</span><span class="n">mono_args</span><span class="p">,</span> <span class="n">sub_args</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">is_key_encoding</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to ensure that the product of vector and matrix is done in </span>
<span class="sd">    the right order.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mono_args (list): List of monomials.</span>
<span class="sd">        sub_args (list): Substituded values.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        is_key_encoding (bool): If it is a key encoding.      </span>
<span class="sd">    Returns:</span>
<span class="sd">        (list): Ordered product of vector and matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">first_sub</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">second_sub</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ctr_i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">mono_args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">sub_args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">first_sub</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctr_i</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
                <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">second_sub</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctr_i</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
        <span class="n">ctr_i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">is_key_encoding</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">second_sub</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
            <span class="n">mono_args</span><span class="p">[</span><span class="n">first_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">second_sub</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">mono_args</span><span class="p">[</span><span class="n">second_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">first_sub</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">first_sub</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
            <span class="n">mono_args</span><span class="p">[</span><span class="n">first_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">second_sub</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">mono_args</span><span class="p">[</span><span class="n">second_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">first_sub</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">mono_args</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_verification.verify_collusion_security_only" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verify_collusion_security_only</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">proofs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Verifies the security against collusion by inspecting the security proofs
generated by the proving functionality - the vectors for the master key 
and special_s should be (1,0,...,0).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proofs</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Proof elements.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Verification result.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Process log.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_verification.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">verify_collusion_security_only</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">proofs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verifies the security against collusion by inspecting the security proofs</span>
<span class="sd">    generated by the proving functionality - the vectors for the master key </span>
<span class="sd">    and special_s should be (1,0,...,0).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        proofs (list): Proof elements.</span>
<span class="sd">    Returns:</span>
<span class="sd">        (bool): Verification result.</span>
<span class="sd">        (str): Process log.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="p">(</span><span class="n">benc_mats</span><span class="p">,</span> <span class="n">svectors_nonlone</span><span class="p">,</span> <span class="n">svectors_lone</span><span class="p">,</span> <span class="n">rvectors_nonlone</span><span class="p">,</span> <span class="n">rvectors_lone</span><span class="p">)</span> <span class="o">=</span> <span class="n">proofs</span>
    <span class="n">result</span><span class="p">,</span> <span class="n">process_log</span> <span class="o">=</span> <span class="n">verify_proof</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">proofs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
        <span class="c1"># first check</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_lone</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">masterkey</span><span class="p">:</span>
                <span class="n">masterkey_vec</span> <span class="o">=</span> <span class="n">vec</span> <span class="c1">#.transpose()</span>
        <span class="n">masterkey_correct_form</span> <span class="o">=</span> <span class="p">(</span><span class="n">masterkey_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">masterkey_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">el</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">masterkey_correct_form</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">masterkey_correct_form</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># second check</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_nonlone</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">special_s</span><span class="p">:</span>
                <span class="n">s_vec</span> <span class="o">=</span> <span class="n">vec</span> <span class="c1">#.transpose()</span>
        <span class="n">s_correct_form</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">s_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">el</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">s_correct_form</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s_correct_form</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">process_log</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="proof_verification.verify_proof" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verify_proof</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">proofs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if the symbolic property holds.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proofs</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of proofs elements.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Verification result.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Process log.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>proof_verification.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">verify_proof</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">proofs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the symbolic property holds.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        proofs (list): List of proofs elements.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Verification result.</span>
<span class="sd">        (str): Process log.</span>
<span class="sd">    &quot;&quot;&quot;</span>   

    <span class="n">process_log</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="p">(</span><span class="n">benc_mats</span><span class="p">,</span> <span class="n">svectors_nonlone</span><span class="p">,</span> <span class="n">svectors_lone</span><span class="p">,</span> <span class="n">rvectors_nonlone</span><span class="p">,</span> <span class="n">rvectors_lone</span><span class="p">)</span> <span class="o">=</span> <span class="n">proofs</span>

    <span class="n">k_nonlone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_nonlone</span><span class="p">:</span>
        <span class="n">k_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">c_nonlone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_nonlone</span><span class="p">:</span>
        <span class="n">c_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">substitutions</span> <span class="o">=</span> <span class="n">rvectors_nonlone</span> <span class="o">+</span> <span class="n">rvectors_lone</span> <span class="o">+</span> <span class="n">benc_mats</span> <span class="o">+</span> <span class="n">svectors_nonlone</span> <span class="o">+</span> <span class="n">svectors_lone</span>

    <span class="n">masterkey_given</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">masterkey_vec</span> <span class="o">=</span> <span class="n">rvectors_lone</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#.transpose()</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rvectors_lone</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">masterkey</span><span class="p">:</span>
            <span class="n">masterkey_vec</span> <span class="o">=</span> <span class="n">vec</span> <span class="c1">#.transpose()</span>
            <span class="n">masterkey_given</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">special_s_given</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">special_s_vec</span> <span class="o">=</span> <span class="n">svectors_nonlone</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">svectors_nonlone</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">special_s</span><span class="p">:</span>
            <span class="n">special_s_vec</span> <span class="o">=</span> <span class="n">vec</span>
            <span class="n">special_s_given</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">verifies_correctly</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">special_s_vec</span> <span class="o">*</span> <span class="n">masterkey_vec</span> <span class="o">==</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">]])</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">masterkey_given</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">special_s_given</span><span class="p">:</span>
        <span class="n">verifies_correctly</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1">#print(&quot;\n The proof does not verify correctly, because masterkey * special_s = &quot; + str(masterkey) + &quot; * &quot; + str(special_s) + &quot; = 0. \n&quot;)</span>
        <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The proof does not verify correctly, because masterkey * special_s = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">masterkey</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; * &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">special_s</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; = 0. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kenc</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_poly</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">rvectors_lone</span><span class="p">):</span>
                <span class="n">evaluated</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">eval_poly</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">substitutions</span><span class="p">,</span> <span class="n">benc</span><span class="p">))</span>
                <span class="n">all_zero</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">evaluated</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="p">(</span><span class="n">evaluated</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">evaluated</span> <span class="o">!=</span> <span class="n">all_zero</span><span class="p">:</span>
                    <span class="c1">#print(&quot;\n The proof does not verify correctly, because &quot;, k, &quot;!= 0 \n&quot;)</span>
                    <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The proof does not verify correctly, because &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; != 0 </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">verifies_correctly</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cenc</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_poly</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">svectors_lone</span><span class="p">):</span>
                <span class="n">evaluated</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">eval_poly</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">substitutions</span><span class="p">,</span> <span class="n">benc</span><span class="p">))</span>
                <span class="n">all_zero</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">evaluated</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="p">(</span><span class="n">evaluated</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">evaluated</span> <span class="o">!=</span> <span class="n">all_zero</span><span class="p">:</span>
                    <span class="c1">#print(&quot;\n The proof does not verify correctly, because &quot;, c, &quot;!= 0 \n&quot;)</span>
                    <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The proof does not verify correctly, because &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; != 0 </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">verifies_correctly</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># if verifies_correctly:</span>
    <span class="c1">#     print(&quot;\n The following symbolic property proof verifies correctly. \n&quot;)</span>
    <span class="k">return</span> <span class="n">verifies_correctly</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">process_log</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="methods-for-checking-if-an-abe-scheme-is-correct-according-to-the-ac17-framework">Methods for checking if an ABE scheme is correct according to the AC17 framework</h2>


<div class="doc doc-object doc-module">


<a id="ac17_correctness_checks"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.all_enc_contains_no_fractions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">all_enc_contains_no_fractions</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function determines whether the key and ciphertext encodings contains 
no fractions. It returns True if the encodings contains no fractions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Analysis result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">all_enc_contains_no_fractions</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function determines whether the key and ciphertext encodings contains </span>
<span class="sd">    no fractions. It returns True if the encodings contains no fractions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Analysis result. </span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">bool_1</span> <span class="o">=</span> <span class="n">enc_contains_no_fractions</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="n">bool_2</span> <span class="o">=</span> <span class="n">enc_contains_no_fractions</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bool_1</span> <span class="ow">and</span> <span class="n">bool_2</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.blinding_value_correct_form" class="doc doc-heading">
<code class="highlight language-python"><span class="n">blinding_value_correct_form</span><span class="p">(</span><span class="n">blindingval</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function determines whether the blinding value is of the form alpha * s</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Analysis result.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>alpha.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>special_s.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">blinding_value_correct_form</span><span class="p">(</span><span class="n">blindingval</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function determines whether the blinding value is of the form alpha * s</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Analysis result.</span>
<span class="sd">        (Symbol): alpha.</span>
<span class="sd">        (Symbol): special_s.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">uvector</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">writepolyasprod</span><span class="p">(</span><span class="n">blindingval</span><span class="p">,</span><span class="n">uvector</span><span class="p">,</span><span class="n">unknown</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">lis_bv_vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recovervars</span><span class="p">(</span><span class="n">uvector</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lis_bv_vars</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis_bv_vars</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">bv_1</span> <span class="o">=</span> <span class="n">lis_bv_vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bv_2</span> <span class="o">=</span> <span class="n">lis_bv_vars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">lis_vars_kenc</span> <span class="o">=</span> <span class="n">recover_list_enc_vars</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="n">lis_vars_cenc</span> <span class="o">=</span> <span class="n">recover_list_enc_vars</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">is_correct_form</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">bv_1</span> <span class="ow">in</span> <span class="n">lis_vars_kenc</span> <span class="ow">and</span> <span class="n">bv_2</span> <span class="ow">in</span> <span class="n">lis_vars_cenc</span><span class="p">:</span>
        <span class="n">is_correct_form</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">bv_1</span>
        <span class="n">special_s</span> <span class="o">=</span> <span class="n">bv_2</span>
    <span class="k">if</span> <span class="n">bv_1</span> <span class="ow">in</span> <span class="n">lis_vars_cenc</span> <span class="ow">and</span> <span class="n">bv_2</span> <span class="ow">in</span> <span class="n">lis_vars_kenc</span><span class="p">:</span>
        <span class="n">is_correct_form</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">bv_2</span>
        <span class="n">special_s</span> <span class="o">=</span> <span class="n">bv_1</span>

    <span class="k">if</span> <span class="n">is_correct_form</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">special_s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.cenc_correct_form" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cenc_correct_form</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks correctness of the ciphertext encoding.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>function</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>enc_correct_form.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cenc_correct_form</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks correctness of the ciphertext encoding.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (function): enc_correct_form.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">enc_correct_form</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="s2">&quot;ciphertext&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.correct_form" class="doc doc-heading">
<code class="highlight language-python"><span class="n">correct_form</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Main function that calls the correctness checks for the AC17 form.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Analysis result.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Process log.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_form</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function that calls the correctness checks for the AC17 form.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Analysis result.</span>
<span class="sd">        (list): Key encodings.</span>
<span class="sd">        (list): Ciphertext encodings.</span>
<span class="sd">        (str): Process log.</span>
<span class="sd">    &quot;&quot;&quot;</span>    

    <span class="n">process_log</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="p">(</span><span class="n">result_k</span><span class="p">,</span> <span class="n">message_k</span><span class="p">,</span> <span class="n">kenc</span><span class="p">)</span> <span class="o">=</span> <span class="n">kenc_correct_form</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="p">(</span><span class="n">result_c</span><span class="p">,</span> <span class="n">message_c</span><span class="p">,</span> <span class="n">cenc</span><span class="p">)</span> <span class="o">=</span> <span class="n">cenc_correct_form</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result_k</span> <span class="ow">and</span> <span class="n">result_c</span><span class="p">:</span>
        <span class="c1">#print(&quot;\n The pair encoding scheme satisfies the AC17 form. &quot; + message_k + message_c + &quot;\n&quot;)</span>
        <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The pair encoding scheme satisfies the AC17 form. &quot;</span> <span class="o">+</span> <span class="n">message_k</span> <span class="o">+</span> <span class="n">message_c</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">process_log</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print(&quot;\n The pair encoding scheme does not satisfy the AC17 form, because \n&quot;)</span>
        <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The pair encoding scheme does not satisfy the AC17 form, because </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">result_k</span><span class="p">:</span>
            <span class="c1">#print(message_k)</span>
            <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message_k</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">result_c</span><span class="p">:</span>
            <span class="c1">#print(message_c)</span>
            <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message_c</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">process_log</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.correct_form_silent" class="doc doc-heading">
<code class="highlight language-python"><span class="n">correct_form_silent</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>The same as the correct_form function, without system messages.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Analysis result.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_form_silent</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The same as the correct_form function, without system messages.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Analysis result.</span>
<span class="sd">        (list): Key encodings.</span>
<span class="sd">        (list): Ciphertext encodings.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="p">(</span><span class="n">result_k</span><span class="p">,</span> <span class="n">message_k</span><span class="p">,</span> <span class="n">kenc</span><span class="p">)</span> <span class="o">=</span> <span class="n">kenc_correct_form</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="p">(</span><span class="n">result_c</span><span class="p">,</span> <span class="n">message_c</span><span class="p">,</span> <span class="n">cenc</span><span class="p">)</span> <span class="o">=</span> <span class="n">cenc_correct_form</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result_k</span> <span class="ow">and</span> <span class="n">result_c</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.enc_contains_no_fractions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">enc_contains_no_fractions</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function determines whether the encoding contains no fractions.
It returns True if the encodings contains no fractions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>enc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key or ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Analysis result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">enc_contains_no_fractions</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function determines whether the encoding contains no fractions.</span>
<span class="sd">    It returns True if the encodings contains no fractions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        enc (list): Key or ciphertext encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Analysis result. </span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">enc</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>

    <span class="n">denoms</span> <span class="o">=</span> <span class="n">collect_denoms</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">denoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.enc_correct_form" class="doc doc-heading">
<code class="highlight language-python"><span class="n">enc_correct_form</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">mes</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks whether the encoding is of the correct form.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Analysis result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">enc_correct_form</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">mes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the encoding is of the correct form.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Analysis result.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">cenc</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">cenc</span><span class="p">)</span>
    <span class="n">s_nonlone</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cenc</span><span class="p">:</span>
        <span class="n">uvector</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">writepolyasprod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">uvector</span><span class="p">,</span><span class="n">unknown</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">mono</span> <span class="o">=</span> <span class="n">uvector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
                    <span class="n">s_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span>

    <span class="n">lones_in_disguise</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">associated_commons</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cenc</span><span class="p">:</span>
        <span class="n">uvector</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">writepolyasprod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">uvector</span><span class="p">,</span><span class="n">unknown</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
                    <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
                    <span class="n">is_prod_with_benc</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
                            <span class="n">is_prod_with_benc</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">is_prod_with_benc</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">benc</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">s_nonlone</span><span class="p">:</span>
                                <span class="n">lis</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lones_in_disguise</span><span class="p">:</span>
                                    <span class="n">ind</span> <span class="o">=</span> <span class="n">lones_in_disguise</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                                    <span class="n">associated_commons</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge_lists</span><span class="p">(</span><span class="n">lis</span><span class="p">,</span><span class="n">associated_commons</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">lones_in_disguise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                                    <span class="n">associated_commons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span>

    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">replaced</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lones_in_disguise</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">associated_commons</span><span class="p">[</span><span class="n">ctr</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lones_in_disguise</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="n">s_nonlone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;The &quot;</span> <span class="o">+</span> <span class="n">mes</span> <span class="o">+</span> <span class="s2">&quot; encoding contained non-lone variables that do not occur as a singleton.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">ctr2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cenc</span><span class="p">:</span>
                <span class="n">cenc</span><span class="p">[</span><span class="n">ctr2</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">var</span><span class="o">*</span><span class="n">associated_commons</span><span class="p">[</span><span class="n">ctr</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">var</span><span class="p">)</span>
                <span class="n">ctr2</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">replaced</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">replaced</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;The &quot;</span> <span class="o">+</span> <span class="n">mes</span> <span class="o">+</span> <span class="s2">&quot; encoding previously contained non-lone variables that act as lone variables. These have now been replaced by lone variables.&quot;</span>

    <span class="n">return_boolean</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cenc</span><span class="p">:</span>
        <span class="n">uvector</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">writepolyasprod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">uvector</span><span class="p">,</span><span class="n">unknown</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
                <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">return_boolean</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> - The &quot;</span> <span class="o">+</span> <span class="n">mes</span> <span class="o">+</span> <span class="s2">&quot; encoding has monomials with more than two unknown variables </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="c1"># return (False, &quot;The &quot; + mes + &quot; encoding has monomials with more than two unknown variables \n&quot;, None)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cenc</span><span class="p">:</span>
        <span class="n">uvector</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">writepolyasprod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">uvector</span><span class="p">,</span><span class="n">unknown</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">is_polynomial</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
                    <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">benc</span><span class="p">:</span>
                            <span class="n">is_polynomial</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">is_polynomial</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
                        <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s_nonlone</span><span class="p">:</span>
                                <span class="n">return_boolean</span> <span class="o">=</span> <span class="kc">False</span>
                                <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> - The &quot;</span> <span class="o">+</span> <span class="n">mes</span> <span class="o">+</span>  <span class="s2">&quot; encoding contains non-lone variables that are also used as lone variables </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="c1"># return (False, &quot;The &quot; + mes +  &quot; encoding contains non-lone variables that are also used as lone variables \n&quot;, None)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">return_boolean</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">cenc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.kenc_correct_form" class="doc doc-heading">
<code class="highlight language-python"><span class="n">kenc_correct_form</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks correctness of the key encoding.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>function</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>enc_correct_form.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">kenc_correct_form</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks correctness of the key encoding.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (function): enc_correct_form.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">enc_correct_form</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="ac17_correctness_checks.recover_list_enc_vars" class="doc doc-heading">
<code class="highlight language-python"><span class="n">recover_list_enc_vars</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function makes a list of all variables occurring in enc that do not 
occur in benc.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>enc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key or ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of variables.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ac17_correctness_checks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">recover_list_enc_vars</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function makes a list of all variables occurring in enc that do not </span>
<span class="sd">    occur in benc.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        enc (list): Key or ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): List of variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mono</span> <span class="ow">in</span> <span class="n">uvector</span><span class="p">:</span>
        <span class="n">sub_lis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">recovervars</span><span class="p">(</span><span class="n">mono</span><span class="p">,</span> <span class="n">sub_lis</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">sub_lis</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">benc</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                <span class="n">lis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lis</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="security-analysis-methods">Security analysis methods</h2>


<div class="doc doc-object doc-module">


<a id="security_analysis_ac17"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="security_analysis_ac17.security_analysis" class="doc doc-heading">
<code class="highlight language-python"><span class="n">security_analysis</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">controlled</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This is the main function that performs all steps relevant to the security analysis of a scheme satisfying the AC17 form</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>controlled</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Flag</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>constraints</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of constraints.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is trivial secure.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is collusion secure.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Process log.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>security_analysis_ac17.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">security_analysis</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">controlled</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the main function that performs all steps relevant to the security analysis of a scheme satisfying the AC17 form</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>
<span class="sd">        controlled (bool): Flag</span>
<span class="sd">        constraints (list): List of constraints.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): The scheme is trivial secure.</span>
<span class="sd">        (bool): The scheme is collusion secure.</span>
<span class="sd">        (str): Process log.</span>
<span class="sd">    &quot;&quot;&quot;</span>    

    <span class="n">analysis_log</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">proof_log</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">ac17_log</span><span class="p">)</span> <span class="o">=</span> <span class="n">correct_form</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ac17_log</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">correct</span><span class="p">:</span>
        <span class="c1">#print(&quot;\n Security analysis for AC17 schemes cannot be performed.&quot;)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Security analysis for AC17 schemes cannot be performed.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print(&quot;\n Performing security analysis on the following encodings:\n&quot;)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Performing security analysis on the following encodings:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1">#pprint(&quot;\t\tMPK encodings: \t\t\t&quot; + str(benc) + &quot;\n&quot;, use_unicode=True)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">MPK encodings: </span><span class="se">\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">benc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1">#pprint(&quot;\t\tKey encodings: \t\t\t&quot; + str(kenc) + &quot;\n&quot;, use_unicode=True)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Key encodings: </span><span class="se">\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kenc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1">#pprint(&quot;\t\tCiphertext encodings: \t&quot; + str(cenc) + &quot;\n&quot;, use_unicode=True)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Ciphertext encodings: </span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cenc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1">#print(&quot;\n == Performing simple trivial security check.. ==&quot;)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> == Performing simple trivial security check.. ==&quot;</span><span class="p">)</span>
        <span class="n">trivial_secure</span><span class="p">,</span> <span class="n">log_trivial_security</span> <span class="o">=</span> <span class="n">verify_trivial_security</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">controlled</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">log_trivial_security</span><span class="p">)</span>

        <span class="c1">#print(&quot;\n == Performing collusion security checks.. ==&quot;)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> == Performing collusion security checks.. ==&quot;</span><span class="p">)</span>
        <span class="n">collusion_secure</span><span class="p">,</span> <span class="n">log</span> <span class="o">=</span> <span class="n">generate_the_proofs_and_check_collusion</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>

        <span class="n">log</span> <span class="o">=</span> <span class="n">FABEO_properties</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
        <span class="n">analysis_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trivial_secure</span> <span class="ow">and</span> <span class="n">collusion_secure</span><span class="p">:</span> 
            <span class="n">proof_log</span> <span class="o">=</span> <span class="n">generate_the_proofs</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">trivial_secure</span><span class="p">,</span> <span class="n">collusion_secure</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_log</span><span class="p">),</span> <span class="n">proof_log</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="main-security-proof-methods">Main security proof methods</h2>


<div class="doc doc-object doc-module">


<a id="doc_security_proof"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="doc_security_proof.generate_the_encodings_then_the_proofs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_the_encodings_then_the_proofs</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">kenc_fixed</span><span class="p">,</span> <span class="n">kenc_att</span><span class="p">,</span> <span class="n">cenc_fixed</span><span class="p">,</span> <span class="n">cenc_att</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This helper function can generate encodings automatically using the encodings_helper.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc_fixed</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Fixed key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc_att</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attribute-dependent key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc_fixed</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Fixed ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc_att</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attribute-dependent ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unkonwn variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>prefixes</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prefixes utilized.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nr_indexed_encodings</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indexed encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Generated proofs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_security_proof.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_the_encodings_then_the_proofs</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">kenc_fixed</span><span class="p">,</span> <span class="n">kenc_att</span><span class="p">,</span> <span class="n">cenc_fixed</span><span class="p">,</span> <span class="n">cenc_att</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This helper function can generate encodings automatically using the encodings_helper.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        kenc_fixed (list): Fixed key encodings.</span>
<span class="sd">        kenc_att (list): Attribute-dependent key encodings.</span>
<span class="sd">        cenc_fixed (list): Fixed ciphertext encodings.</span>
<span class="sd">        cenc_att (list): Attribute-dependent ciphertext encodings.</span>
<span class="sd">        unknown (list): List of unkonwn variables.</span>
<span class="sd">        prefixes (list): Prefixes utilized.</span>
<span class="sd">        nr_indexed_encodings (int): Indexed encodings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Generated proofs.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">att_range_key_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">att_range_ct</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">benc</span> <span class="o">=</span> <span class="n">create_b_encoding</span><span class="p">([],</span> <span class="n">benc</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">cenc</span> <span class="o">=</span> <span class="n">create_ciphertext_encoding</span><span class="p">(</span><span class="n">cenc_fixed</span><span class="p">,</span> <span class="n">cenc_att</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">att_range_ct</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">)</span>    

    <span class="n">kenc</span> <span class="o">=</span> <span class="n">create_key_encoding</span><span class="p">(</span><span class="n">kenc_fixed</span><span class="p">,</span> <span class="n">kenc_att</span><span class="p">,</span> <span class="n">att_range_key_1</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">,</span> <span class="n">nr_indexed_encodings</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">unknown2</span> <span class="o">=</span> <span class="n">generate_unknown_variable_set</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">att_range_ct</span><span class="p">,</span> <span class="n">att_range_key_1</span><span class="p">)</span>
    <span class="n">unknown</span> <span class="o">=</span> <span class="n">merge_lists</span><span class="p">(</span><span class="n">unknown</span><span class="p">,</span> <span class="n">unknown2</span><span class="p">)</span>

    <span class="n">generate_the_proofs</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_security_proof.generate_the_proofs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_the_proofs</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function generates the proofs for the given encodings.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unkonwn variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Generated proofs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_security_proof.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_the_proofs</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function generates the proofs for the given encodings.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): List of unkonwn variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Generated proofs.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">)</span> <span class="o">=</span> <span class="n">correct_form_silent</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">correct</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">== Generating a security proof for the following encodings: ==</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">MPK encodings: </span><span class="se">\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">benc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Key encodings: </span><span class="se">\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kenc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Ciphertext encodings: </span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cenc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">generate_proof_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">normalize_substitutions</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">pprint</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">verify_proof</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The selective proof verifies correctly. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> [!] The selective proof does *not* verify correctly! </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> No selective proof found.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">output2</span> <span class="o">=</span> <span class="n">generate_proof_co_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
        <span class="n">output2</span> <span class="o">=</span> <span class="n">normalize_substitutions</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">output2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The co-selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">pprint</span><span class="p">(</span><span class="n">output2</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">verify_proof</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">output2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The co-selective proof verifies correctly. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> [!] The co-selective proof does *not* verify correctly! </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> No co-selective proof found.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="trivial-security-and-collusion-checks">Trivial security and collusion checks</h2>


<div class="doc doc-object doc-module">


<a id="doc_trivial_security_and_collusion"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.analysis_trivial_and_collusion_security" class="doc doc-heading">
<code class="highlight language-python"><span class="n">analysis_trivial_and_collusion_security</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Analyzes the trivial and collusion security of the scheme.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blindingvalue</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is trivial secure.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is collusion secure.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">analysis_trivial_and_collusion_security</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analyzes the trivial and collusion security of the scheme.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        blindingvalue (sp.core.list.Symbol): Blinding value.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): The scheme is trivial secure.</span>
<span class="sd">        (bool): The scheme is collusion secure.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">MPK encodings: </span><span class="se">\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">benc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Key encodings: </span><span class="se">\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kenc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Ciphertext encodings: </span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cenc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">trivial_secure</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">collusion_secure</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> == Performing simple trivial security check.. ==&quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="n">trivial_secure</span><span class="p">,</span> <span class="n">kern</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">)</span> <span class="o">=</span> <span class="n">verify_trivial_security_generalized</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">trivial_secure</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> The scheme is probably trivially secure, because there exists a solution for the equations.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> The scheme may not be trivially secure, because no solution could be found.&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> == Performing collusion security check.. ==&quot;</span><span class="p">)</span>
    <span class="n">collusion_secure</span> <span class="o">=</span> <span class="n">verify_collusion_security_generalized</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">kern</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">trivial_secure</span><span class="p">,</span> <span class="n">collusion_secure</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.generate_the_proofs_and_check_collusion" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_the_proofs_and_check_collusion</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Verifies security against collusion of a scheme that satisfies the AC17 form.
It uses the security proofs for this, which implies the collusion-security check
in the generalized variant of this function.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collusion analysis result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_the_proofs_and_check_collusion</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verifies security against collusion of a scheme that satisfies the AC17 form.</span>
<span class="sd">    It uses the security proofs for this, which implies the collusion-security check</span>
<span class="sd">    in the generalized variant of this function.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Collusion analysis result.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">)</span> <span class="o">=</span> <span class="n">correct_form_silent</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="n">collusion_secure</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">correct</span><span class="p">:</span> 
        <span class="n">output</span> <span class="o">=</span> <span class="n">generate_proof_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">normalize_substitutions</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">verify_collusion_security_only</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> [!] The scheme is possibly insecure against collusion! </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> [!] No selective proof found. The scheme is possibly insecure against collusion! </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">output2</span> <span class="o">=</span> <span class="n">generate_proof_co_selective</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
        <span class="n">output2</span> <span class="o">=</span> <span class="n">normalize_substitutions</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">output2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result2</span> <span class="o">=</span> <span class="n">verify_proof</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">output2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result2</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> The scheme satisfies our collusion property and is thus secure against collusion. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">collusion_secure</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> [!] The scheme is possibly insecure against collusion! </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> [!] No co-selective proof found. The scheme is possibly insecure against collusion! </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">collusion_secure</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.obtain_masterkeys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">obtain_masterkeys</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Obtains the master keys from the encodings.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blindingvalue</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>What masks the message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Master keys.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">obtain_masterkeys</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtains the master keys from the encodings.</span>

<span class="sd">    Parameters:</span>

<span class="sd">        blindingvalue (sp.core.list.Symbol): What masks the message.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Master keys.</span>
<span class="sd">        (list): Key encodings.</span>
<span class="sd">        (list): Ciphertext encodings.</span>
<span class="sd">        (list): Public key encodings.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">lis_vars_blindingvalue</span> <span class="o">=</span> <span class="n">get_vars_polynomial</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">)</span>
    <span class="n">lis_vars_kenc</span> <span class="o">=</span> <span class="n">get_vars_list_polynomials</span><span class="p">(</span><span class="n">kenc</span><span class="p">)</span>
    <span class="n">lis_vars_cenc</span> <span class="o">=</span> <span class="n">get_vars_list_polynomials</span><span class="p">(</span><span class="n">cenc</span><span class="p">)</span>
    <span class="n">lis_vars_benc</span> <span class="o">=</span> <span class="n">get_vars_list_polynomials</span><span class="p">(</span><span class="n">benc</span><span class="p">)</span>

    <span class="n">lis_masterkeys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">lis_vars_blindingvalue</span><span class="p">:</span>
        <span class="n">is_unknown</span> <span class="o">=</span> <span class="p">(</span><span class="n">elem</span> <span class="ow">in</span> <span class="n">unknown</span><span class="p">)</span>
        <span class="n">in_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">elem</span> <span class="ow">in</span> <span class="n">lis_vars_kenc</span><span class="p">)</span>
        <span class="n">not_in_cenc</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span><span class="n">elem</span> <span class="ow">in</span> <span class="n">lis_vars_cenc</span><span class="p">)</span>
        <span class="n">not_in_benc</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span><span class="n">elem</span> <span class="ow">in</span> <span class="n">lis_vars_benc</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_unknown</span> <span class="ow">and</span> <span class="n">in_key</span> <span class="ow">and</span> <span class="n">not_in_cenc</span> <span class="ow">and</span> <span class="n">not_in_benc</span><span class="p">:</span>
            <span class="n">lis_masterkeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">lis_masterkeys</span><span class="p">,</span> <span class="n">lis_vars_kenc</span><span class="p">,</span> <span class="n">lis_vars_cenc</span><span class="p">,</span> <span class="n">lis_vars_benc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.print_transcript_to_trivial_and_collusion_security" class="doc doc-heading">
<code class="highlight language-python"><span class="n">print_transcript_to_trivial_and_collusion_security</span><span class="p">(</span><span class="n">kern</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">,</span> <span class="n">lis_shared_indices_not_bv</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates and prints a transcript that proves trivial and collusion security of the scheme.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kern</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_vector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Target.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>list_bv_indices</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lis_shared_indices_not_bv</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shared indices that are not in bv.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">print_transcript_to_trivial_and_collusion_security</span><span class="p">(</span><span class="n">kern</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">,</span> <span class="n">lis_shared_indices_not_bv</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates and prints a transcript that proves trivial and collusion security of the scheme.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kern (list): Kernel.</span>
<span class="sd">        uvector (list): Unknown variables vector.</span>
<span class="sd">        target_vector (list): Target.</span>
<span class="sd">        list_bv_indices (list): Indices.</span>
<span class="sd">        lis_shared_indices_not_bv: Shared indices that are not in bv.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> Attempting to compute transcript to trivial and collusion security..&quot;</span><span class="p">)</span>

    <span class="n">kern_short</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
        <span class="n">vec_s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared_indices_not_bv</span><span class="p">:</span>
            <span class="n">vec_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
        <span class="n">kern_short</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec_s</span><span class="p">)</span>

    <span class="n">mat_kern_short</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">Matrix</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern_short</span><span class="p">])</span>
    <span class="n">mks_ns</span> <span class="o">=</span> <span class="n">mat_kern_short</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mks_ns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> The system could not find a transcript.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">kern_red</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ks_vec</span> <span class="ow">in</span> <span class="n">mks_ns</span><span class="p">:</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">ks_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">kern</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ks_vec</span><span class="p">)):</span>
            <span class="n">vec</span> <span class="o">+=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">ks_vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">*</span><span class="n">kern</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
        <span class="n">kern_red</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

    <span class="n">kern_red2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern_red</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">target_vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_vector</span><span class="p">)))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">kern_red2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kern_red2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> The system could not find a transcript.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">kern_vec</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">kern_red2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern_red2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">kern_vec</span> <span class="o">+=</span> <span class="n">vec</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> The system found a transcript, so the scheme is trivially secure and secure against collusion.&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> Substitutions for the terms associated with the blinding value:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">list_bv_indices</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> - &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uvector</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> Substitutions for the special terms that are shared among keys and are not associated with the blinding value:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared_indices_not_bv</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> - &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uvector</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span>

    <span class="n">lis_rest_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">list_bv_indices</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared_indices_not_bv</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> Substitutions for the rest of the terms:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_rest_indices</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> - &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uvector</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kern_vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.reduce_kern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reduce_kern</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">kern</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Removes all the kernel vectors that are all-zero in the given indices.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>indices</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kern</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New kernel.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reduce_kern</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">kern</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes all the kernel vectors that are all-zero in the given indices.</span>

<span class="sd">    Parameters:</span>

<span class="sd">        indices (list): Indices.</span>
<span class="sd">        kern (list): Kernel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): New kernel.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">new_kern</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
        <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">at_least_one_nonzero</span><span class="p">:</span>
            <span class="n">new_kern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_kern</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.remove_kern_unnecessary_vecs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_kern_unnecessary_vecs</span><span class="p">(</span><span class="n">bv_indices</span><span class="p">,</span> <span class="n">shared_indices_not_bv</span><span class="p">,</span> <span class="n">kern</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Removes all kernel vectors that do not contribute to solution.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bv_indices</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shared_indices_not_bv</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shared indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kern</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New kernel.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_kern_unnecessary_vecs</span><span class="p">(</span><span class="n">bv_indices</span><span class="p">,</span> <span class="n">shared_indices_not_bv</span><span class="p">,</span> <span class="n">kern</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes all kernel vectors that do not contribute to solution.</span>

<span class="sd">    Parameters:</span>

<span class="sd">        bv_indices (list): Indices.</span>
<span class="sd">        shared_indices_not_bv (list): Shared indices.</span>
<span class="sd">        kern (list): Kernel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): New kernel.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">new_kern</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">kern_remainder</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
        <span class="n">allzero</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">bv_indices</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">allzero</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">allzero</span><span class="p">:</span>
            <span class="n">kern_remainder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

    <span class="n">kern_vecs_removed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">shared_indices_not_bv</span><span class="p">:</span>
        <span class="n">non_zeros</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern_remainder</span> <span class="ow">and</span> <span class="n">vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">non_zeros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctr</span><span class="p">)</span>
            <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_zeros</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">non_zeros</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">kern_vecs_removed</span><span class="p">:</span>
                <span class="n">kern_vecs_removed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">non_zeros</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ctr</span> <span class="ow">in</span> <span class="n">kern_vecs_removed</span><span class="p">:</span>
            <span class="n">new_kern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">new_kern</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.verify_collusion_security_generalized" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verify_collusion_security_generalized</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">kern</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks whether the scheme is secure against collusion.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blindingvalue</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kern</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_vector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Target.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>list_bv_indices</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">verify_collusion_security_generalized</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">kern</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the scheme is secure against collusion.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        blindingvalue (sp.core.list.Symbol): Blinding value.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>
<span class="sd">        kern (list): Kernel.</span>
<span class="sd">        uvector (list): Unknown variables vector.</span>
<span class="sd">        target_vector (list): Target.</span>
<span class="sd">        list_bv_indices (list): Indices.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="p">(</span><span class="n">lis_masterkeys</span><span class="p">,</span> <span class="n">lis_vars_kenc</span><span class="p">,</span> <span class="n">lis_vars_cenc</span><span class="p">,</span> <span class="n">lis_vars_benc</span><span class="p">)</span> <span class="o">=</span> <span class="n">obtain_masterkeys</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">lis_shared_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)):</span>
        <span class="n">vars_elem</span> <span class="o">=</span> <span class="n">get_vars_polynomial</span><span class="p">(</span><span class="n">uvector</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
        <span class="n">is_shared</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">vars_elem</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">var</span> <span class="ow">in</span> <span class="n">lis_vars_kenc</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">var</span> <span class="ow">in</span> <span class="n">lis_vars_benc</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">var</span> <span class="ow">in</span> <span class="n">lis_masterkeys</span><span class="p">):</span>
                <span class="n">is_shared</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">is_shared</span><span class="p">:</span>
            <span class="n">lis_shared_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>

    <span class="n">lis_shared_indices_not_bv</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared_indices</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">list_bv_indices</span><span class="p">]</span>

    <span class="n">kern</span> <span class="o">=</span> <span class="n">reduce_kern</span><span class="p">(</span><span class="n">lis_shared_indices</span><span class="p">,</span> <span class="n">kern</span><span class="p">)</span>

    <span class="n">kern</span> <span class="o">=</span> <span class="n">remove_kern_unnecessary_vecs</span><span class="p">(</span><span class="n">list_bv_indices</span><span class="p">,</span> <span class="n">lis_shared_indices_not_bv</span><span class="p">,</span> <span class="n">kern</span><span class="p">)</span>

    <span class="n">transcript_found</span> <span class="o">=</span> <span class="n">print_transcript_to_trivial_and_collusion_security</span><span class="p">(</span><span class="n">kern</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">,</span> <span class="n">lis_shared_indices_not_bv</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">transcript_found</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> If there exists a solution for the previous system of equations such that the following system of equations holds:&quot;</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">ctr</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared_indices_not_bv</span><span class="p">:</span>
            <span class="n">msg2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_bv_indices</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;) &quot;</span>
            <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">ind2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kern</span><span class="p">)):</span>
                <span class="n">eq_is_zero</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">el</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">kern</span><span class="p">[</span><span class="n">ind2</span><span class="p">][</span><span class="n">ind</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">el</span><span class="o">.</span><span class="n">is_integer</span><span class="p">:</span>
                    <span class="n">eq</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
                    <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">el</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">eq</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kern</span><span class="p">[</span><span class="n">ind2</span><span class="p">][</span><span class="n">ind</span><span class="p">])</span>
                        <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">eq_is_zero</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">eq_is_zero</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span> 
                        <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; + c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ind2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="n">eq</span>
                    <span class="k">else</span><span class="p">:</span> 
                        <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ind2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="n">eq</span>
                        <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">at_least_one_nonzero</span><span class="p">:</span>
                <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; = 0,&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">msg2</span>
                <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> then the scheme is secure against collusion. If not, then the scheme may be vulnerable to a collusion attack.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.verify_trivial_security" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verify_trivial_security</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">controlled</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>The first two functions are for the AC17 case . It also verifies the trivial
security of a scheme that satisfies the AC17 form.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sympy expression of the master key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Trivial security verification.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">verify_trivial_security</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">,</span> <span class="n">controlled</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The first two functions are for the AC17 case . It also verifies the trivial</span>
<span class="sd">    security of a scheme that satisfies the AC17 form.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Sympy expression of the master key.</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding factor.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Trivial security verification.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="p">(</span><span class="n">eqsfound</span><span class="p">,</span> <span class="n">eqs_to_analyze</span><span class="p">)</span> <span class="o">=</span> <span class="n">check_kernel_products</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">eqsfound</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> Failed!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">eqs_to_analyze</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">eq</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> Passed! The security of the scheme depends on whether at least one of the following assumption(s) holds:&quot;</span><span class="p">)</span>
        <span class="n">ctr</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">eqs_to_analyze</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;) &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; != 0&quot;</span><span class="p">)</span>
                <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">ctr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> None&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">at_least_one_nonzero</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_trivial_security_and_collusion.verify_trivial_security_generalized" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verify_trivial_security_generalized</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Verifies the trivial security of the scheme. The blinding value is what masks the message.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blindingvalue</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>What masks the message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Public key encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Verification result.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_trivial_security_and_collusion.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">verify_trivial_security_generalized</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verifies the trivial security of the scheme. The blinding value is what masks the message.</span>

<span class="sd">    Parameters:</span>

<span class="sd">        blindingvalue (sp.core.list.Symbol): What masks the message.</span>
<span class="sd">        kenc (list): Key encodings.</span>
<span class="sd">        cenc (list): Ciphertext encodings.</span>
<span class="sd">        benc (list): Public key encodings.</span>
<span class="sd">        unknown (list): Unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): Verification result.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="n">penc</span> <span class="o">=</span> <span class="n">gen_all_p</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">penc</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">(</span><span class="n">penc</span><span class="p">)</span>

    <span class="n">denoms</span> <span class="o">=</span> <span class="n">collect_denoms</span><span class="p">(</span><span class="n">penc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="n">denomprod</span> <span class="o">=</span> <span class="n">denoms_prod</span><span class="p">(</span><span class="n">denoms</span><span class="p">)</span>
    <span class="n">penc</span> <span class="o">=</span> <span class="n">transform_encoding_list</span><span class="p">(</span><span class="n">denomprod</span><span class="p">,</span> <span class="n">penc</span><span class="p">)</span>
    <span class="n">blindingvalue</span> <span class="o">=</span> <span class="n">canonical</span><span class="p">([</span><span class="n">cancel</span><span class="p">(</span><span class="n">blindingvalue</span> <span class="o">*</span> <span class="n">denomprod</span><span class="p">)])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">penc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

    <span class="n">luvec1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>
    <span class="n">target_vector</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">writepolyasprod</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)])</span>
    <span class="n">luvec2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">luvec1</span> <span class="o">!=</span> <span class="n">luvec2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> Passed! The blinding value contains terms that cannot be created with the rest of the ciphertext and the key. However, because of this property, collusion security cannot be verified.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">list_bv_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">target_vector</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">elem</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">list_bv_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctr</span><span class="p">)</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">kern</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>

    <span class="n">kern_red</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">kern_remainder</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
        <span class="n">at_least_one_zero</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">list_bv_indices</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">at_least_one_zero</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">at_least_one_zero</span><span class="p">:</span>
            <span class="n">kern_red</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kern_remainder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kern_red</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> Failed!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> If there exists a solution for the following system of equations:&quot;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ctr2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_bv_indices</span><span class="p">)):</span>
        <span class="n">msg2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;) &quot;</span>
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">ind2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kern_red</span><span class="p">)):</span>
            <span class="n">eq_is_zero</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">el</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">(</span><span class="n">kern_red</span><span class="p">[</span><span class="n">ind2</span><span class="p">][</span><span class="n">list_bv_indices</span><span class="p">[</span><span class="n">ind</span><span class="p">]])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">el</span><span class="o">.</span><span class="n">is_integer</span><span class="p">:</span>
                <span class="n">eq</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
                <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">el</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">eq</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
                    <span class="n">at_least_one_nonzero</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">eq_is_zero</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">eq_is_zero</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span> 
                    <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; + c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ind2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="n">eq</span>
                <span class="k">else</span><span class="p">:</span> 
                    <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ind2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="n">eq</span>
                    <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">at_least_one_nonzero</span><span class="p">:</span>
            <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="s2">&quot;d&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr2</span><span class="p">)</span> <span class="c1">#str(target_vector[list_bv_indices[ind]])</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">msg2</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">msg2</span> <span class="o">+</span> <span class="s2">&quot; 0 = &quot;</span> <span class="o">+</span> <span class="s2">&quot;d&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr2</span><span class="p">)</span> <span class="c1">#+ str(target_vector[list_bv_indices[ind]])</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">ctr2</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">msg2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;) &quot;</span>
    <span class="n">ctr3</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_bv_indices</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
            <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; +&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">el</span> <span class="o">=</span> <span class="n">target_vector</span><span class="p">[</span><span class="n">list_bv_indices</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">el</span><span class="o">.</span><span class="n">is_integer</span><span class="p">:</span>
            <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; d&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;*(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; d&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctr3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
        <span class="n">ctr3</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">msg2</span> <span class="o">+=</span> <span class="s2">&quot; != 0&quot;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">msg2</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kern_red</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kern_red</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">cstring</span> <span class="o">=</span> <span class="s2">&quot;c0,...,c&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kern_red</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cstring</span> <span class="o">=</span> <span class="s2">&quot;c0,c1,&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cstring</span> <span class="o">=</span> <span class="s2">&quot;c0,&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_bv_indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_bv_indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">dstring</span> <span class="o">=</span> <span class="s2">&quot;d0,...,d&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_bv_indices</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dstring</span> <span class="o">=</span> <span class="s2">&quot;d0,d1&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dstring</span> <span class="o">=</span> <span class="s2">&quot;d0&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> where &quot;</span> <span class="o">+</span> <span class="n">cstring</span> <span class="o">+</span> <span class="n">dstring</span> <span class="o">+</span> <span class="s2">&quot; denote the coefficients, then the scheme is trivially secure.&quot;</span><span class="p">)</span>

    <span class="n">kern_red2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern_red</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">target_vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_vector</span><span class="p">)))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">kern_red2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kern_red2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">kern_red</span> <span class="o">+</span> <span class="n">kern_remainder</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">kern_red</span> <span class="o">+</span> <span class="n">kern_remainder</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">,</span> <span class="n">list_bv_indices</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="security-class-for-performing-security-checks-on-abe-schemes">Security class for performing security checks on ABE schemes</h2>


<div class="doc doc-object doc-module">


<a id="security"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="security.SecurityAttack" class="doc doc-heading">
          <code>SecurityAttack</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="attack.Attack" href="#attack.Attack">Attack</a></code></p>

  
      <p>Analyzes the security of an ABE scheme.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>SOL_MSG</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is secure.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>NOT_FOUND_MSG</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is insecure.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.list">list</span>.<span title="sympy.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Representation of the master key.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>s</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.list">list</span>.<span title="sympy.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Representation of the blinding factor.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.list">list</span>.<span title="sympy.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Representation of the master key and blinding factor.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>is_fractional</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is fractional.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>sol</code></td>
          <td>
                <code>string</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Solution of the attack, if found.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>k_encodings</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.symbol.Symbol types representing the key
encodings.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>c_encodings</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.symbol.Symbol types representing the
ciphertext components.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>mpk_encodings</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.symbol.Symbol types representing the 
master public key components involved in the attack (they could be related
to corruption of the authorities). </p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sp.core.symbol.Symbol types representing the 
unknown variables.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>trivial_secure</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is trivial secure.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>collusion_secure</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scheme is collusion secure.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>security.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SecurityAttack</span><span class="p">(</span><span class="n">Attack</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyzes the security of an ABE scheme.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            SOL_MSG (str): The scheme is secure.</span>
<span class="sd">            NOT_FOUND_MSG (str): The scheme is insecure.</span>
<span class="sd">            alpha (sp.core.list.Symbol): Representation of the master key.</span>
<span class="sd">            s (sp.core.list.Symbol): Representation of the blinding factor.</span>
<span class="sd">            key (sp.core.list.Symbol): Representation of the master key and blinding factor.</span>
<span class="sd">            is_fractional (bool): The scheme is fractional.</span>
<span class="sd">            sol (string): Solution of the attack, if found.</span>
<span class="sd">            k_encodings (list): List of sp.core.symbol.Symbol types representing the key</span>
<span class="sd">                encodings.</span>
<span class="sd">            c_encodings (list): List of sp.core.symbol.Symbol types representing the</span>
<span class="sd">                ciphertext components.</span>
<span class="sd">            mpk_encodings (list): List of sp.core.symbol.Symbol types representing the </span>
<span class="sd">                master public key components involved in the attack (they could be related</span>
<span class="sd">                to corruption of the authorities). </span>
<span class="sd">            unknown (list): List of sp.core.symbol.Symbol types representing the </span>
<span class="sd">                unknown variables.</span>
<span class="sd">            trivial_secure (bool): The scheme is trivial secure.</span>
<span class="sd">            collusion_secure (bool): The scheme is collusion secure.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">SOL_MSG</span> <span class="o">=</span> <span class="s2">&quot;[*] The scheme is secure: &quot;</span>
        <span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="s2">&quot;[!] The scheme is insecure&quot;</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">s</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">is_fractional</span> <span class="o">=</span>  <span class="kc">None</span>
        <span class="n">sol</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">k_encodings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">c_encodings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">mpk_encodings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">trivial_secure</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">collusion_secure</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;SecurityAttack&quot;</span>
        <span class="n">result_security</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">proof_log</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">k_encodings</span><span class="p">,</span> <span class="n">c_encodings</span><span class="p">,</span> <span class="n">mpk_encodings</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#self.alpha = alpha</span>
            <span class="c1">#self.s = s</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
            <span class="c1">#self.is_fractional =  is_fractional</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span> <span class="o">=</span> <span class="n">k_encodings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span> <span class="o">=</span> <span class="n">c_encodings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span> <span class="o">=</span> <span class="n">mpk_encodings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="n">unknown</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            The constructor for SecurityAttack class. </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_fractional</span> <span class="o">=</span>  <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Returns the result of the attack.</span>

<span class="sd">            Returns:</span>
<span class="sd">                solution (str): The result of the attack.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span>

        <span class="k">def</span> <span class="nf">show_proof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Returns the result of the proof.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># process proof log</span>

            <span class="n">placeholder_1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">placeholder_2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The co-selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">placeholder_1</span><span class="p">:</span>
                        <span class="n">pprint</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">placeholder_2</span><span class="p">:</span>
                        <span class="n">pprint</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                    
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">show_proof_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Returns the result of the proof in latex for HTML.</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">message_log</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">header</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">post_header</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># process proof log</span>

            <span class="n">placeholder_1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">placeholder_2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The co-selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="n">placeholder_1</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

            <span class="n">message_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">placeholder_1</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">placeholder_1</span><span class="p">:</span>
                        <span class="n">post_header</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">message_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;\[ &quot;</span> <span class="o">+</span> <span class="n">latex</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; \]&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">placeholder_2</span><span class="p">:</span>
                        <span class="n">message_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;\[ &quot;</span> <span class="o">+</span> <span class="n">latex</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; \]&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">post_header</span><span class="p">:</span>
                            <span class="n">message_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">message_log</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">format_encodings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Prints the involved encodings in the given ABE scheme.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># TODO</span>

        <span class="k">def</span> <span class="nf">set_sol_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Allows to set the found solution message.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                msg (str): Message.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SOL_MSG</span> <span class="o">=</span> <span class="n">msg</span>

        <span class="k">def</span> <span class="nf">set_not_found_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Allows to set the not found solution message.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                msg (str): Message.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="n">msg</span>


        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Analyze the security of the scheme with the supplied</span>
<span class="sd">            ABE scheme parameters.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># First, we determine the type of scheme.</span>
            <span class="n">is_fractional</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">all_enc_contains_no_fractions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_fractional</span> <span class="o">=</span> <span class="n">is_fractional</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_fractional</span><span class="p">:</span>

                <span class="c1"># Second, we need to determine alpha and special s.</span>
                <span class="n">res</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">special_s</span> <span class="o">=</span> <span class="n">blinding_value_correct_form</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span> <span class="o">=</span> <span class="n">security_analysis</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span> <span class="o">=</span> <span class="n">analysis_trivial_and_collusion_security</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span> <span class="o">=</span> <span class="n">analysis_trivial_and_collusion_security</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="s2">&quot;NOTE: If the scheme is MA-ABE you might try to run this check with corruption.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_security</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">add_corruptable_variable_generic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Adds variables that can be obtained by corruption to the unknown variables array.</span>

<span class="sd">            Parameters:</span>
<span class="sd">                corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">((</span><span class="n">corr</span><span class="p">)</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The constructor for SecurityAttack class.</p>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The constructor for SecurityAttack class. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_fractional</span> <span class="o">=</span>  <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.add_corruptable_variable_generic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_corruptable_variable_generic</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds variables that can be obtained by corruption to the unknown variables array.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>corr</code></td>
          <td>
                <code><span title="sympy">sp</span>.<span title="sympy.core">core</span>.<span title="sympy.core.symbol">symbol</span>.<span title="sympy.core.symbol.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corruptable variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_corruptable_variable_generic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corr</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds variables that can be obtained by corruption to the unknown variables array.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        corr (sp.core.symbol.Symbol): Corruptable variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">((</span><span class="n">corr</span><span class="p">)</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.format_encodings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">format_encodings</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prints the involved encodings in the given ABE scheme.</p>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_encodings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints the involved encodings in the given ABE scheme.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Analyze the security of the scheme with the supplied
ABE scheme parameters.</p>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analyze the security of the scheme with the supplied</span>
<span class="sd">    ABE scheme parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># First, we determine the type of scheme.</span>
    <span class="n">is_fractional</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">all_enc_contains_no_fractions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_fractional</span> <span class="o">=</span> <span class="n">is_fractional</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_fractional</span><span class="p">:</span>

        <span class="c1"># Second, we need to determine alpha and special s.</span>
        <span class="n">res</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">special_s</span> <span class="o">=</span> <span class="n">blinding_value_correct_form</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span> <span class="o">=</span> <span class="n">security_analysis</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span> <span class="o">=</span> <span class="n">analysis_trivial_and_collusion_security</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trivial_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collusion_secure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_security</span> <span class="o">=</span> <span class="n">analysis_trivial_and_collusion_security</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpk_encodings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="s2">&quot;NOTE: If the scheme is MA-ABE you might try to run this check with corruption.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_security</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.set_not_found_msg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_not_found_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Allows to set the not found solution message.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>msg</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_not_found_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows to set the not found solution message.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        msg (str): Message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">NOT_FOUND_MSG</span> <span class="o">=</span> <span class="n">msg</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.set_sol_msg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_sol_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Allows to set the found solution message.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>msg</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_sol_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows to set the found solution message.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        msg (str): Message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SOL_MSG</span> <span class="o">=</span> <span class="n">msg</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.show_proof" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_proof</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the result of the proof.</p>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show_proof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the result of the proof.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># process proof log</span>

    <span class="n">placeholder_1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">placeholder_2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The co-selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">placeholder_1</span><span class="p">:</span>
                <span class="n">pprint</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">placeholder_2</span><span class="p">:</span>
                <span class="n">pprint</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                    
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.show_proof_latex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_proof_latex</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the result of the proof in latex for HTML.</p>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show_proof_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the result of the proof in latex for HTML.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">message_log</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">post_header</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># process proof log</span>

    <span class="n">placeholder_1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">placeholder_2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The co-selective proof: </span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="n">placeholder_1</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="n">message_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">placeholder_1</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">placeholder_1</span><span class="p">:</span>
                <span class="n">post_header</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">message_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;\[ &quot;</span> <span class="o">+</span> <span class="n">latex</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; \]&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">placeholder_2</span><span class="p">:</span>
                <span class="n">message_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;\[ &quot;</span> <span class="o">+</span> <span class="n">latex</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; \]&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">post_header</span><span class="p">:</span>
                    <span class="n">message_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proof_log</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">message_log</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="security.SecurityAttack.show_solution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_solution</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the result of the attack.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>solution</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the attack.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>security.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">show_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the result of the attack.</span>

<span class="sd">    Returns:</span>
<span class="sd">        solution (str): The result of the attack.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="functions-for-checking-the-fabeo-property">Functions for checking the FABEO property</h2>


<div class="doc doc-object doc-module">


<a id="doc_FABEO_properties"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="doc_FABEO_properties.FABEO_properties" class="doc doc-heading">
<code class="highlight language-python"><span class="n">FABEO_properties</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This is the main function that checks whether the FABEO property is satisfied.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Master key description</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding value description.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings,</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Common variable encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the checking the FABEO property.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_FABEO_properties.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">FABEO_properties</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the main function that checks whether the FABEO property is satisfied.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Master key description</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding value description.</span>
<span class="sd">        kenc (list of sp.core.list.Symbol): Key encodings,</span>
<span class="sd">        cenc (list of sp.core.list.Symbol): Ciphertext encodings.</span>
<span class="sd">        benc (list of sp.core.list.Symbol): Common variable encodings.</span>
<span class="sd">        unknown (list of sp.core.list.Symbol): List of unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (str): The result of the checking the FABEO property.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">process_log</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">)</span> <span class="o">=</span> <span class="n">correct_form_silent</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">blindingvalue</span> <span class="o">=</span> <span class="n">masterkey</span> <span class="o">*</span> <span class="n">special_s</span>

    <span class="p">(</span><span class="n">nonlones_c</span><span class="p">,</span> <span class="n">nonlones_k</span><span class="p">,</span> <span class="n">cpolys</span><span class="p">,</span> <span class="n">kpolys</span><span class="p">)</span> <span class="o">=</span> <span class="n">determine_nonlones_and_polys</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">penc</span> <span class="o">=</span> <span class="n">compute_products_ac17</span><span class="p">(</span><span class="n">kpolys</span><span class="p">,</span> <span class="n">cpolys</span><span class="p">,</span> <span class="n">nonlones_k</span><span class="p">,</span> <span class="n">nonlones_c</span><span class="p">)</span>

    <span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">penc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

    <span class="n">target_vector</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">writepolyasprod</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)])</span>

    <span class="n">list_bv_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">target_vector</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">elem</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">list_bv_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctr</span><span class="p">)</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="p">(</span><span class="n">lis_masterkeys</span><span class="p">,</span> <span class="n">lis_vars_kenc</span><span class="p">,</span> <span class="n">lis_vars_cenc</span><span class="p">,</span> <span class="n">lis_vars_benc</span><span class="p">)</span> <span class="o">=</span> <span class="n">obtain_masterkeys</span><span class="p">(</span><span class="n">blindingvalue</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">lis_shared_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">)):</span>
        <span class="n">vars_elem</span> <span class="o">=</span> <span class="n">get_vars_polynomial</span><span class="p">(</span><span class="n">uvector</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
        <span class="n">is_shared</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">vars_elem</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">var</span> <span class="ow">in</span> <span class="n">lis_vars_kenc</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">var</span> <span class="ow">in</span> <span class="n">lis_vars_benc</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">var</span> <span class="ow">in</span> <span class="n">lis_masterkeys</span><span class="p">):</span>
                <span class="n">is_shared</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">is_shared</span><span class="p">:</span>
            <span class="n">lis_shared_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>

    <span class="n">lis_shared_indices_not_bv</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared_indices</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">list_bv_indices</span><span class="p">]</span>

    <span class="n">rs_shared</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared_indices</span><span class="p">:</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">uvector</span><span class="p">))</span>
        <span class="n">vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">rs_shared</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

    <span class="n">rank_rs_s</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">rs_shared</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
    <span class="n">mat_rs</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">rowspace</span><span class="p">()</span>
    <span class="n">rank_rs</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat_rs</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>

    <span class="n">rank_both</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">rs_shared</span> <span class="o">+</span> <span class="n">mat_rs</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">rank_both</span> <span class="o">==</span> <span class="n">rank_rs_s</span> <span class="o">+</span> <span class="n">rank_rs</span><span class="p">:</span>
        <span class="c1">#print(&quot;\t The scheme satisfies the FABEO property and is thus secure against collusion. \n&quot;)</span>
        <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> The scheme satisfies the FABEO property and is thus secure against collusion. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">process_log</span> <span class="o">+=</span> <span class="n">print_transcript_of_FABEO_property</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">lis_shared_indices</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print(&quot;\t The scheme does not satisfy the FABEO property. \n&quot;)</span>
        <span class="n">process_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> The scheme does not satisfy the FABEO property. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">process_log</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_FABEO_properties.compute_products_ac17" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compute_products_ac17</span><span class="p">(</span><span class="n">kpolys</span><span class="p">,</span> <span class="n">cpolys</span><span class="p">,</span> <span class="n">knons</span><span class="p">,</span> <span class="n">cnons</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function computes all products of non-lone variables and encoding polynomials</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kpolys</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encoding polynomial.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cpolys</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encoding polynomial.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>knons</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key non-lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cnons</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext non-lone variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Products.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_FABEO_properties.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_products_ac17</span><span class="p">(</span><span class="n">kpolys</span><span class="p">,</span> <span class="n">cpolys</span><span class="p">,</span> <span class="n">knons</span><span class="p">,</span> <span class="n">cnons</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function computes all products of non-lone variables and encoding polynomials</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kpolys (list): Key encoding polynomial.</span>
<span class="sd">        cpolys (list): Ciphertext encoding polynomial.</span>
<span class="sd">        knons (list): Key non-lone variables.</span>
<span class="sd">        cnons (list): Ciphertext non-lone variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Products.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">prods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x_k</span> <span class="ow">in</span> <span class="n">knons</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">poly_c</span> <span class="ow">in</span> <span class="n">cpolys</span><span class="p">:</span>
            <span class="n">prods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cancel</span><span class="p">(</span><span class="n">x_k</span> <span class="o">*</span> <span class="n">poly_c</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">x_c</span> <span class="ow">in</span> <span class="n">cnons</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">poly_k</span> <span class="ow">in</span> <span class="n">kpolys</span><span class="p">:</span>
            <span class="n">prods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cancel</span><span class="p">(</span><span class="n">x_c</span> <span class="o">*</span> <span class="n">poly_k</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">prods</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_FABEO_properties.determine_nonlones_and_polys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">determine_nonlones_and_polys</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function determines the non-lone variables and the encoding polynomials</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>masterkey</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Master key description</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>special_s</code></td>
          <td>
                <code>sp.<span title="sp.core">core</span>.<span title="sp.core.list">list</span>.<span title="sp.core.list.Symbol">Symbol</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blinding value description.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kenc</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encodings,</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cenc</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benc</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Common variable encodings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unknown</code></td>
          <td>
                <code>list of sp.core.list.Symbol</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone ciphertext variables.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-lone key variables.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ciphertext encoding polynomials.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key encoding polynomials.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_FABEO_properties.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">determine_nonlones_and_polys</span><span class="p">(</span><span class="n">masterkey</span><span class="p">,</span> <span class="n">special_s</span><span class="p">,</span> <span class="n">kenc</span><span class="p">,</span> <span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function determines the non-lone variables and the encoding polynomials</span>

<span class="sd">    Parameters:</span>
<span class="sd">        masterkey (sp.core.list.Symbol): Master key description</span>
<span class="sd">        special_s (sp.core.list.Symbol): Blinding value description.</span>
<span class="sd">        kenc (list of sp.core.list.Symbol): Key encodings,</span>
<span class="sd">        cenc (list of sp.core.list.Symbol): Ciphertext encodings.</span>
<span class="sd">        benc (list of sp.core.list.Symbol): Common variable encodings.</span>
<span class="sd">        unknown (list of sp.core.list.Symbol): List of unknown variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): Non-lone ciphertext variables.</span>
<span class="sd">        (list): Non-lone key variables.</span>
<span class="sd">        (list): Ciphertext encoding polynomials.</span>
<span class="sd">        (list): Key encoding polynomials.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="p">(</span><span class="n">matk</span><span class="p">,</span> <span class="n">uvectork</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>
    <span class="p">(</span><span class="n">matc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">)</span> <span class="o">=</span> <span class="n">writeencodingasprod</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">unknown</span><span class="p">)</span>

    <span class="n">matk</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">matk</span><span class="p">)</span>
    <span class="n">matc</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">matc</span><span class="p">)</span>

    <span class="n">nonlone_c</span> <span class="o">=</span> <span class="n">determine_non_lone_vars_in_uvector</span><span class="p">(</span><span class="n">cenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">uvectorc</span><span class="p">)</span>

    <span class="p">(</span><span class="n">sublist_nonlones_c</span><span class="p">,</span> <span class="n">sublist_lones_c</span><span class="p">)</span> <span class="o">=</span> <span class="n">sublistslonenonlone</span><span class="p">(</span><span class="n">nonlone_c</span><span class="p">)</span>

    <span class="n">sublist_nonlones_c</span> <span class="o">=</span> <span class="n">put_special_s_first_entry</span><span class="p">(</span><span class="n">special_s</span><span class="p">,</span> <span class="n">sublist_nonlones_c</span><span class="p">)</span>

    <span class="n">nonlone_k</span> <span class="o">=</span> <span class="n">determine_non_lone_vars_in_uvector</span><span class="p">(</span><span class="n">kenc</span><span class="p">,</span> <span class="n">benc</span><span class="p">,</span> <span class="n">uvectork</span><span class="p">)</span>

    <span class="p">(</span><span class="n">sublist_nonlones_k</span><span class="p">,</span> <span class="n">sublist_lones_k</span><span class="p">)</span> <span class="o">=</span> <span class="n">sublistslonenonlone</span><span class="p">(</span><span class="n">nonlone_k</span><span class="p">)</span>

    <span class="n">kpolys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k_poly</span> <span class="k">for</span> <span class="n">k_poly</span> <span class="ow">in</span> <span class="n">kenc</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k_poly</span> <span class="ow">in</span> <span class="n">sublist_nonlones_k</span><span class="p">]</span>
    <span class="n">cpolys</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_poly</span> <span class="k">for</span> <span class="n">c_poly</span> <span class="ow">in</span> <span class="n">cenc</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">c_poly</span> <span class="ow">in</span> <span class="n">sublist_nonlones_c</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">sublist_nonlones_c</span><span class="p">,</span> <span class="n">sublist_nonlones_k</span><span class="p">,</span> <span class="n">cpolys</span><span class="p">,</span> <span class="n">kpolys</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="doc_FABEO_properties.print_transcript_of_FABEO_property" class="doc doc-heading">
<code class="highlight language-python"><span class="n">print_transcript_of_FABEO_property</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">lis_shared</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This function generates a transcript that proves that the encodings satisfy the FABEO property.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mat</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvector</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lis_shared</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shared variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Transcript of FABEO property.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>doc_FABEO_properties.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">print_transcript_of_FABEO_property</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">uvector</span><span class="p">,</span> <span class="n">lis_shared</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function generates a transcript that proves that the encodings satisfy the FABEO property.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mat (array): Matrix.</span>
<span class="sd">        uvector (list): Unknown variables.</span>
<span class="sd">        lis_shared (list): Shared variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (str): Transcript of FABEO property.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transcript_log</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> Generating transcript that proves that the FABEO property holds..&quot;</span>
    <span class="n">kern</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>
    <span class="n">kern_short</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">kern</span><span class="p">:</span>
        <span class="n">vec_r</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctr</span> <span class="ow">in</span> <span class="n">lis_shared</span><span class="p">:</span>
                <span class="n">vec_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
            <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">kern_short</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">vec_r</span><span class="p">))</span>

    <span class="n">err_sol_not_found</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">kern_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared</span><span class="p">:</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lis_shared</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">vec</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">ks_new</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">vec1</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="k">for</span> <span class="n">vec1</span> <span class="ow">in</span> <span class="n">kern_short</span> <span class="o">+</span> <span class="p">[</span><span class="n">vec</span><span class="p">]])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">kern_ks_new</span> <span class="o">=</span> <span class="n">ks_new</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>
        <span class="n">sol_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">kern_vec</span> <span class="ow">in</span> <span class="n">kern_ks_new</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kern_vec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">sol_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">val</span> <span class="o">=</span> <span class="o">-</span><span class="n">kern_vec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">sol_vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="o">/</span><span class="n">val</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">kern_vec</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sol_found</span><span class="p">:</span>
            <span class="n">new_kern_vec_long</span> <span class="o">=</span> <span class="n">kern</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sol_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">kern</span><span class="p">)):</span>
                <span class="n">new_kern_vec_long</span> <span class="o">+=</span> <span class="n">kern</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">*</span><span class="n">sol_vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">kern_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_kern_vec_long</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">err_sol_not_found</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">err_sol_not_found</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> Transcript not found..&quot;</span>
        <span class="k">return</span> <span class="n">msg</span>

    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> For the transcript, we use the following reference vector of monomials: </span><span class="se">\n\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uvector</span><span class="p">)</span>

    <span class="n">transcript_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lis_shared</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> The vector with 1 in the entry corresponding to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uvector</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis_shared</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; and 0 in the entries corresponding to &quot;</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; and 0 in the entry corresponding to &quot;</span> 
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">ind1</span> <span class="ow">in</span> <span class="n">lis_shared</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ind1</span> <span class="o">!=</span> <span class="n">ind</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uvector</span><span class="p">[</span><span class="n">ind1</span><span class="p">])</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; is: </span><span class="se">\n\t\t\t</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">kern_new</span><span class="p">[</span><span class="n">ctr</span><span class="p">]))</span>
        <span class="n">transcript_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># ideally, str(list(kern_new[ctr])) should be added without casting the vector as a string and list</span>
        <span class="c1"># transcript_log.append(kern_new[ctr]))</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">transcript_log</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
      
    
  </body>
</html>