
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ac17/">
      
      
        <link rel="next" href="../decryption/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.19">
    
    
      
        <title>Finding master key attacks - ACABELLA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#finding-master-key-attacks-in-abe-schemes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ACABELLA" class="md-header__button md-logo" aria-label="ACABELLA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ACABELLA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Finding master key attacks
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ACABELLA" class="md-nav__button md-logo" aria-label="ACABELLA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ACABELLA
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ac17/" class="md-nav__link">
        Security analysis
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Finding master key attacks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Finding master key attacks
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#finding-master-key-attacks-in-abe-schemes" class="md-nav__link">
    Finding master-key attacks in ABE schemes
  </a>
  
    <nav class="md-nav" aria-label="Finding master-key attacks in ABE schemes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-of-corruptable-variables-in-master-key-attacks" class="md-nav__link">
    Type of corruptable variables in master key attacks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-lxxh16" class="md-nav__link">
    Attacking LXXH16
  </a>
  
    <nav class="md-nav" aria-label="Attacking LXXH16">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-involved-encodings" class="md-nav__link">
    Obtaining the involved encodings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-inputs-for-acabella" class="md-nav__link">
    Generating inputs for ACABELLA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-mgz19" class="md-nav__link">
    Attacking MGZ19
  </a>
  
    <nav class="md-nav" aria-label="Attacking MGZ19">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-involved-encodings_1" class="md-nav__link">
    Obtaining the involved encodings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-inputs-for-acabella_1" class="md-nav__link">
    Generating inputs for ACABELLA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-qlz13" class="md-nav__link">
    Attacking QLZ13
  </a>
  
    <nav class="md-nav" aria-label="Attacking QLZ13">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-involved-encodings_2" class="md-nav__link">
    Obtaining the involved encodings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-inputs-for-acabella_2" class="md-nav__link">
    Generating inputs for ACABELLA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-yj12" class="md-nav__link">
    Attacking YJ12
  </a>
  
    <nav class="md-nav" aria-label="Attacking YJ12">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-involved-encodings_3" class="md-nav__link">
    Obtaining the involved encodings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-inputs-for-acabella_3" class="md-nav__link">
    Generating inputs for ACABELLA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advice-on-finding-master-key-attacks-on-schemes" class="md-nav__link">
    Advice on finding master key attacks on schemes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../decryption/" class="md-nav__link">
        Finding decryption attacks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../corruption/" class="md-nav__link">
        Utilization of corruption
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        Tools
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../json/" class="md-nav__link">
        JSON description
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../abgw/" class="md-nav__link">
        Bridge to the ABGW17 analyzer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        Reference API
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#finding-master-key-attacks-in-abe-schemes" class="md-nav__link">
    Finding master-key attacks in ABE schemes
  </a>
  
    <nav class="md-nav" aria-label="Finding master-key attacks in ABE schemes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-of-corruptable-variables-in-master-key-attacks" class="md-nav__link">
    Type of corruptable variables in master key attacks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-lxxh16" class="md-nav__link">
    Attacking LXXH16
  </a>
  
    <nav class="md-nav" aria-label="Attacking LXXH16">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-involved-encodings" class="md-nav__link">
    Obtaining the involved encodings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-inputs-for-acabella" class="md-nav__link">
    Generating inputs for ACABELLA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-mgz19" class="md-nav__link">
    Attacking MGZ19
  </a>
  
    <nav class="md-nav" aria-label="Attacking MGZ19">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-involved-encodings_1" class="md-nav__link">
    Obtaining the involved encodings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-inputs-for-acabella_1" class="md-nav__link">
    Generating inputs for ACABELLA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-qlz13" class="md-nav__link">
    Attacking QLZ13
  </a>
  
    <nav class="md-nav" aria-label="Attacking QLZ13">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-involved-encodings_2" class="md-nav__link">
    Obtaining the involved encodings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-inputs-for-acabella_2" class="md-nav__link">
    Generating inputs for ACABELLA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-yj12" class="md-nav__link">
    Attacking YJ12
  </a>
  
    <nav class="md-nav" aria-label="Attacking YJ12">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#obtaining-the-involved-encodings_3" class="md-nav__link">
    Obtaining the involved encodings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-inputs-for-acabella_3" class="md-nav__link">
    Generating inputs for ACABELLA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advice-on-finding-master-key-attacks-on-schemes" class="md-nav__link">
    Advice on finding master key attacks on schemes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Finding master key attacks</h1>

<h2 id="finding-master-key-attacks-in-abe-schemes">Finding master-key attacks in ABE schemes</h2>
<p>In this section, we utilize the ACABELLA command-line tool to demonstrate
how to find master-key attacks in ABE schemes. We first introduce the type
of corruptable variables that we can use in this case. </p>
<p>Further, we recommend the reader to read the supported corruption models
for MA-ABE schemes in the respective section.</p>
<h3 id="type-of-corruptable-variables-in-master-key-attacks">Type of corruptable variables in master key attacks</h3>
<p>When using corruption models in master key attacks, the variables
that we receive from either CAs or AAs can be categorized using the enum type
<code>MasterKeyCorruptedVariable</code>:</p>
<ul>
<li>MPK_CA: The variable is part of the corruption of the Central Authority (CA).</li>
<li>MPK_AA: The variable belongs to an Attribute Authority j. It will be used to obtain the master key of an AA[i].</li>
</ul>
<p>The type of corrupted variable is used in the JSON input files for ACABELLA, for instance:</p>
<pre><code class="language-json">{
    &quot;scheme_id&quot;: &quot;yj12&quot;,
    &quot;analysis&quot;: &quot;master_key&quot;,
    &quot;k&quot;: [&quot;r * b / bp + alpha_i/bp&quot;, &quot;r&quot;],
    &quot;master_key&quot;: &quot;alpha_i&quot;,
    &quot;unknown_vars&quot; :  [&quot;alpha_i&quot;, &quot;r&quot;],
    &quot;corruption_model&quot; : &quot;mixed_AA_corr&quot;,
    &quot;corruptable_vars&quot;: [ { &quot;type&quot;:&quot;MPK_AA&quot;, &quot;var&quot;:&quot;b/bp&quot; }],
    &quot;MPK_CA&quot;: [&quot;r&quot;],
    &quot;MPK_AA&quot;: [&quot;alpha_i&quot;, &quot;b/bp&quot;],
    &quot;MPK_vars&quot;: [],
    &quot;GP_vars&quot;: [&quot;b&quot;, &quot;bp&quot;]
}
</code></pre>
<h3 id="attacking-lxxh16">Attacking LXXH16</h3>
<p>The LXXH16 scheme [^1] is a multi-authority ABE scheme for the Cloud, based on five different
entities. </p>
<p><strong>Note</strong></p>
<blockquote>
<p>In this section we only describe the variables that are interesting for testing if 
we can find a master key attack on the scheme.</p>
</blockquote>
<ul>
<li>CA: It generates the system parameters and the attributes public keys. Register users
attribute-authorities and creates a uid and an aid respectively. The CA is not involved
in the generation of secret keys related to attributes.</li>
</ul>
<p>Once the system parameters have been chosen (pairing groups, group generators, etc.), 
the CA generates the value <script type="math/tex">a \in_R Z_p</script> as master key and computes the master public key (MPK)
as <script type="math/tex">g^a</script>.</p>
<p>The CA will generate a uid <script type="math/tex">\in_R Z_p</script> for each user of the system as well as an aid
for identifying the AAs involved where aid <script type="math/tex">\in_R Z_p</script>.</p>
<p>In summary, if the CA is corrupted, we could obtain the parameter <script type="math/tex">a</script> and that could perhaps help us in performing a master key attack and obtain the
attribute-authority private key <script type="math/tex">\alpha_i</script>.</p>
<ul>
<li>AA: It manages the attribute generation and secret key sassociated to the attributes.</li>
</ul>
<p>During the <code>AASetup</code> algorithm each AA i generates a master secret key MSK AA = 
<script type="math/tex">\alpha_i</script> and an MPK AA = <script type="math/tex">e(g, g)^{\alpha_i}</script>.</p>
<ul>
<li>Data owner: It uses MA-ABE to encrypt a plaintext with a certain access policy.</li>
<li>User: Identified by the uid generated by the CA. It can decrypt a ciphertext if it can satisfiy the respective access policy.</li>
</ul>
<p>If they have the right permissions in the system, the can ask secret keys related to attributes that they can use to fuilfill an access policy and decrypt a ciphertext. We focus on those components of the secret keys during the key generation algorithm that are attribute-independent: </p>
<p>The AA generates the random value <script type="math/tex">b_i \in Z_p</script>. Then, it obtains the attribute key component <script type="math/tex">K_i = g^{\alpha_i} \cdot g^{a \cdot b_i}</script> and the component 
<script type="math/tex">L_i = g^{b_i}</script>.</p>
<ul>
<li>Cloud server: It provides the storage capabilities to deploy the system.</li>
</ul>
<h4 id="obtaining-the-involved-encodings">Obtaining the involved encodings</h4>
<ul>
<li>
<p>For the CA, we have the <script type="math/tex">MPK_{CA}</script> encoding as <script type="math/tex">a \in_R Z_p</script> that we rename as <script type="math/tex">b</script> (we use <script type="math/tex">b</script> to describe public key parameters in the scheme). We consider that we can obtain this value via corruption of the CA.</p>
</li>
<li>
<p>Every AA contains the encoding <script type="math/tex">\alpha_i</script>.</p>
</li>
<li>
<p>For every key generated by an AA, the user obtains the encodings: <script type="math/tex">b_i</script>, that we rename as <script type="math/tex">r</script> (we use <script type="math/tex">r</script> to denote random variables associated to keys) and <script type="math/tex">\alpha_i + b\cdot r</script>.</p>
</li>
</ul>
<h4 id="generating-inputs-for-acabella">Generating inputs for ACABELLA</h4>
<p>Based on the encodings we identified, we can prepare JSON inputs for ACABELLA.</p>
<p>We'll start with an input file where corruption is not performed, and where we try to find <script type="math/tex">\alpha_i</script> based on the available encodings as a normal user:</p>
<pre><code class="language-json">{
    &quot;scheme_id&quot;: &quot;lxhh16&quot;,
    &quot;analysis&quot;: &quot;master_key&quot;,
    &quot;k&quot;: [&quot;alpha_i + r * b&quot;, &quot;r&quot;],
    &quot;master_key&quot;: &quot;alpha_i&quot;,
    &quot;unknown_vars&quot; :  [&quot;alpha_i&quot;, &quot;b&quot;, &quot;r&quot;],
    &quot;corruption_model&quot; : &quot;NoCorruption&quot;,
    &quot;corruptable_vars&quot;: [],
    &quot;MPK_CA&quot;: [&quot;b&quot;],
    &quot;MPK_AA&quot;: [&quot;alpha_i&quot;],
    &quot;MPK_vars&quot;: [],
    &quot;GP_vars&quot;: []
}
</code></pre>
<p>Using acabella_cmd will report that no attack was found, via <code>python acabella_cmd.py -a mk -c examples/lxxh16/lxxh16_config_mka_no_corruption.json</code>.</p>
<p>However, we can suppose that the CA has been corrupted and that we have obtained the MPK CA encoding, <script type="math/tex">b</script>:</p>
<pre><code class="language-json">{
    &quot;scheme_id&quot;: &quot;lxhh16&quot;,
    &quot;analysis&quot;: &quot;master_key&quot;,
    &quot;k&quot;: [&quot;alpha_i + r * b&quot;, &quot;r&quot;],
    &quot;master_key&quot;: &quot;alpha_i&quot;,
    &quot;unknown_vars&quot; :  [&quot;alpha_i&quot;, &quot;b&quot;, &quot;r&quot;],
    &quot;corruption_model&quot; : &quot;mixed_CA_corr&quot;,
    &quot;corruptable_vars&quot;: [
        { &quot;type&quot;:&quot;MPK_CA&quot;, &quot;var&quot;:&quot;b&quot; }
         ],
    &quot;MPK_CA&quot;: [&quot;b&quot;],
    &quot;MPK_AA&quot;: [&quot;alpha_i&quot;],
    &quot;MPK_vars&quot;: [],
    &quot;GP_vars&quot;: []
}
</code></pre>
<p><strong>Note</strong></p>
<blockquote>
<p>We have chosen the mixed_CA_corr corruption model, that is, a system where multiple AAs and a CA is used. Within this corruption model, we associated the variable b as a variable of the CA (MPK).</p>
</blockquote>
<p>In this case, the output we obtain from ACABELLA is:</p>
<pre><code class="language-json">[*] ACABELLA cmd tool


[*] Analyzing scheme...



[*] Master key attack results:


List of encodings:
         k0[i][j] : alpha_i + b*r
         k1[i][j] : r

For the corruption of a Central Authority [i] in a model with several Attribute Authorities [j].

Structure of CA/AAs:
        Contents of the CA MPK encodings: [b]
        Contents of the AA MPK encodings: [alpha_i]

List of variables obtained via corruption:
        b from MPK_CA

[*] Master key attack with corruption found: 1*k0[i][j] + -b*k1[i][j]
</code></pre>
<p>and we have obtained a linar combination of key encodings that allow us to recover the master key of the AA.</p>
<h3 id="attacking-mgz19">Attacking MGZ19</h3>
<p>The MGZ19 scheme [^2] is a multi-authority ABE scheme that uses multiplies CAs and AAs.
We first describe each entity and identify the relevant encodings that we could use in our attack:</p>
<ul>
<li>
<p>The CA generates the system parameters and execute <code>CKeyGen</code>, which generates an identity key <script type="math/tex">SK_{GID, S}</script> for a user id GID and a set of attributes. Moreover, it generates the parameter r and the component <script type="math/tex">g_1^r</script>, later used by the attribute authorities. We should keep in mind that we can corrupt the CA and recover the <script type="math/tex">r</script> encoding.</p>
</li>
<li>
<p>Each AA i generates <script type="math/tex">\alpha_i</script> and <script type="math/tex">t_i \in Z_N</script> and assign those values to the master secret key of the AA. The MPK pair of the AA is then represented by <script type="math/tex">e(g_1, g_1)^{\alpha_i}</script> and <script type="math/tex">g_1^{t_i}</script>.</p>
</li>
</ul>
<p>For those registers user, the AA i generates secret keys related to attributes <script type="math/tex">SK_{GID,i}</script> as <script type="math/tex">g_1^{\alpha_i}\cdot(g_1^r)^{t_i}</script>.</p>
<h4 id="obtaining-the-involved-encodings_1">Obtaining the involved encodings</h4>
<ul>
<li>The structure of the CA contains the parameter <script type="math/tex">r</script>.</li>
<li>Each AA contain a MPK with encodings <script type="math/tex">\alpha_i</script> and <script type="math/tex">t_i</script>, that we rename as <script type="math/tex">b_i</script> (related to a public key).</li>
<li>For ever attribute key generated by an authenticated user, the key-independent part contains the encodings <script type="math/tex">\alpha_i + r\cdot b_i</script> and <script type="math/tex">b_i</script>.</li>
<li>If the corruption of the CA is possible, we could obtain <script type="math/tex">r</script>.</li>
</ul>
<h4 id="generating-inputs-for-acabella_1">Generating inputs for ACABELLA</h4>
<p>Let's assume that the CA can be corrupted and that we can obtain <script type="math/tex">r</script> in the following JSON input for ACABELLA:</p>
<pre><code class="language-json">{
    &quot;scheme_id&quot;: &quot;mgz19&quot;,
    &quot;analysis&quot;: &quot;master_key&quot;,
    &quot;k&quot;: [&quot;alpha_j + r * b_j&quot;, &quot;b_j&quot;],
    &quot;master_key&quot;: &quot;alpha_j&quot;,
    &quot;unknown_vars&quot; :  [&quot;alpha_j&quot;, &quot;b_j&quot;, &quot;r&quot;],
    &quot;corruption_model&quot; : &quot;mixed_CA_corr&quot;,
    &quot;corruptable_vars&quot;: [
        { &quot;type&quot;:&quot;MPK_CA&quot;, &quot;var&quot;:&quot;r&quot; }
         ],
    &quot;MPK_CA&quot;: [&quot;r&quot;],
    &quot;MPK_AA&quot;: [&quot;alpha_j&quot;, &quot;b_j&quot;],
    &quot;MPK_vars&quot;: [&quot;b_j&quot;],
    &quot;GP_vars&quot;: []
}
</code></pre>
<p>ACABELLA finds an attack to recover the AA master key:</p>
<pre><code class="language-json">[*] ACABELLA cmd tool


[*] Analyzing scheme...



[*] Master key attack results:


List of encodings:
         k0[i][j] : alpha_j + b_j*r
         k1[i][j] : b_j

For the corruption of a Central Authority [i] in a model with several Attribute Authorities [j].

Structure of CA/AAs:
        Contents of the CA MPK encodings: [r]
        Contents of the AA MPK encodings: [alpha_j, b_j]

List of variables obtained via corruption:
        r from MPK_CA

[*] Master key attack with corruption found: 1*k0[i][j] + -r*k1[i][j]
</code></pre>
<h3 id="attacking-qlz13">Attacking QLZ13</h3>
<p>The QLZ13 scheme [^3] is a multi-authority ABE scheme consisting of only attribute-authorities AAs.</p>
<p>During the AA setup algorithm, each authority <script type="math/tex">k</script> generates:</p>
<ul>
<li>
<script type="math/tex">\alpha_k \in_R Z_p</script>
</li>
<li>
<script type="math/tex">\beta_k \in_R Z_p</script>
</li>
<li>For each attribute managed by the authority <script type="math/tex">AA_k</script>, it generates <script type="math/tex">g^t_{i, j} \in_R Z_p</script>.</li>
</ul>
<p>Thus, the master public key of the AA is composed of: <script type="math/tex">Y_k = e(g, g)^{\alpha_k}</script>, <script type="math/tex">Z_k = g^{\beta_k}</script>, and <script type="math/tex">T_{i, j}^k = g^{t^k_{i, j}}</script>. The master secret key of the AA consists of: <script type="math/tex">\alpha_k</script>, <script type="math/tex">\beta_k</script>, and <script type="math/tex">t_{i, j}</script>.</p>
<p>The users are identified via a global identifier (GID) <script type="math/tex">u</script>, generated <script type="math/tex">\in_R Z_p</script>.</p>
<p>During key generation, the <script type="math/tex">AA_k</script> generates random values <script type="math/tex">r_k</script>, <script type="math/tex">t_k \in_R Z_p</script>. We are interested in the following attribute-independent key components:</p>
<ul>
<li>
<script type="math/tex">D_{i, 1}^k = g^{\alpha_k} \cdot h^{r_k} \cdot h_1^{\frac{1}{u + \beta_k}}</script>
</li>
<li>
<script type="math/tex">D_o^k = h^{r_k} \cdot h_1^{-t_k}</script>
</li>
<li>
<script type="math/tex">D_i^k = h_1^{t_k + \frac{1}{u + \beta_k}}</script>
</li>
</ul>
<h4 id="obtaining-the-involved-encodings_2">Obtaining the involved encodings</h4>
<ul>
<li>From every AA <script type="math/tex">k</script>, we identify the encodings <script type="math/tex">\alpha_k</script> and <script type="math/tex">\beta_k</script>, the latter identified by <script type="math/tex">bp</script> (<script type="math/tex">b</script> prime, since is related to a public key encoding and we use the letter <script type="math/tex">b</script> for those encodings as a convention). We don't consider the <script type="math/tex">t_{i, j}^k</script> encoding since it is not attribute-independent.</li>
<li>From the key components generated during key generation, we associated the letter <script type="math/tex">x</script> to the user identifier <script type="math/tex">u</script>. The <script type="math/tex">h</script> parameter is identified as <script type="math/tex">b</script> and the <script type="math/tex">h_i</script> parameter as <script type="math/tex">b_i</script>. Random exponents <script type="math/tex">r_k</script> and <script type="math/tex">t_k</script> and identified by <script type="math/tex">r</script> and <script type="math/tex">rp</script> respectively. Hence, we have the following key encodings: <script type="math/tex">k_1 = alpha_i + r\cdot b + b_i \cdot (\frac{1}{x + bp})</script>, <script type="math/tex">k_2 = b\cdot r - b_1 \cdot rp</script> and <script type="math/tex">k_3 = (rp + \frac{1}{x + bp})\cdot b_1</script>.</li>
</ul>
<h4 id="generating-inputs-for-acabella_2">Generating inputs for ACABELLA</h4>
<p>In this case, given the absence of CA and the structure of every AA, there is no much we can obtain via corruption. We can then specify all the encodings in a JSON input file for ACABELLA and try to find master key attacks:</p>
<pre><code class="language-json">{
    &quot;scheme_id&quot;: &quot;qlz13&quot;,
    &quot;analysis&quot;: &quot;master_key&quot;,
    &quot;k&quot;: [&quot;alpha_i + r * b + b1 / (x + bp)&quot;, &quot;r * b - rp * b1&quot;, &quot;(rp + 1 / (x + bp)) * b1&quot;],
    &quot;master_key&quot;: &quot;alpha_i&quot;,
    &quot;unknown_vars&quot; :  [&quot;alpha_i&quot;, &quot;b&quot;, &quot;b1&quot;, &quot;bp&quot;, &quot;r&quot;, &quot;rp&quot;, &quot;x&quot;],
    &quot;corruption_model&quot; : &quot;NoCorruption&quot;,
    &quot;corruptable_vars&quot;: [],
    &quot;MPK_CA&quot;: [],
    &quot;MPK_AA&quot;: [&quot;alpha_i&quot;, &quot;bp&quot;],
    &quot;MPK_vars&quot;: [],
    &quot;GP_vars&quot;: []
}
</code></pre>
<p>We finds the following attack:</p>
<pre><code>[*] ACABELLA cmd tool


[*] Analyzing scheme...



[*] Master key attack results:


List of encodings:
         k0 : alpha_i + b*r + b1/(bp + x)
         k1 : b*r - b1*rp
         k2 : b1*(rp + 1/(bp + x))

Structure of CA/AAs:
        Contents of the CA MPK encodings: []
        Contents of the AA MPK encodings: [alpha_i, bp]

[*] Master key attack found: 1*k0 + -1*k1 + -1*k2
</code></pre>
<h3 id="attacking-yj12">Attacking YJ12</h3>
<p>The MA-ABE YJ12 scheme [^4] consists of a CA and several AAs.</p>
<ul>
<li>
<p>During the <code>Setup</code> algorithm, the CA generates the system parameters and registers AAs and users. Particularly for the users, it generates an UID <script type="math/tex">u \in_R Z_p</script> and a public key <script type="math/tex">PK_{UID} = g^u</script>. The <code>OwnerSetup</code> algorithm generates the parameters <script type="math/tex">\beta</script> and <script type="math/tex">\r \in_R Z_p</script> and obtains the so called <script type="math/tex">SK_o</script> pair consisting of <script type="math/tex">g^{1/\beta}</script> and <script type="math/tex">r/\beta</script>. This parameter is sent to every attribute-authority. The CA is fully trusted in the YJ12 scheme.</p>
</li>
<li>
<p>Finally, every AA generates the public key of each attribute it manages. </p>
</li>
<li>
<p>During the key generation algorithm, each AA generates an attribute-independent key part <script type="math/tex">PK_{UID}^{\frac{r}{\beta}}\cdot g^{\frac{\alpha_i}{\beta}}</script> which is equivalent to <script type="math/tex">\frac{x\cdot r + \alpha_i}{\beta}</script>.</p>
</li>
</ul>
<h4 id="obtaining-the-involved-encodings_3">Obtaining the involved encodings</h4>
<ul>
<li>The CA has generated every public key for the users and contains the parameter u. However it is fully trusted and we don't consider the corruption of the CA.</li>
<li>Each AA contains <script type="math/tex">\frac{1}{\beta}</script> and <script type="math/tex">\frac{r}{\beta}</script>, which we rename to 
<script type="math/tex">\frac{1}{bp}</script> and <script type="math/tex">\frac{b}{bp}</script> respectively.</li>
<li>The attribute-independent encodings from key generation are: <script type="math/tex">\frac{r\cdot b + \alpha_i}{bp}</script> and <script type="math/tex">PK_{UID}: r</script>.</li>
</ul>
<h4 id="generating-inputs-for-acabella_3">Generating inputs for ACABELLA</h4>
<p>In this case, the idea is to corrupt one AA <script type="math/tex">j</script> and use the obtained value <script type="math/tex">b/bp</script> to attack another authority <script type="math/tex">i</script>, using the mixed AA corruption model. In this case, we can use the following JSON input file:</p>
<pre><code class="language-json">{
    &quot;scheme_id&quot;: &quot;yj12&quot;,
    &quot;analysis&quot;: &quot;master_key&quot;,
    &quot;k&quot;: [&quot;r * b / bp + alpha_i/bp&quot;, &quot;r&quot;],
    &quot;master_key&quot;: &quot;alpha_i&quot;,
    &quot;unknown_vars&quot; :  [&quot;alpha_i&quot;, &quot;r&quot;],
    &quot;corruption_model&quot; : &quot;mixed_AA_corr&quot;,
    &quot;corruptable_vars&quot;: [ { &quot;type&quot;:&quot;MPK_AA&quot;, &quot;var&quot;:&quot;b/bp&quot; }],
    &quot;MPK_CA&quot;: [&quot;r&quot;],
    &quot;MPK_AA&quot;: [&quot;alpha_i&quot;, &quot;b/bp&quot;],
    &quot;MPK_vars&quot;: [],
    &quot;GP_vars&quot;: [&quot;b&quot;, &quot;bp&quot;]
}
</code></pre>
<p>which produces the following attack:</p>
<pre><code>[*] ACABELLA cmd tool


[*] Analyzing scheme...



[*] Master key attack results:


List of encodings:
         k0[i] : alpha_i/bp + b*r/bp
         k1[i] : r
         gp : b
         gp : bp

For the corruption of an attribute authority AA[j] and attacking an attribute authority AA[i].

Structure of CA/AAs:
        Contents of the CA MPK encodings: [r]
        Contents of the AA MPK encodings: [alpha_i, b/bp]

List of variables obtained via the corruption of AA[j]:
        b/bp from MPK_AA

[*] Master key attack with corruption found: bp*k0[i] + -b*k1[i]
</code></pre>
<h3 id="advice-on-finding-master-key-attacks-on-schemes">Advice on finding master key attacks on schemes</h3>
<ul>
<li>
<p>We are interested in the attribute-independent key components generated during the key generation algorithm. </p>
</li>
<li>
<p>Schemes adding new capabilities such as traceability and outsourcing are typically prone to errors due to the number of exponents that are generated by the CAs/AAs that are not correctly validated.</p>
</li>
<li>
<p>Sometimes, schemes that can be attacked via corruption are those where the CA generates exponents that are later utilized by AAs. In some cases, the CA can be corrupted and those values obtained and finally used to recover the master key of a AA. This is the case of the MGZ19 scheme.</p>
</li>
<li>
<p>Other times, the CA can kept values that we can use to recover the master key of an AA via a linear combination of encodings. In those cases, it's worth trying to find master key attacks involving the corruption of those values stored by the CA. See for instance the attack against LXXH16.</p>
</li>
<li>
<p>Finally, it is possible to corrupt an attribute-authority <script type="math/tex">AA_j</script> and obtain certain parameter that can enable an attack on a second authority, <script type="math/tex">AA_i</script> and that allow us to recover its master key <script type="math/tex">\alpha_i</script>. See for instance the YJ12 attack.</p>
</li>
</ul>
<p>[^1]: Wei Li, Kaiping Xue, Yingjie Xue, and Jianan Hong. Tmacs: a robust and verifiable threshold multi-authority access control system in public cloud storage. <em>IEEE Transactions on Parallel and Distributed Systems</em>, 27(5):1484&ndash;1496, 2016. <a href="https://doi.org/10.1109/TPDS.2015.2448095">doi:10.1109/TPDS.2015.2448095</a>.
[^2]: Chuangui Ma, Aijun Ge, and Jie Zhang. Fully secure decentralized ciphertext-policy attribute-based encryption in standard model. In Fuchun Guo, Xinyi Huang, and Moti Yung, editors, <em>Information Security and Cryptology</em>, 427–447. Cham, 2019. Springer International Publishing.
[^3]: Huiling Qian, Jiguo Li, and Yichen Zhang. Privacy-preserving decentralized ciphertext-policy attribute-based encryption with fully hidden access structure. In Sihan Qing, Jianying Zhou, and Dongmei Liu, editors, <em>Information and Communications Security</em>, 363–372. Cham, 2013. Springer International Publishing.
[^4]: Kan Yang and Xiaohua Jia. Attributed-based access control for multi-authority systems in cloud storage. In <em>2012 IEEE 32nd International Conference on Distributed Computing Systems</em>, volume, 536&ndash;545. 2012. <a href="https://doi.org/10.1109/ICDCS.2012.42">doi:10.1109/ICDCS.2012.42</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
      
    
  </body>
</html>